// ============================================================================
// üèÜ PITCHCONNECT DATABASE SCHEMA v7.8.0 - WORLD-CLASS ENTERPRISE EDITION
// ============================================================================
// 
// Version History:
// - v7.0.0: Initial enterprise schema
// - v7.1.0: Added Two-Factor Auth, Password Reset, Email Verification
// - v7.2.0: Added Team Join Requests, Job Posting System
// - v7.3.0: Added MediaContent, Hybrid Training, Enhanced Attendance
// - v7.4.0: Competition System, Match Enhancements, Multi-Sport
// - v7.5.0: Social Accounts, Fitness Assessments, Parent-Child Relations
// - v7.6.0: AI Predictions, Enhanced Referee/Scout, Watchlists, Analytics
// - v7.7.0: Training Drill Library, Budget & Expense System, Enhanced Stats
// - v7.8.0: Coach Management, Export System, Player Development, Gamification
//
// ============================================================================
// NEW IN v7.8.0:
// ============================================================================
//
// üèãÔ∏è ENHANCED COACH MANAGEMENT (6 models):
//   - CoachTimesheet (enhanced with period, breakdown fields)
//   - CoachRate for flexible rate structures
//   - CoachAssignment for team-level assignments
//   - CoachCertification for qualification tracking
//   - CoachPerformanceReview for coach evaluations
//
// üìä EXPORT & REPORTING SYSTEM (4 models):
//   - ExportRequest for tracking export jobs
//   - ExportTemplate for saved configurations
//   - ReportSchedule for automated reports
//   - SportFieldConfig for sport-aware field mapping
//
// üéØ PLAYER DEVELOPMENT SYSTEM (4 models):
//   - PlayerDevelopmentPlan for structured growth paths
//   - SkillAssessment for detailed skill tracking
//   - SkillMilestone for progress tracking
//   - MentorshipAssignment for player mentoring
//
// üì± ENHANCED COMMUNICATION (3 models):
//   - TeamAnnouncement for team-specific messaging
//   - EventRSVP for event attendance tracking
//   - ParentPortalAccess for parent engagement
//
// üí≥ ENHANCED PAYMENTS (4 models):
//   - PaymentPlan for installment payments
//   - InstallmentPayment for payment tracking
//   - FeeStructure for club/team fees
//   - Scholarship for financial aid
//
// üè• ENHANCED MEDICAL & WELLNESS (5 models):
//   - RecoveryProtocol for injury recovery
//   - NutritionPlan for player nutrition
//   - SleepLog for recovery monitoring
//   - WellnessCheck for mental health tracking
//   - PerformanceBenchmark for comparative analysis
//
// üìà ANALYTICS & INSIGHTS (2 models):
//   - TeamChemistry for team dynamics tracking
//   - PlayerComparison for scouting comparisons
//
// üéÆ GAMIFICATION SYSTEM (6 models):
//   - Challenge for player challenges
//   - ChallengeParticipant for challenge tracking
//   - Leaderboard for competitive rankings
//   - LeaderboardEntry for player rankings
//   - Streak for consistency tracking
//   - SeasonAward for end-of-season recognition
//
// ============================================================================

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "views", "postgresqlExtensions"]
  binaryTargets   = ["native", "rhel-openssl-1.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  directUrl  = env("DIRECT_URL")
  extensions = [citext]
}

// ============================================================================
// üìã ENUMS - USER & AUTHENTICATION
// ============================================================================

enum UserRole {
  SUPERADMIN
  ADMIN
  PLAYER
  PLAYER_PRO
  COACH
  COACH_PRO
  MANAGER
  CLUB_MANAGER
  CLUB_OWNER
  TREASURER
  REFEREE
  SCOUT
  ANALYST
  PARENT
  GUARDIAN
  LEAGUE_ADMIN
  MEDICAL_STAFF
  MEDIA_MANAGER
  FAN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  BANNED
  PENDING_VERIFICATION
  PENDING_EMAIL_VERIFICATION
  PENDING_PHONE_VERIFICATION
  PENDING_APPROVAL
  ARCHIVED
  DELETED
}

enum UserType {
  INDIVIDUAL
  ORGANIZATION
  FAMILY
}

enum AccountTier {
  FREE
  PRO
  PREMIUM
  ENTERPRISE
}

enum OrganisationRole {
  OWNER
  ADMIN
  MANAGER
  MEMBER
  VIEWER
}

enum OrganisationTier {
  STARTER
  PROFESSIONAL
  ENTERPRISE
  CUSTOM
}

enum VerificationType {
  EMAIL
  PHONE
  PASSWORD_RESET
  TWO_FACTOR
  ACCOUNT_RECOVERY
}

// ============================================================================
// üìã ENUMS - AI PREDICTIONS (v7.6.0)
// ============================================================================

enum PredictionType {
  PERFORMANCE
  FORM_TREND
  GOALS_ASSISTS
  INJURY_RISK
  FATIGUE_LEVEL
  RECOVERY_TIME
  MARKET_VALUE
  TRANSFER_LIKELIHOOD
  CONTRACT_VALUE
  FORMATION
  LINEUP
  TACTICAL_MATCHUP
  MATCH_OUTCOME
  SCORE_PREDICTION
  POTENTIAL_RATING
  DEVELOPMENT_PATH
  TEAM_CHEMISTRY
  RECRUITMENT_FIT
}

enum PredictionStatus {
  PENDING
  ACTIVE
  VERIFIED_CORRECT
  VERIFIED_INCORRECT
  PARTIALLY_CORRECT
  EXPIRED
  INVALIDATED
}

enum PredictionImpact {
  CRITICAL
  HIGH
  MEDIUM
  LOW
  INFORMATIONAL
}

// ============================================================================
// üìã ENUMS - SCOUT WATCHLIST (v7.6.0)
// ============================================================================

enum WatchlistStatus {
  MONITORING
  INTERESTED
  HOT_PROSPECT
  RECOMMENDED
  IN_NEGOTIATION
  SIGNED
  PASSED
  UNAVAILABLE
}

enum WatchlistPriority {
  CRITICAL
  HIGH
  MEDIUM
  LOW
  WATCHING
}

// ============================================================================
// üìã ENUMS - REFEREE (v7.6.0)
// ============================================================================

enum RefereeLevel {
  TRAINEE
  GRASSROOTS
  COUNTY
  NATIONAL
  FIFA
  UEFA
  ELITE
}

enum RefereeAvailabilityStatus {
  AVAILABLE
  UNAVAILABLE
  TENTATIVE
  ASSIGNED
  BLOCKED
}

// ============================================================================
// üìã ENUMS - EXPORT SYSTEM (NEW v7.8.0)
// ============================================================================

enum ExportFormat {
  CSV
  PDF
  EXCEL
  JSON
  XML
}

enum ExportStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  EXPIRED
  CANCELLED
}

enum ExportType {
  PLAYERS
  TEAMS
  MATCHES
  STANDINGS
  TRAINING
  ATTENDANCE
  PERFORMANCE
  FINANCIAL
  MEDICAL
  SCOUTING
  ANALYTICS
  CUSTOM
}

// ============================================================================
// üìã ENUMS - COACH MANAGEMENT (NEW v7.8.0)
// ============================================================================

enum CoachRateType {
  HOURLY
  DAILY
  SESSION
  MATCH
  WEEKLY
  MONTHLY
  FIXED
  PER_PLAYER
}

enum CoachAssignmentType {
  HEAD_COACH
  ASSISTANT_COACH
  GOALKEEPER_COACH
  FITNESS_COACH
  YOUTH_COACH
  DEVELOPMENT_COACH
  TECHNICAL_DIRECTOR
  INTERIM
  SPECIALIST
  CONSULTANT
}

enum CertificationStatus {
  ACTIVE
  EXPIRED
  PENDING_RENEWAL
  SUSPENDED
  REVOKED
}

// ============================================================================
// üìã ENUMS - PLAYER DEVELOPMENT (NEW v7.8.0)
// ============================================================================

enum DevelopmentPhase {
  FOUNDATION
  DEVELOPMENT
  MASTERY
  ELITE
  PROFESSIONAL
}

enum SkillCategory {
  TECHNICAL
  TACTICAL
  PHYSICAL
  MENTAL
  SOCIAL
  LEADERSHIP
}

enum MilestoneStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  OVERDUE
  CANCELLED
}

// ============================================================================
// üìã ENUMS - COMMUNICATION (NEW v7.8.0)
// ============================================================================

enum RSVPStatus {
  PENDING
  ATTENDING
  NOT_ATTENDING
  MAYBE
  WAITLISTED
}

// ============================================================================
// üìã ENUMS - PAYMENTS (NEW v7.8.0)
// ============================================================================

enum PaymentPlanStatus {
  ACTIVE
  COMPLETED
  DEFAULTED
  CANCELLED
  PAUSED
}

enum ScholarshipType {
  FULL
  PARTIAL
  MERIT
  NEED_BASED
  ATHLETIC
  ACADEMIC
}

// ============================================================================
// üìã ENUMS - MEDICAL & WELLNESS (NEW v7.8.0)
// ============================================================================

enum RecoveryPhase {
  ACUTE
  SUBACUTE
  REMODELING
  FUNCTIONAL
  RETURN_TO_SPORT
  FULL_CLEARANCE
}

enum WellnessCategory {
  PHYSICAL
  MENTAL
  EMOTIONAL
  SOCIAL
  SLEEP
  NUTRITION
  STRESS
}

// ============================================================================
// üìã ENUMS - GAMIFICATION (NEW v7.8.0)
// ============================================================================

enum ChallengeType {
  INDIVIDUAL
  TEAM
  CLUB
  GLOBAL
}

enum ChallengeStatus {
  UPCOMING
  ACTIVE
  COMPLETED
  EXPIRED
  CANCELLED
}

enum LeaderboardType {
  GOALS
  ASSISTS
  CLEAN_SHEETS
  RATING
  ATTENDANCE
  FITNESS
  TRAINING
  CUSTOM
}

enum LeaderboardScope {
  TEAM
  CLUB
  LEAGUE
  REGION
  NATIONAL
  GLOBAL
}

enum AwardCategory {
  MVP
  TOP_SCORER
  TOP_ASSISTER
  BEST_DEFENDER
  BEST_GOALKEEPER
  MOST_IMPROVED
  COACHES_AWARD
  FAIR_PLAY
  ATTENDANCE
  LEADERSHIP
  ROOKIE_OF_YEAR
  CUSTOM
}

enum ReportFrequency {
  DAILY
  WEEKLY
  BIWEEKLY
  MONTHLY
  QUARTERLY
  YEARLY
  ON_DEMAND
}

// ============================================================================
// üìã ENUMS - TRAINING DRILL SYSTEM (v7.7.0)
// ============================================================================

enum DrillCategory {
  // Universal Categories (All Sports)
  WARM_UP
  COOL_DOWN
  CONDITIONING
  STRENGTH_POWER
  SPEED_AGILITY
  FLEXIBILITY_MOBILITY
  RECOVERY
  MENTAL_PREPARATION
  VIDEO_ANALYSIS
  TEAM_MEETING

  // Technical - Ball Sports
  PASSING
  SHOOTING
  DRIBBLING
  FIRST_TOUCH
  CROSSING
  HEADING

  // Tactical Categories
  DEFENSIVE_SHAPE
  ATTACKING_PATTERNS
  SET_PIECES
  TRANSITIONS
  PRESSING
  BUILD_UP_PLAY
  COUNTER_ATTACK

  // Position-Specific Training
  GOALKEEPER_TRAINING
  DEFENDER_TRAINING
  MIDFIELDER_TRAINING
  FORWARD_TRAINING

  // Team Training
  SMALL_SIDED_GAMES
  MATCH_SIMULATION
  TEAM_TACTICS

  // Rugby-Specific
  SCRUMMAGING
  LINEOUT
  RUCKING
  MAULING
  TACKLING_TECHNIQUE
  BREAKDOWN

  // Basketball-Specific
  FREE_THROWS
  THREE_POINT_SHOOTING
  POST_MOVES
  PICK_AND_ROLL
  FAST_BREAK
  ZONE_DEFENSE
  MAN_TO_MAN

  // Cricket-Specific
  BATTING_TECHNIQUE
  BOWLING_TECHNIQUE
  FIELDING_DRILLS
  CATCHING
  WICKET_KEEPING

  // American Football-Specific
  BLOCKING
  ROUTE_RUNNING
  COVERAGE
  SPECIAL_TEAMS

  // Netball-Specific
  FOOTWORK
  INTERCEPTIONS
  COURT_MOVEMENT
  CIRCLE_WORK

  // Hockey-Specific
  STICK_HANDLING
  SLAP_SHOT
  POWER_PLAY
  PENALTY_KILL

  // Other Categories
  REHABILITATION
  INDIVIDUAL_SKILL
  FUN_GAMES
  OTHER
}

enum DrillIntensity {
  RECOVERY
  LOW
  MEDIUM
  HIGH
  MAXIMUM
  VARIABLE
}

enum DrillDifficulty {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  ELITE
}

// ============================================================================
// üìã ENUMS - BUDGET & EXPENSE SYSTEM (v7.7.0)
// ============================================================================

enum BudgetStatus {
  DRAFT
  ACTIVE
  FROZEN
  CLOSED
  ARCHIVED
}

enum BudgetPeriodType {
  SEASON
  CALENDAR_YEAR
  FISCAL_YEAR
  QUARTERLY
  MONTHLY
  CUSTOM
}

enum ExpenseCategory {
  // Equipment & Gear
  EQUIPMENT_PURCHASE
  EQUIPMENT_MAINTENANCE
  EQUIPMENT_RENTAL
  UNIFORMS_KITS
  TRAINING_GEAR

  // Facilities
  FACILITY_RENTAL
  FACILITY_MAINTENANCE
  PITCH_HIRE
  GYM_MEMBERSHIP

  // Travel & Accommodation
  TRAVEL_TRANSPORT
  TRAVEL_FUEL
  ACCOMMODATION
  MEALS_CATERING

  // Staff & Personnel
  COACHING_FEES
  REFEREE_FEES
  MEDICAL_STAFF
  ADMINISTRATIVE_STAFF

  // Medical & Welfare
  MEDICAL_SUPPLIES
  PHYSIOTHERAPY
  INSURANCE_PREMIUMS
  PLAYER_WELFARE

  // Competition & Registration
  LEAGUE_FEES
  COMPETITION_ENTRY
  REGISTRATION_FEES
  FINES_PENALTIES

  // Marketing & Admin
  MARKETING_PROMOTION
  WEBSITE_HOSTING
  SOFTWARE_SUBSCRIPTIONS
  PRINTING_STATIONERY

  // Events
  EVENTS_SOCIALS
  AWARDS_TROPHIES
  END_OF_SEASON

  // Other
  MISCELLANEOUS
  CONTINGENCY
  OTHER
}

enum ExpenseStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  REJECTED
  PAID
  REIMBURSED
  CANCELLED
}

// ============================================================================
// üìã ENUMS - PERMISSIONS (ENHANCED v7.8.0)
// ============================================================================

enum PermissionType {
  // User Management
  USER_CREATE
  USER_READ
  USER_UPDATE
  USER_DELETE
  USER_SUSPEND
  USER_BAN

  // Team Management
  TEAM_CREATE
  TEAM_READ
  TEAM_UPDATE
  TEAM_DELETE
  TEAM_INVITE
  TEAM_REMOVE_MEMBER

  // Match Management
  MATCH_CREATE
  MATCH_READ
  MATCH_UPDATE
  MATCH_DELETE
  MATCH_PUBLISH
  MATCH_APPROVE_RESULT
  MATCH_RECORD_STATS
  MATCH_MANAGE_LINEUP
  MATCH_RECORD_EVENTS

  // Competition Management
  COMPETITION_CREATE
  COMPETITION_READ
  COMPETITION_UPDATE
  COMPETITION_DELETE
  COMPETITION_MANAGE_TEAMS

  // Player Management
  PLAYER_CREATE
  PLAYER_READ
  PLAYER_UPDATE
  PLAYER_DELETE
  PLAYER_VERIFY
  PLAYER_TRANSFER

  // Medical & Health
  MEDICAL_READ
  MEDICAL_CREATE
  MEDICAL_UPDATE
  MEDICAL_READ_FULL
  MEDICAL_READ_AVAILABILITY

  // Financial - ENHANCED v7.8.0
  BILLING_READ
  BILLING_UPDATE
  BILLING_MANAGE_SUBSCRIPTIONS
  BUDGET_VIEW
  BUDGET_CREATE
  BUDGET_UPDATE
  BUDGET_DELETE
  EXPENSE_VIEW
  EXPENSE_CREATE
  EXPENSE_APPROVE
  EXPENSE_DELETE
  PAYMENT_PLAN_VIEW
  PAYMENT_PLAN_CREATE
  PAYMENT_PLAN_MANAGE
  SCHOLARSHIP_VIEW
  SCHOLARSHIP_MANAGE

  // Analytics & Predictions
  ANALYTICS_VIEW
  ANALYTICS_EXPORT
  PREDICTIONS_VIEW
  PREDICTIONS_CREATE
  PREDICTIONS_MANAGE

  // Scouting
  SCOUTING_VIEW
  SCOUTING_CREATE_REPORT
  SCOUTING_MANAGE_WATCHLIST

  // Referee
  REFEREE_VIEW_ASSIGNMENTS
  REFEREE_MANAGE_AVAILABILITY
  REFEREE_SUBMIT_REPORTS
  REFEREE_VIEW_FEES

  // Training - ENHANCED v7.8.0
  TRAINING_VIEW
  TRAINING_CREATE
  TRAINING_UPDATE
  TRAINING_DELETE
  TRAINING_MANAGE_DRILLS
  DRILL_CREATE
  DRILL_UPDATE
  DRILL_DELETE
  DRILL_MANAGE_LIBRARY

  // Coach Management - NEW v7.8.0
  COACH_RATE_VIEW
  COACH_RATE_CREATE
  COACH_RATE_UPDATE
  COACH_RATE_DELETE
  COACH_ASSIGNMENT_VIEW
  COACH_ASSIGNMENT_CREATE
  COACH_ASSIGNMENT_UPDATE
  COACH_ASSIGNMENT_DELETE
  COACH_CERTIFICATION_VIEW
  COACH_CERTIFICATION_MANAGE
  COACH_REVIEW_VIEW
  COACH_REVIEW_CREATE

  // Export & Reports - NEW v7.8.0
  EXPORT_REQUEST
  EXPORT_TEMPLATE_CREATE
  EXPORT_TEMPLATE_MANAGE
  REPORT_SCHEDULE_CREATE
  REPORT_SCHEDULE_MANAGE

  // Player Development - NEW v7.8.0
  DEVELOPMENT_PLAN_VIEW
  DEVELOPMENT_PLAN_CREATE
  DEVELOPMENT_PLAN_MANAGE
  SKILL_ASSESSMENT_VIEW
  SKILL_ASSESSMENT_CREATE
  MENTORSHIP_VIEW
  MENTORSHIP_MANAGE

  // Wellness - NEW v7.8.0
  WELLNESS_VIEW
  WELLNESS_CREATE
  WELLNESS_VIEW_CONFIDENTIAL
  RECOVERY_PROTOCOL_VIEW
  RECOVERY_PROTOCOL_MANAGE
  NUTRITION_VIEW
  NUTRITION_MANAGE

  // Gamification - NEW v7.8.0
  CHALLENGE_VIEW
  CHALLENGE_CREATE
  CHALLENGE_MANAGE
  LEADERBOARD_VIEW
  LEADERBOARD_MANAGE
  SEASON_AWARD_VIEW
  SEASON_AWARD_MANAGE

  // Parent Portal - NEW v7.8.0
  PARENT_PORTAL_VIEW
  PARENT_PORTAL_MANAGE

  // API & System
  API_ACCESS
  API_KEY_CREATE
  API_KEY_REVOKE

  // Facilities & Venues
  FACILITY_MANAGE
  FACILITY_BOOK
  VENUE_CREATE
  VENUE_UPDATE

  // Admin & Audit
  SYSTEM_ADMIN
  AUDIT_LOG_VIEW

  // Media
  MEDIA_UPLOAD
  MEDIA_DELETE
  MEDIA_MANAGE

  // Social
  SOCIAL_CONNECT
  SOCIAL_POST
  SOCIAL_MANAGE
}

enum DataRetentionPolicy {
  EPHEMERAL
  TEMPORARY
  STANDARD
  PERMANENT
  DELETED
}

enum AuditActionType {
  // User Actions
  USER_CREATED
  USER_UPDATED
  USER_DELETED
  USER_SUSPENDED
  USER_BANNED
  USER_REACTIVATED
  ROLE_ASSIGNED
  ROLE_REMOVED
  USER_REGISTERED
  USER_LOGIN
  USER_LOGOUT
  LOGIN_FAILED
  LOGIN_LOCKED

  // Verification & Security
  EMAIL_VERIFIED
  PHONE_VERIFIED
  PASSWORD_CHANGED
  PASSWORD_RESET_REQUESTED
  PASSWORD_RESET_COMPLETED
  TWO_FACTOR_ENABLED
  TWO_FACTOR_DISABLED
  TWO_FACTOR_VERIFIED
  TWO_FACTOR_BACKUP_USED
  SESSION_CREATED
  SESSION_REVOKED
  SESSION_EXPIRED
  VERIFICATION_EMAIL_SENT
  VERIFICATION_EMAIL_RESENT

  // Subscription & Payment
  SUBSCRIPTION_GRANTED
  SUBSCRIPTION_UPGRADED
  SUBSCRIPTION_DOWNGRADED
  SUBSCRIPTION_CANCELLED
  PAYMENT_PROCESSED
  PAYMENT_FAILED
  REFUND_PROCESSED

  // Data Management
  DATA_EXPORTED
  DATA_DELETED
  DATA_IMPORTED

  // Organisation & Club
  TEAM_CREATED
  TEAM_UPDATED
  TEAM_DELETED
  CLUB_CREATED
  CLUB_UPDATED
  CLUB_DELETED

  // Match & Competition
  MATCH_CREATED
  MATCH_UPDATED
  MATCH_RESULT_UPDATED
  MATCH_CANCELLED
  MATCH_LINEUP_SET
  MATCH_EVENT_RECORDED
  MATCH_STATUS_CHANGED
  COMPETITION_CREATED
  COMPETITION_UPDATED
  COMPETITION_DELETED
  COMPETITION_TEAM_ADDED
  COMPETITION_TEAM_REMOVED

  // Player & Medical
  PLAYER_TRANSFER
  PLAYER_CONTRACT_SIGNED
  PLAYER_PERFORMANCE_RECORDED
  MEDICAL_RECORD_ACCESSED
  MEDICAL_RECORD_CREATED
  FITNESS_ASSESSMENT_CREATED
  FITNESS_ASSESSMENT_UPDATED
  PLAYER_CLEARED_TO_PLAY

  // Join Requests & Jobs
  JOIN_REQUEST_SUBMITTED
  JOIN_REQUEST_APPROVED
  JOIN_REQUEST_REJECTED
  JOIN_REQUEST_CANCELLED
  JOB_POSTED
  JOB_CLOSED
  JOB_APPLICATION_SUBMITTED
  JOB_APPLICATION_REVIEWED
  JOB_APPLICATION_ACCEPTED
  JOB_APPLICATION_REJECTED

  // Training & Drills
  TRAINING_CREATED
  TRAINING_UPDATED
  TRAINING_CANCELLED
  DRILL_CREATED
  DRILL_UPDATED
  DRILL_DELETED
  DRILL_ADDED_TO_SESSION
  DRILL_REMOVED_FROM_SESSION

  // Media & Social
  MEDIA_UPLOADED
  MEDIA_DELETED
  MEDIA_SHARED
  SOCIAL_ACCOUNT_CONNECTED
  SOCIAL_ACCOUNT_DISCONNECTED
  SOCIAL_POST_PUBLISHED

  // AI Predictions
  PREDICTION_CREATED
  PREDICTION_VERIFIED
  PREDICTION_FEEDBACK_SUBMITTED

  // Scouting
  SCOUTING_REPORT_CREATED
  WATCHLIST_PLAYER_ADDED
  WATCHLIST_PLAYER_UPDATED
  WATCHLIST_PLAYER_REMOVED

  // Referee
  REFEREE_ASSIGNED
  REFEREE_AVAILABILITY_UPDATED
  REFEREE_REPORT_SUBMITTED
  REFEREE_PAYMENT_PROCESSED

  // Budget & Expense
  BUDGET_CREATED
  BUDGET_UPDATED
  BUDGET_DELETED
  BUDGET_STATUS_CHANGED
  BUDGET_CATEGORY_ADDED
  BUDGET_CATEGORY_UPDATED
  EXPENSE_CREATED
  EXPENSE_UPDATED
  EXPENSE_DELETED
  EXPENSE_SUBMITTED
  EXPENSE_APPROVED
  EXPENSE_REJECTED
  EXPENSE_PAID
  EXPENSE_REIMBURSED

  // Coach Management - NEW v7.8.0
  COACH_RATE_CREATED
  COACH_RATE_UPDATED
  COACH_RATE_DELETED
  COACH_ASSIGNMENT_CREATED
  COACH_ASSIGNMENT_UPDATED
  COACH_ASSIGNMENT_ENDED
  COACH_CERTIFICATION_ADDED
  COACH_CERTIFICATION_EXPIRED
  COACH_REVIEW_CREATED
  COACH_REVIEW_ACKNOWLEDGED

  // Export & Reports - NEW v7.8.0
  EXPORT_REQUESTED
  EXPORT_COMPLETED
  EXPORT_FAILED
  EXPORT_DOWNLOADED
  EXPORT_TEMPLATE_CREATED
  EXPORT_TEMPLATE_UPDATED
  EXPORT_TEMPLATE_DELETED
  REPORT_SCHEDULED
  REPORT_GENERATED

  // Player Development - NEW v7.8.0
  DEVELOPMENT_PLAN_CREATED
  DEVELOPMENT_PLAN_UPDATED
  MILESTONE_COMPLETED
  SKILL_ASSESSED
  MENTORSHIP_STARTED
  MENTORSHIP_ENDED

  // Wellness - NEW v7.8.0
  WELLNESS_CHECK_FLAGGED
  RECOVERY_PHASE_CHANGED

  // Payments - NEW v7.8.0
  PAYMENT_PLAN_CREATED
  INSTALLMENT_PAID
  INSTALLMENT_OVERDUE
  SCHOLARSHIP_AWARDED
  SCHOLARSHIP_REVOKED

  // Gamification - NEW v7.8.0
  CHALLENGE_CREATED
  CHALLENGE_COMPLETED
  LEADERBOARD_UPDATED
  STREAK_MILESTONE_REACHED
  SEASON_AWARD_ANNOUNCED

  // GDPR & Security
  CONSENT_UPDATED
  GDPR_REQUEST
  DATA_RETENTION_APPLIED
  SYSTEM_MAINTENANCE
  API_KEY_GENERATED
  API_KEY_REVOKED
  SUSPICIOUS_LOGIN
  SECURITY_ALERT
}

// ============================================================================
// üìã ENUMS - SPORT & POSITION (Full 12-Sport Support)
// ============================================================================

enum Sport {
  FOOTBALL
  NETBALL
  RUGBY
  CRICKET
  AMERICAN_FOOTBALL
  BASKETBALL
  HOCKEY
  LACROSSE
  AUSTRALIAN_RULES
  GAELIC_FOOTBALL
  FUTSAL
  BEACH_FOOTBALL
}

enum Position {
  // Football / Soccer / Futsal / Beach Football
  GOALKEEPER
  LEFT_BACK
  CENTER_BACK
  RIGHT_BACK
  LEFT_WING_BACK
  RIGHT_WING_BACK
  DEFENSIVE_MIDFIELDER
  CENTRAL_MIDFIELDER
  LEFT_MIDFIELDER
  RIGHT_MIDFIELDER
  ATTACKING_MIDFIELDER
  LEFT_WINGER
  RIGHT_WINGER
  STRIKER
  CENTER_FORWARD
  SECOND_STRIKER

  // Netball
  GOALKEEPER_NETBALL
  GOAL_ATTACK
  WING_ATTACK
  CENTER
  WING_DEFENSE
  GOAL_DEFENSE
  GOAL_SHOOTER

  // Rugby Union
  PROP
  HOOKER
  LOCK
  FLANKER
  NUMBER_8
  SCRUM_HALF
  FLY_HALF
  INSIDE_CENTER
  OUTSIDE_CENTER
  FULLBACK

  // Rugby League (additional)
  HOOKER_LEAGUE
  PROP_LEAGUE
  SECOND_ROW
  LOOSE_FORWARD

  // American Football
  QUARTERBACK
  RUNNING_BACK
  WIDE_RECEIVER
  TIGHT_END
  LEFT_TACKLE
  LEFT_GUARD
  CENTER_POSITION
  RIGHT_GUARD
  RIGHT_TACKLE
  LINEBACKER
  DEFENSIVE_END
  DEFENSIVE_TACKLE
  SAFETY
  CORNERBACK
  PUNTER
  KICKER

  // Basketball
  POINT_GUARD
  SHOOTING_GUARD
  SMALL_FORWARD
  POWER_FORWARD
  CENTER_BASKETBALL

  // Cricket
  BATSMAN
  BOWLER
  ALL_ROUNDER
  FIELDER
  WICKET_KEEPER

  // Hockey / Lacrosse
  GOALTENDER
  DEFENSEMAN
  WINGER
  CENTER_HOCKEY

  // Australian Rules Football (AFL)
  FULL_FORWARD
  HALF_FORWARD
  FULL_BACK_AFL
  HALF_BACK_AFL
  RUCK
  RUCK_ROVER
  ROVER

  // General
  UTILITY
  SUBSTITUTE
}

enum PreferredFoot {
  LEFT
  RIGHT
  BOTH
}

enum FormationType {
  // Football / Soccer
  FOUR_FOUR_TWO
  FOUR_THREE_THREE
  THREE_FIVE_TWO
  FIVE_THREE_TWO
  FIVE_FOUR_ONE
  THREE_FOUR_THREE
  FOUR_TWO_THREE_ONE
  FOUR_ONE_FOUR_ONE
  THREE_THREE_FOUR
  FIVE_TWO_THREE
  TWO_THREE_FIVE
  FOUR_ONE_TWO_THREE
  FOUR_FOUR_ONE_ONE
  FOUR_THREE_TWO_ONE
  FOUR_FIVE_ONE

  // Futsal / Small-Sided
  ONE_THREE_ONE
  TWO_THREE
  TWO_ONE_TWO
  THREE_TWO
  ONE_TWO_TWO

  // American Football
  I_FORMATION
  SHOTGUN
  PISTOL
  SPREAD
  SINGLE_BACK
  PRO_SET
  WILDCAT

  // Netball
  PODS
  DIAMOND
  FLAT_LINE

  // Custom
  CUSTOM
}

// ============================================================================
// üìã ENUMS - MATCH & COMPETITION
// ============================================================================

enum MatchType {
  LEAGUE
  CUP
  FRIENDLY
  PLAYOFF
  TOURNAMENT
  QUALIFIER
  FINAL
  SEMI_FINAL
  QUARTER_FINAL
  GROUP_STAGE
  TRAINING_MATCH
  PRACTICE
  EXHIBITION
}

enum MatchStatus {
  SCHEDULED
  WARMUP
  LIVE
  HALFTIME
  SECOND_HALF
  EXTRA_TIME_FIRST
  EXTRA_TIME_SECOND
  PENALTIES
  FINISHED
  CANCELLED
  POSTPONED
  ABANDONED
  REPLAY_SCHEDULED
  VOIDED
  DELAYED
  SUSPENDED
}

enum CompetitionType {
  LEAGUE
  CUP
  TOURNAMENT
  FRIENDLY_SERIES
  SUPER_CUP
  PLAYOFF
  QUALIFIER
  CHAMPIONSHIP
  INVITATIONAL
}

enum CompetitionStage {
  GROUP_STAGE
  ROUND_OF_32
  ROUND_OF_16
  QUARTER_FINAL
  SEMI_FINAL
  THIRD_PLACE
  FINAL
  PRELIMINARY
  FIRST_ROUND
  SECOND_ROUND
  PLAYOFF_ROUND
}

enum LeagueFormat {
  ROUND_ROBIN
  DOUBLE_ROUND_ROBIN
  KNOCKOUT
  GROUP_KNOCKOUT
  ROUND_ROBIN_WITH_PLAYOFFS
  SWISS_SYSTEM
  LADDER_SYSTEM
  HOME_AND_AWAY
  CUSTOM
}

enum LeagueVisibility {
  PUBLIC
  PRIVATE
  UNLISTED
  INVITE_ONLY
  FRIENDS_ONLY
}

enum ResultApprovalStatus {
  PENDING
  APPROVED
  REJECTED
  DISPUTED
  REQUIRES_REVISION
  UNDER_REVIEW
  AUTO_APPROVED
}

enum MatchAttendanceStatus {
  AVAILABLE
  UNAVAILABLE
  CONFIRMED
  MAYBE
  LATE
  NO_SHOW
  EXCUSED_ABSENCE
  INJURED
  ILL
  SUSPENDED
  NOT_SELECTED
  SUBSTITUTE
  STARTING_LINEUP
  ATTENDED
  UNUSED_SUB
  UNUSED_SQUAD
  INTERNATIONAL_DUTY
  LOAN
}

enum MatchEventType {
  // Universal Events
  GOAL
  ASSIST
  YELLOW_CARD
  SECOND_YELLOW
  RED_CARD
  SUBSTITUTION_ON
  SUBSTITUTION_OFF
  INJURY
  INJURY_TIME
  FULLTIME
  HALFTIME
  KICKOFF
  PENALTY_SCORED
  PENALTY_MISSED
  PENALTY_SAVED
  OWN_GOAL
  VAR_REVIEW
  VAR_DECISION
  OFFSIDE
  FOUL
  FREE_KICK
  CORNER
  THROW_IN
  GOAL_KICK
  CHALLENGE_REVIEW
  TIMEOUT
  INTERCEPT
  REBOUND
  CAPTAIN_CHANGE
  WEATHER_DELAY
  FLOODLIGHT_FAILURE
  PERIOD_START
  PERIOD_END
  OVERTIME_START
  SHOOTOUT_START

  // Netball-Specific
  CENTER_PASS
  OBSTRUCTION
  CONTACT
  HELD_BALL
  STEPPING
  OVER_THIRD

  // Rugby-Specific
  TRY
  CONVERSION
  PENALTY_GOAL
  DROP_GOAL
  SCRUM
  LINEOUT
  MAUL
  RUCK
  KNOCK_ON
  HIGH_TACKLE
  SIN_BIN
  YELLOW_CARD_RUGBY
  RED_CARD_RUGBY

  // Cricket-Specific
  WICKET
  BOUNDARY
  SIX
  MAIDEN_OVER
  WIDE
  NO_BALL
  BYE
  LEG_BYE
  OVERTHROW
  RUN_OUT
  CAUGHT
  BOWLED
  LBW
  STUMPED

  // Basketball-Specific
  THREE_POINTER
  TWO_POINTER
  FREE_THROW_MADE
  FREE_THROW_MISSED
  FAST_BREAK
  TURNOVER
  OFFENSIVE_FOUL
  DEFENSIVE_FOUL
  TRAVEL
  DOUBLE_DRIBBLE
  BLOCK
  STEAL
  DUNK
  ALLEY_OOP

  // American Football-Specific
  TOUCHDOWN
  FIELD_GOAL
  SAFETY_SCORE
  INTERCEPTION
  FUMBLE
  SACK
  TWO_POINT_CONVERSION
  EXTRA_POINT
  PUNT
  KICKOFF_RETURN
  FAIR_CATCH

  // Hockey-Specific
  HAT_TRICK
  MAJOR_PENALTY
  MINOR_PENALTY
  FIGHT
  POWER_PLAY_GOAL
  SHORTHANDED_GOAL
  EMPTY_NET_GOAL

  // Australian Rules-Specific
  BEHIND
  RUSHED_BEHIND
  MARK
  HANDBALL
  BOUNCE
}

// ============================================================================
// üìã ENUMS - CLUB, TRAINING, MEDIA, BILLING
// ============================================================================

enum ClubMemberRole {
  OWNER
  MANAGER
  HEAD_COACH
  ASSISTANT_COACH
  PLAYER
  STAFF
  TREASURER
  SCOUT
  ANALYST
  MEDICAL_STAFF
  PHYSIOTHERAPIST
  NUTRITIONIST
  PSYCHOLOGIST
  PERFORMANCE_COACH
  GOALKEEPING_COACH
  KIT_MANAGER
  MEDIA_OFFICER
  VIDEO_ANALYST
}

enum TeamType {
  PROFESSIONAL
  SEMI_PROFESSIONAL
  AMATEUR
  ACADEMY
  YOUTH
  RECREATIONAL
  UNIVERSITY
  SCHOOL
}

enum TeamStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  ARCHIVED
  DISSOLVED
}

enum TrainingIntensity {
  RECOVERY
  LOW
  MEDIUM
  HIGH
  MAXIMUM
  COMPETITIVE
}

enum TrainingCategory {
  PASSING
  SHOOTING
  DEFENDING
  POSSESSION
  SET_PIECES
  DRIBBLING
  CONDITIONING
  STRENGTH_POWER
  SPEED_AGILITY
  FLEXIBILITY
  BALANCE_COORDINATION
  ENDURANCE
  TACTICAL
  FORMATION_WORK
  GAME_STRATEGY
  TRANSITIONS
  RECOVERY
  MENTAL_PREPARATION
  VIDEO_ANALYSIS
  TEAM_BUILDING
  GOALKEEPER_SPECIFIC
  POSITION_SPECIFIC
  SPORT_SPECIFIC
  WARM_UP
  COOL_DOWN
  SCRIMMAGE
  MATCH_SIMULATION
  INDIVIDUAL_TRAINING
  GROUP_TRAINING
}

enum TrainingStatus {
  DRAFT
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  POSTPONED
}

enum AttendanceStatus {
  PRESENT
  ABSENT
  EXCUSED
  LATE
  LEFT_EARLY
  PARTIAL
  INJURED
  SICK
  SUSPENDED
}

enum MediaType {
  VIDEO
  IMAGE
  DOCUMENT
  AUDIO
}

enum MediaCategory {
  MATCH_HIGHLIGHT
  MATCH_FULL
  MATCH_ANALYSIS
  GOAL_CLIP
  SAVE_CLIP
  INCIDENT_CLIP
  TRAINING_SESSION
  TRAINING_DRILL
  TRAINING_EXERCISE
  TRAINING_ANALYSIS
  PLAYER_HIGHLIGHT
  PLAYER_INTERVIEW
  PLAYER_PROFILE
  TEAM_PROMO
  TEAM_ANNOUNCEMENT
  PRESS_CONFERENCE
  TACTICS_DOCUMENT
  MEDICAL_DOCUMENT
  CONTRACT_DOCUMENT
  REPORT
  THUMBNAIL
  PROFILE_PHOTO
  BANNER
  LOGO
  OTHER
}

enum MediaVisibility {
  PUBLIC
  CLUB_ONLY
  TEAM_ONLY
  STAFF_ONLY
  PRIVATE
}

enum MediaProcessingStatus {
  PENDING
  UPLOADING
  PROCESSING
  TRANSCODING
  COMPLETED
  FAILED
  CANCELLED
}

enum VideoQuality {
  Q_360P
  Q_480P
  Q_720P
  Q_1080P
  Q_2K
  Q_4K
  ORIGINAL
}

enum TranscodingStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  CANCELLED
  QUEUED
}

enum VideoProcessingProvider {
  MUX
  AWS_MEDIACONVERT
  BUNNY_CDN
  CLOUDINARY
  INTERNAL
  VERCEL_BLOB
}

enum SocialPlatform {
  INSTAGRAM
  TWITTER
  FACEBOOK
  YOUTUBE
  TIKTOK
  LINKEDIN
}

enum FitnessAssessmentType {
  PRE_SEASON
  MID_SEASON
  POST_SEASON
  RETURN_TO_PLAY
  INJURY_FOLLOW_UP
  ROUTINE
  TRANSFER_MEDICAL
  INITIAL_REGISTRATION
}

enum FitnessStatus {
  FIT
  FIT_WITH_CAUTION
  LIMITED
  NOT_FIT
  PENDING_REVIEW
  CLEARED
}

enum InjurySeverity {
  MINOR
  MODERATE
  SEVERE
  CRITICAL
  CAREER_THREATENING
}

enum InjuryStatus {
  ACTIVE
  RECOVERING
  REHABILITATION
  CLEARED
  CHRONIC
}

enum TimesheetStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  APPROVED
  REJECTED
  PAID
  DISPUTED
  ARCHIVED
}

enum JoinRequestStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
  EXPIRED
  WITHDRAWN
}

enum JobPostingStatus {
  DRAFT
  OPEN
  PAUSED
  CLOSED
  FILLED
  CANCELLED
  EXPIRED
}

enum JobApplicationStatus {
  PENDING
  REVIEWING
  SHORTLISTED
  INTERVIEW_SCHEDULED
  INTERVIEW_COMPLETED
  OFFERED
  ACCEPTED
  REJECTED
  WITHDRAWN
  HIRED
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  INTERNSHIP
  VOLUNTEER
  FREELANCE
  SEASONAL
}

enum JobCategory {
  COACHING
  MANAGEMENT
  MEDICAL
  ANALYSIS
  SCOUTING
  ADMINISTRATION
  MEDIA
  OPERATIONS
  FINANCE
  YOUTH_DEVELOPMENT
  PERFORMANCE
  OTHER
}

enum ExperienceLevel {
  ENTRY
  JUNIOR
  MID
  SENIOR
  LEAD
  DIRECTOR
  EXECUTIVE
}

enum TransferType {
  PERMANENT
  LOAN
  FREE_TRANSFER
  YOUTH_DEVELOPMENT
  TRIAL
  EXCHANGE
}

enum TransferStatus {
  PENDING
  NEGOTIATING
  AGREED
  COMPLETED
  CANCELLED
  REJECTED
  EXPIRED
}

enum FacilityType {
  STADIUM
  TRAINING_GROUND
  INDOOR_ARENA
  GYM
  SWIMMING_POOL
  MEDICAL_CENTER
  MEETING_ROOM
  OFFICE
  CHANGING_ROOM
  HOSPITALITY
  OUTDOOR_PITCH
  INDOOR_PITCH
  MULTI_PURPOSE
}

enum VenueType {
  STADIUM
  ARENA
  SPORTS_COMPLEX
  SCHOOL_GROUND
  PARK
  COMMUNITY_CENTER
  UNIVERSITY
  PRIVATE_FACILITY
  NEUTRAL_VENUE
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
  NO_SHOW
}

enum SubscriptionStatus {
  ACTIVE
  CANCELLED
  EXPIRED
  PAUSED
  PAST_DUE
  TRIAL
  SUSPENDED
  DOWNGRADED
  PENDING_UPGRADE
  PENDING_CANCELLATION
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
  DISPUTED
  CANCELLED
  PROCESSING
  CHARGEBACK
}

enum PaymentType {
  SUBSCRIPTION
  COACHING_FEE
  MATCH_FEE
  TOURNAMENT_FEE
  TRAINING_FEE
  FACILITY_RENTAL
  EQUIPMENT
  REFUND
  BONUS
  SALARY
  COMMISSION
  TRANSFER_FEE
  LOAN_FEE
  SPONSORSHIP
  REFEREE_FEE
  REFEREE_EXPENSES
  MEMBERSHIP_FEE
  PLAYER_FEE
  CLUB_FEE
  LEAGUE_FEE
  EXPENSE_REIMBURSEMENT
  BUDGET_ALLOCATION
  INSTALLMENT
  SCHOLARSHIP_DISBURSEMENT
  OTHER
}

enum ChatType {
  DIRECT
  GROUP
  TEAM
  CLUB
  ANNOUNCEMENT
}

enum MatchOfficialRole {
  REFEREE
  ASSISTANT_REFEREE_1
  ASSISTANT_REFEREE_2
  FOURTH_OFFICIAL
  VAR_OFFICIAL
  AVAR_OFFICIAL
  RESERVE_ASSISTANT
  MATCH_COMMISSIONER
  REFEREE_ASSESSOR
}

enum AnnouncementPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

enum AnnouncementStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

enum GoalType {
  PERFORMANCE
  DEVELOPMENT
  FITNESS
  BEHAVIORAL
  TEAM
}

enum GoalStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  EXCEEDED
  MISSED
  CANCELLED
}

enum InvitationStatus {
  PENDING
  ACCEPTED
  REJECTED
  EXPIRED
  CANCELLED
  REVOKED
}

enum WebhookEvent {
  // Match Events
  MATCH_CREATED
  MATCH_STARTED
  MATCH_FINISHED
  MATCH_CANCELLED
  MATCH_LINEUP_SET

  // Player Events
  PLAYER_ADDED
  PLAYER_UPDATED
  PLAYER_INJURED
  PLAYER_TRANSFERRED
  PLAYER_CLEARED

  // Team & Competition
  TEAM_UPDATED
  TEAM_CREATED
  COMPETITION_CREATED
  COMPETITION_STARTED
  COMPETITION_FINISHED

  // Billing
  SUBSCRIPTION_UPDATED
  PAYMENT_RECEIVED

  // User
  USER_CREATED
  USER_DELETED

  // Fitness & Medical
  FITNESS_ASSESSMENT_COMPLETED
  PLAYER_RTP_CLEARED

  // Predictions
  PREDICTION_CREATED
  PREDICTION_VERIFIED
  HIGH_RISK_PREDICTION

  // Scouting
  SCOUTING_REPORT_SUBMITTED
  WATCHLIST_ALERT

  // Referee
  REFEREE_ASSIGNED
  REFEREE_REPORT_SUBMITTED

  // Training & Drills
  TRAINING_SCHEDULED
  TRAINING_COMPLETED
  DRILL_CREATED
  DRILL_LIBRARY_UPDATED

  // Budget & Expense
  BUDGET_CREATED
  BUDGET_ALERT
  BUDGET_THRESHOLD_REACHED
  EXPENSE_SUBMITTED
  EXPENSE_APPROVED
  EXPENSE_REJECTED

  // Coach Management - NEW v7.8.0
  COACH_ASSIGNED
  COACH_UNASSIGNED
  COACH_CERTIFICATION_EXPIRING
  TIMESHEET_SUBMITTED
  TIMESHEET_APPROVED
  TIMESHEET_REJECTED

  // Export & Reports - NEW v7.8.0
  EXPORT_COMPLETED
  REPORT_GENERATED

  // Player Development - NEW v7.8.0
  DEVELOPMENT_MILESTONE_COMPLETED
  SKILL_ASSESSMENT_COMPLETED

  // Wellness - NEW v7.8.0
  WELLNESS_ALERT
  RECOVERY_PHASE_CHANGED
  PLAYER_CLEARED_TO_PLAY_WELLNESS

  // Payments - NEW v7.8.0
  PAYMENT_DUE
  PAYMENT_OVERDUE
  PAYMENT_RECEIVED_INSTALLMENT

  // Gamification - NEW v7.8.0
  CHALLENGE_STARTED
  CHALLENGE_ENDED
  LEADERBOARD_POSITION_CHANGED
  STREAK_MILESTONE
  SEASON_AWARD_ANNOUNCED

  // Other
  RESULT_APPROVED
  ANNOUNCEMENT_POSTED
  JOB_POSTED
  JOB_APPLICATION_RECEIVED
  JOIN_REQUEST_RECEIVED
  MEDIA_UPLOADED
  MEDIA_PROCESSED
}

// ============================================================================
// ü§ñ AI PREDICTION SYSTEM (v7.6.0)
// ============================================================================

model Prediction {
  id             String  @id @default(cuid())
  organisationId String?
  clubId         String?

  type   PredictionType
  status PredictionStatus @default(PENDING)
  impact PredictionImpact @default(MEDIUM)

  title       String
  description String  @db.Text
  summary     String?

  confidence       Float
  actualOutcome    String?
  accuracyScore    Float?
  
  modelVersion     String?
  modelName        String?
  dataSourcesUsed  String[]

  relatedEntityType String?
  relatedEntityId   String?
  relatedEntityName String?

  secondaryEntityType String?
  secondaryEntityId   String?
  secondaryEntityName String?

  recommendedActions String[] @default([])
  riskFactors        String[] @default([])
  opportunities      String[] @default([])

  predictionData Json?

  predictionPeriod   String?
  validFrom          DateTime?
  validUntil         DateTime?
  outcomeDate        DateTime?

  isPublic       Boolean        @default(false)
  visibleToRoles ClubMemberRole[] @default([])

  createdBy   String?
  verifiedBy  String?
  verifiedAt  DateTime?
  reviewNotes String?

  tags     String[] @default([])
  sport    Sport?
  priority Int      @default(0)

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  feedback PredictionFeedback[]

  @@index([organisationId])
  @@index([clubId])
  @@index([type])
  @@index([status])
  @@index([impact])
  @@index([relatedEntityType, relatedEntityId])
  @@index([createdAt])
  @@index([validUntil])
  @@index([sport])
  @@index([deletedAt])
  @@map("predictions")
}

model PredictionFeedback {
  id           String @id @default(cuid())
  predictionId String

  wasAccurate    Boolean?
  accuracyRating Int?
  comments       String?  @db.Text

  actualOutcome     String?
  outcomeDetails    Json?
  deviationFromPrediction Float?

  submittedBy     String
  submitterRole   UserRole?
  submitterNotes  String?

  usedForTraining Boolean   @default(false)
  trainingBatchId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  prediction Prediction @relation(fields: [predictionId], references: [id], onDelete: Cascade)

  @@index([predictionId])
  @@index([wasAccurate])
  @@index([submittedBy])
  @@index([createdAt])
  @@map("prediction_feedback")
}

// ============================================================================
// üîç SCOUT WATCHLIST & ATTENDANCE (v7.6.0)
// ============================================================================

model ScoutWatchlist {
  id       String @id @default(cuid())
  scoutId  String
  playerId String

  status   WatchlistStatus   @default(MONITORING)
  priority WatchlistPriority @default(MEDIUM)

  playerName        String?
  playerPosition    Position?
  playerAge         Int?
  playerClub        String?
  playerNationality String?

  overallRating    Float?
  technicalRating  Float?
  tacticalRating   Float?
  physicalRating   Float?
  mentalRating     Float?
  potentialRating  Float?

  estimatedValue    Float?
  currency          String  @default("GBP")
  salaryExpectation Float?

  matchesWatched   Int      @default(0)
  reportsWritten   Int      @default(0)
  lastWatched      DateTime?
  firstAddedAt     DateTime @default(now())

  strengths         String[] @default([])
  weaknesses        String[] @default([])
  comparablePlayers String[] @default([])
  notes             String?  @db.Text
  tags              String[] @default([])

  recommendedTo       String?
  recommendedAt       DateTime?
  recommendationNotes String?

  alertOnTransfer  Boolean @default(false)
  alertOnInjury    Boolean @default(false)
  alertOnForm      Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  scout  Scout  @relation(fields: [scoutId], references: [id], onDelete: Cascade)
  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([scoutId, playerId])
  @@index([scoutId])
  @@index([playerId])
  @@index([status])
  @@index([priority])
  @@index([createdAt])
  @@map("scout_watchlist")
}

model ScoutMatchAttendance {
  id      String @id @default(cuid())
  scoutId String
  matchId String

  matchDate   DateTime
  homeTeam    String?
  awayTeam    String?
  competition String?
  venue       String?

  playersWatched String[] @default([])

  preMatchNotes  String? @db.Text
  postMatchNotes String? @db.Text

  reportsGenerated Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  scout Scout @relation(fields: [scoutId], references: [id], onDelete: Cascade)

  @@unique([scoutId, matchId])
  @@index([scoutId])
  @@index([matchId])
  @@index([matchDate])
  @@map("scout_match_attendance")
}

// ============================================================================
// ‚ö´ REFEREE SUPPORT MODELS (v7.6.0)
// ============================================================================

model RefereeAvailability {
  id        String @id @default(cuid())
  refereeId String

  date      DateTime @db.Date
  startTime DateTime?
  endTime   DateTime?
  
  status RefereeAvailabilityStatus @default(AVAILABLE)

  matchId String?
  venue   String?

  notes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  referee Referee @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@unique([refereeId, date])
  @@index([refereeId])
  @@index([date])
  @@index([status])
  @@map("referee_availability")
}

model RefereeQualification {
  id        String @id @default(cuid())
  refereeId String

  name            String
  issuingBody     String
  certificateNumber String?

  sport Sport?

  level        String?
  dateObtained DateTime
  expiryDate   DateTime?

  documentUrl  String?
  isVerified   Boolean @default(false)
  verifiedBy   String?
  verifiedAt   DateTime?

  notes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  referee Referee @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([sport])
  @@index([expiryDate])
  @@map("referee_qualifications")
}

model RefereePayment {
  id        String @id @default(cuid())
  refereeId String
  matchId   String?

  amount        Float
  currency      String        @default("GBP")
  paymentType   PaymentType   @default(REFEREE_FEE)
  status        PaymentStatus @default(PENDING)

  matchFee    Float?
  travelFee   Float?
  expenses    Float?
  deductions  Float?

  invoiceNumber String? @unique
  invoiceDate   DateTime?
  dueDate       DateTime?
  paidDate      DateTime?

  paymentMethod String?
  reference     String?

  notes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  referee Referee @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([matchId])
  @@index([status])
  @@index([paymentType])
  @@index([paidDate])
  @@map("referee_payments")
}

model RefereeMatchReport {
  id        String @id @default(cuid())
  refereeId String
  matchId   String @unique

  homeScore Int?
  awayScore Int?

  yellowCardsHome Int @default(0)
  yellowCardsAway Int @default(0)
  redCardsHome    Int @default(0)
  redCardsAway    Int @default(0)

  incidents Json?

  pitchCondition String?
  weather        String?
  attendance     Int?

  matchDifficulty Int?
  playerBehavior  Int?
  crowdBehavior   Int?

  matchNotes        String? @db.Text
  incidentReport    String? @db.Text
  improvementAreas  String? @db.Text

  submittedAt DateTime?
  approvedBy  String?
  approvedAt  DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  referee Referee @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([matchId])
  @@index([submittedAt])
  @@map("referee_match_reports")
}

// ============================================================================
// üéØ TRAINING DRILL LIBRARY (v7.7.0)
// ============================================================================

model TrainingDrill {
  id     String  @id @default(cuid())
  clubId String?

  name        String
  description String? @db.Text

  category   DrillCategory
  intensity  DrillIntensity  @default(MEDIUM)
  difficulty DrillDifficulty @default(INTERMEDIATE)

  sport Sport?

  defaultDuration Int @default(15)
  minPlayers      Int?
  maxPlayers      Int?

  equipment   String[] @default([])
  objectives  String[] @default([])
  keyPoints   String[] @default([])
  variations  String[] @default([])
  progressions String[] @default([])

  instructions String? @db.Text
  coachingTips String? @db.Text
  commonErrors String? @db.Text

  diagramUrl   String?
  videoUrl     String?
  thumbnailUrl String?

  ageGroups String[] @default([])
  positions Position[] @default([])

  tags String[] @default([])

  isPublic    Boolean @default(false)
  isFavorite  Boolean @default(false)
  isArchived  Boolean @default(false)

  usageCount    Int   @default(0)
  averageRating Float?
  totalRatings  Int   @default(0)

  createdBy String?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club          Club?                  @relation("clubDrills", fields: [clubId], references: [id], onDelete: SetNull)
  creator       User?                  @relation("drillsCreated", fields: [createdBy], references: [id], onDelete: SetNull)
  sessionDrills TrainingSessionDrill[]

  @@index([clubId])
  @@index([category])
  @@index([intensity])
  @@index([difficulty])
  @@index([sport])
  @@index([isPublic])
  @@index([isArchived])
  @@index([createdBy])
  @@index([deletedAt])
  @@map("training_drills")
}

model TrainingSessionDrill {
  id        String @id @default(cuid())
  sessionId String
  drillId   String

  order    Int @default(0)
  duration Int

  notes         String? @db.Text
  modifications String? @db.Text

  intensity DrillIntensity?

  isCompleted Boolean   @default(false)
  completedAt DateTime?

  rating       Float?
  coachNotes   String? @db.Text
  playerNotes  String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  session TrainingSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  drill   TrainingDrill   @relation(fields: [drillId], references: [id], onDelete: Cascade)

  @@unique([sessionId, drillId, order])
  @@index([sessionId])
  @@index([drillId])
  @@index([order])
  @@map("training_session_drills")
}

// ============================================================================
// üí∞ BUDGET & EXPENSE SYSTEM (v7.7.0)
// ============================================================================

model Budget {
  id             String  @id @default(cuid())
  organisationId String?
  clubId         String?
  teamId         String?
  seasonId       String?

  name        String
  description String? @db.Text

  periodType BudgetPeriodType @default(SEASON)
  startDate  DateTime
  endDate    DateTime

  totalBudget Float
  currency    String @default("GBP")

  status BudgetStatus @default(DRAFT)

  approvedBy   String?
  approvedAt   DateTime?
  approvalNote String?

  alertThreshold Float? @default(80)
  alertSent      Boolean @default(false)
  alertSentAt    DateTime?

  notes String? @db.Text

  createdBy String

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation?    @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?            @relation("clubBudgets", fields: [clubId], references: [id], onDelete: SetNull)
  team         Team?            @relation("teamBudgets", fields: [teamId], references: [id], onDelete: SetNull)
  season       Season?          @relation(fields: [seasonId], references: [id], onDelete: SetNull)
  creator      User             @relation("budgetsCreated", fields: [createdBy], references: [id])
  categories   BudgetCategory[]
  expenses     Expense[]

  @@index([organisationId])
  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@index([createdBy])
  @@index([deletedAt])
  @@map("budgets")
}

model BudgetCategory {
  id       String @id @default(cuid())
  budgetId String

  name     String
  category ExpenseCategory

  allocatedAmount Float
  spentAmount     Float @default(0)

  alertThreshold Float? @default(90)
  alertSent      Boolean @default(false)

  notes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  budget   Budget    @relation(fields: [budgetId], references: [id], onDelete: Cascade)
  expenses Expense[]

  @@unique([budgetId, category])
  @@index([budgetId])
  @@index([category])
  @@map("budget_categories")
}

model Expense {
  id       String  @id @default(cuid())
  budgetId String?
  categoryId String?
  clubId   String?
  teamId   String?

  description String
  amount      Float
  currency    String @default("GBP")

  category ExpenseCategory
  status   ExpenseStatus   @default(DRAFT)

  expenseDate DateTime
  dueDate     DateTime?
  paidDate    DateTime?

  vendor        String?
  invoiceNumber String?
  invoiceUrl    String?
  receiptUrls   String[] @default([])

  paymentMethod String?
  paymentRef    String?

  isReimbursement     Boolean @default(false)
  reimburseTo         String?
  reimbursementStatus String?
  reimbursedAt        DateTime?

  submittedBy String
  submittedAt DateTime?

  approvedBy     String?
  approvedAt     DateTime?
  approvalNotes  String?
  rejectedBy     String?
  rejectedAt     DateTime?
  rejectionNotes String?

  notes    String? @db.Text
  tags     String[] @default([])
  metadata Json?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  budget         Budget?         @relation(fields: [budgetId], references: [id], onDelete: SetNull)
  budgetCategory BudgetCategory? @relation(fields: [categoryId], references: [id], onDelete: SetNull)
  club           Club?           @relation("clubExpenses", fields: [clubId], references: [id], onDelete: SetNull)
  team           Team?           @relation("teamExpenses", fields: [teamId], references: [id], onDelete: SetNull)
  submitter      User            @relation("expensesCreated", fields: [submittedBy], references: [id])
  approver       User?           @relation("expensesApproved", fields: [approvedBy], references: [id])

  @@index([budgetId])
  @@index([categoryId])
  @@index([clubId])
  @@index([teamId])
  @@index([category])
  @@index([status])
  @@index([expenseDate])
  @@index([submittedBy])
  @@index([approvedBy])
  @@index([deletedAt])
  @@map("expenses")
}

// ============================================================================
// üìä EXPORT & REPORTING SYSTEM (NEW v7.8.0)
// ============================================================================

model ExportRequest {
  id             String  @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?

  exportType ExportType
  format     ExportFormat @default(CSV)
  
  filters Json?
  fields  String[] @default([])
  
  sport                Sport?
  includeSportSpecific Boolean @default(true)

  status       ExportStatus @default(PENDING)
  progress     Int          @default(0)
  recordCount  Int?
  errorMessage String?

  filename  String?
  fileUrl   String?
  fileSize  Int?
  checksum  String?
  expiresAt DateTime?

  startedAt   DateTime?
  completedAt DateTime?
  durationMs  Int?

  ipAddress String?
  userAgent String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User          @relation("userExports", fields: [userId], references: [id], onDelete: Cascade)
  organisation Organisation? @relation("orgExports", fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?         @relation("clubExports", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([status])
  @@index([exportType])
  @@index([createdAt])
  @@map("export_requests")
}

model ExportTemplate {
  id             String  @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?

  name        String
  description String?

  exportType ExportType
  format     ExportFormat @default(CSV)

  filters Json?
  fields  String[]
  
  sport                Sport?
  includeSportSpecific Boolean @default(true)

  columnMapping Json?

  isPublic  Boolean @default(false)
  isDefault Boolean @default(false)

  usageCount Int       @default(0)
  lastUsedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User          @relation("userExportTemplates", fields: [userId], references: [id], onDelete: Cascade)
  organisation Organisation? @relation("orgExportTemplates", fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?         @relation("clubExportTemplates", fields: [clubId], references: [id], onDelete: SetNull)

  @@unique([userId, name])
  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([exportType])
  @@index([isPublic])
  @@map("export_templates")
}

model ReportSchedule {
  id             String  @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?

  name        String
  description String?

  reportType ExportType
  format     ExportFormat @default(PDF)
  templateId String?

  frequency    ReportFrequency
  dayOfWeek    Int?
  dayOfMonth   Int?
  time         String?
  timezone     String          @default("Europe/London")

  recipients String[]
  
  filters Json?

  isActive      Boolean   @default(true)
  lastRunAt     DateTime?
  nextRunAt     DateTime?
  lastStatus    String?
  failureCount  Int       @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User          @relation("userReportSchedules", fields: [userId], references: [id], onDelete: Cascade)
  organisation Organisation? @relation("orgReportSchedules", fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?         @relation("clubReportSchedules", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([isActive])
  @@index([nextRunAt])
  @@map("report_schedules")
}

model SportFieldConfig {
  id String @id @default(cuid())

  sport     Sport
  fieldName String
  
  displayName  String
  description  String?
  category     String
  
  dataType     String
  unit         String?
  
  includeInExport   Boolean @default(true)
  exportOrder       Int     @default(100)
  exportHeader      String?
  
  aggregationType   String?
  
  minValue Float?
  maxValue Float?

  isRequired Boolean @default(false)
  isActive   Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([sport, fieldName])
  @@index([sport])
  @@index([category])
  @@index([isActive])
  @@map("sport_field_configs")
}

// ============================================================================
// üèãÔ∏è ENHANCED COACH MANAGEMENT (NEW v7.8.0)
// ============================================================================

model CoachRate {
  id      String @id @default(cuid())
  coachId String
  clubId  String?

  rateType CoachRateType @default(HOURLY)
  amount   Float
  currency String        @default("GBP")

  effectiveFrom DateTime  @default(now())
  effectiveTo   DateTime?

  sport Sport?

  trainingRate Float?
  matchRate    Float?
  travelRate   Float?
  adminRate    Float?

  contractId String?
  notes      String?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  coach Coach  @relation("coachRates", fields: [coachId], references: [id], onDelete: Cascade)
  club  Club?  @relation("clubCoachRates", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([coachId])
  @@index([clubId])
  @@index([isActive])
  @@index([effectiveFrom])
  @@map("coach_rates")
}

model CoachAssignment {
  id      String @id @default(cuid())
  coachId String
  teamId  String
  clubId  String

  assignmentType CoachAssignmentType @default(HEAD_COACH)
  isPrimary      Boolean             @default(false)

  seasonId  String?
  startDate DateTime
  endDate   DateTime?

  responsibilities String[]
  focusAreas       String[]

  rating     Float?
  reviewDate DateTime?
  reviewedBy String?

  isActive Boolean @default(true)
  notes    String?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  coach  Coach   @relation("coachAssignments", fields: [coachId], references: [id], onDelete: Cascade)
  team   Team    @relation("teamCoachAssignments", fields: [teamId], references: [id], onDelete: Cascade)
  club   Club    @relation("clubCoachAssignments", fields: [clubId], references: [id], onDelete: Cascade)
  season Season? @relation("seasonCoachAssignments", fields: [seasonId], references: [id], onDelete: SetNull)

  @@unique([coachId, teamId, startDate])
  @@index([coachId])
  @@index([teamId])
  @@index([clubId])
  @@index([seasonId])
  @@index([isActive])
  @@index([assignmentType])
  @@map("coach_assignments")
}

model CoachCertification {
  id      String @id @default(cuid())
  coachId String

  name              String
  issuingBody       String
  certificateNumber String?
  level             String?

  sport Sport?

  dateObtained DateTime
  expiryDate   DateTime?
  renewalDate  DateTime?

  status CertificationStatus @default(ACTIVE)

  documentUrl  String?
  isVerified   Boolean   @default(false)
  verifiedBy   String?
  verifiedAt   DateTime?

  cost        Float?
  currency    String @default("GBP")
  paidBy      String?

  notes String?
  tags  String[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  coach Coach @relation("coachCertifications", fields: [coachId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([sport])
  @@index([status])
  @@index([expiryDate])
  @@map("coach_certifications")
}

model CoachPerformanceReview {
  id      String @id @default(cuid())
  coachId String
  clubId  String

  reviewPeriod String
  reviewDate   DateTime

  overallRating         Float
  technicalKnowledge    Float?
  communicationSkills   Float?
  playerDevelopment     Float?
  tacticalAwareness     Float?
  motivationAbility     Float?
  organizationalSkills  Float?
  professionalism       Float?
  adaptability          Float?

  strengths     String[]
  improvements  String[]
  achievements  String[]
  goals         String[]

  selfAssessment    String? @db.Text
  managerFeedback   String? @db.Text
  playerFeedback    String? @db.Text
  parentFeedback    String? @db.Text

  status        String @default("DRAFT")
  acknowledgedAt DateTime?
  acknowledgedBy String?

  reviewedBy String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  coach Coach @relation("coachReviews", fields: [coachId], references: [id], onDelete: Cascade)
  club  Club  @relation("clubCoachReviews", fields: [clubId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([clubId])
  @@index([reviewDate])
  @@map("coach_performance_reviews")
}

// ============================================================================
// üéØ PLAYER DEVELOPMENT SYSTEM (NEW v7.8.0)
// ============================================================================

model PlayerDevelopmentPlan {
  id       String @id @default(cuid())
  playerId String
  coachId  String
  clubId   String

  name        String
  description String? @db.Text

  phase     DevelopmentPhase @default(DEVELOPMENT)
  startDate DateTime
  endDate   DateTime?

  shortTermGoals String[]
  longTermGoals  String[]

  technicalFocus String[]
  tacticalFocus  String[]
  physicalFocus  String[]
  mentalFocus    String[]

  progressPercentage Int       @default(0)
  lastReviewDate     DateTime?
  nextReviewDate     DateTime?

  isActive Boolean @default(true)
  status   String  @default("ACTIVE")

  notes String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player     Player           @relation("playerDevelopmentPlans", fields: [playerId], references: [id], onDelete: Cascade)
  coach      Coach            @relation("coachDevelopmentPlans", fields: [coachId], references: [id], onDelete: Cascade)
  club       Club             @relation("clubDevelopmentPlans", fields: [clubId], references: [id], onDelete: Cascade)
  milestones SkillMilestone[]

  @@index([playerId])
  @@index([coachId])
  @@index([clubId])
  @@index([isActive])
  @@map("player_development_plans")
}

model SkillAssessment {
  id       String @id @default(cuid())
  playerId String
  coachId  String

  assessmentDate DateTime
  sport          Sport

  technicalScore Float
  tacticalScore  Float
  physicalScore  Float
  mentalScore    Float
  overallScore   Float

  technicalDetails Json?
  tacticalDetails  Json?
  physicalDetails  Json?
  mentalDetails    Json?

  previousAssessmentId String?
  improvementScore     Float?

  notes           String? @db.Text
  recommendations String[]

  isOfficial Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerSkillAssessments", fields: [playerId], references: [id], onDelete: Cascade)
  coach  Coach  @relation("coachSkillAssessments", fields: [coachId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([coachId])
  @@index([assessmentDate])
  @@index([sport])
  @@map("skill_assessments")
}

model SkillMilestone {
  id                   String @id @default(cuid())
  developmentPlanId    String
  playerId             String

  title       String
  description String?
  category    SkillCategory

  targetDate   DateTime
  completedAt  DateTime?
  status       MilestoneStatus @default(NOT_STARTED)

  targetValue   Float?
  currentValue  Float?
  unit          String?

  evidenceUrls  String[]
  coachNotes    String?
  playerNotes   String?

  verifiedBy    String?
  verifiedAt    DateTime?

  order Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  developmentPlan PlayerDevelopmentPlan @relation(fields: [developmentPlanId], references: [id], onDelete: Cascade)
  player          Player                @relation("playerMilestones", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([developmentPlanId])
  @@index([playerId])
  @@index([status])
  @@index([targetDate])
  @@map("skill_milestones")
}

model MentorshipAssignment {
  id        String @id @default(cuid())
  mentorId  String
  menteeId  String
  clubId    String

  startDate DateTime
  endDate   DateTime?

  focusAreas String[]
  goals      String[]

  meetingFrequency String?
  lastMeetingDate  DateTime?
  nextMeetingDate  DateTime?

  progressNotes Json?
  rating        Float?

  isActive Boolean @default(true)

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  mentor Player @relation("mentorAssignments", fields: [mentorId], references: [id], onDelete: Cascade)
  mentee Player @relation("menteeAssignments", fields: [menteeId], references: [id], onDelete: Cascade)
  club   Club   @relation("clubMentorships", fields: [clubId], references: [id], onDelete: Cascade)

  @@unique([mentorId, menteeId, startDate])
  @@index([mentorId])
  @@index([menteeId])
  @@index([clubId])
  @@index([isActive])
  @@map("mentorship_assignments")
}

// ============================================================================
// üì± ENHANCED COMMUNICATION (NEW v7.8.0)
// ============================================================================

model TeamAnnouncement {
  id     String @id @default(cuid())
  teamId String
  clubId String

  title    String
  content  String  @db.Text
  priority String  @default("NORMAL")

  targetRoles String[]
  targetAll   Boolean  @default(true)

  publishAt   DateTime?
  expiresAt   DateTime?
  isPublished Boolean   @default(false)

  requiresAcknowledgment Boolean @default(false)
  acknowledgedBy         String[]

  attachments String[]
  imageUrl    String?

  viewCount Int @default(0)

  authorId String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team   Team @relation("teamAnnouncements", fields: [teamId], references: [id], onDelete: Cascade)
  club   Club @relation("clubTeamAnnouncements", fields: [clubId], references: [id], onDelete: Cascade)
  author User @relation("userTeamAnnouncements", fields: [authorId], references: [id])

  @@index([teamId])
  @@index([clubId])
  @@index([isPublished])
  @@index([publishAt])
  @@map("team_announcements")
}

model EventRSVP {
  id     String @id @default(cuid())
  userId String

  eventType String
  eventId   String

  status       RSVPStatus @default(PENDING)
  respondedAt  DateTime?

  plusOnes       Int      @default(0)
  dietaryNeeds   String?
  transportNeeds String?
  notes          String?

  reminderSent   Boolean   @default(false)
  reminderSentAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation("userRSVPs", fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, eventType, eventId])
  @@index([userId])
  @@index([eventType, eventId])
  @@index([status])
  @@map("event_rsvps")
}

model ParentPortalAccess {
  id       String @id @default(cuid())
  parentId String
  playerId String
  clubId   String

  canViewSchedule      Boolean @default(true)
  canViewPerformance   Boolean @default(true)
  canViewMedical       Boolean @default(false)
  canViewFinancial     Boolean @default(true)
  canViewAttendance    Boolean @default(true)
  canCommunicateCoach  Boolean @default(true)
  canRSVPEvents        Boolean @default(true)
  canViewTeammates     Boolean @default(false)
  canAccessMedia       Boolean @default(true)

  mediaConsentGiven     Boolean   @default(false)
  mediaConsentDate      DateTime?
  travelConsentGiven    Boolean   @default(false)
  travelConsentDate     DateTime?
  emergencyContactAdded Boolean   @default(false)

  isActive  Boolean   @default(true)
  grantedBy String
  grantedAt DateTime  @default(now())
  expiresAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  parent Parent @relation("parentPortalAccess", fields: [parentId], references: [id], onDelete: Cascade)
  player Player @relation("playerParentAccess", fields: [playerId], references: [id], onDelete: Cascade)
  club   Club   @relation("clubParentAccess", fields: [clubId], references: [id], onDelete: Cascade)

  @@unique([parentId, playerId])
  @@index([parentId])
  @@index([playerId])
  @@index([clubId])
  @@index([isActive])
  @@map("parent_portal_access")
}

// ============================================================================
// üí≥ ENHANCED PAYMENTS (NEW v7.8.0)
// ============================================================================

model PaymentPlan {
  id     String @id @default(cuid())
  userId String
  clubId String

  name        String
  description String?

  totalAmount    Float
  currency       String @default("GBP")
  installments   Int
  frequency      String

  startDate DateTime
  endDate   DateTime?

  paidAmount       Float             @default(0)
  remainingAmount  Float
  nextPaymentDate  DateTime?
  nextPaymentAmount Float?

  status PaymentPlanStatus @default(ACTIVE)

  lateFeeAmount    Float?
  lateFeeApplied   Boolean @default(false)
  gracePeriodDays  Int     @default(7)

  invoiceId     String?
  feeStructureId String?

  notes String?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user                User                 @relation("userPaymentPlans", fields: [userId], references: [id], onDelete: Cascade)
  club                Club                 @relation("clubPaymentPlans", fields: [clubId], references: [id], onDelete: Cascade)
  installmentPayments InstallmentPayment[]

  @@index([userId])
  @@index([clubId])
  @@index([status])
  @@index([nextPaymentDate])
  @@map("payment_plans")
}

model InstallmentPayment {
  id            String @id @default(cuid())
  paymentPlanId String

  installmentNumber Int
  amount            Float
  currency          String @default("GBP")

  dueDate   DateTime
  paidAt    DateTime?
  status    String    @default("PENDING")

  paymentMethod String?
  transactionId String?
  receiptUrl    String?

  lateFeeApplied Float?
  notes          String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  paymentPlan PaymentPlan @relation(fields: [paymentPlanId], references: [id], onDelete: Cascade)

  @@unique([paymentPlanId, installmentNumber])
  @@index([paymentPlanId])
  @@index([dueDate])
  @@index([status])
  @@map("installment_payments")
}

model FeeStructure {
  id     String @id @default(cuid())
  clubId String
  teamId String?

  name        String
  description String?

  feeType    String
  amount     Float
  currency   String  @default("GBP")
  frequency  String

  ageGroups    String[]
  playerTypes  String[]
  
  effectiveFrom DateTime
  effectiveTo   DateTime?

  earlyBirdDiscount    Float?
  earlyBirdDeadline    DateTime?
  siblingDiscount      Float?
  multiTeamDiscount    Float?

  isActive  Boolean @default(true)
  isTaxable Boolean @default(false)
  taxRate   Float?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club Club  @relation("clubFeeStructures", fields: [clubId], references: [id], onDelete: Cascade)
  team Team? @relation("teamFeeStructures", fields: [teamId], references: [id], onDelete: SetNull)

  @@index([clubId])
  @@index([teamId])
  @@index([feeType])
  @@index([isActive])
  @@map("fee_structures")
}

model Scholarship {
  id       String @id @default(cuid())
  playerId String
  clubId   String

  name        String
  description String?

  type   ScholarshipType
  amount Float
  currency String @default("GBP")
  percentage Float?

  startDate DateTime
  endDate   DateTime?
  seasonId  String?

  conditions         String[]
  gpaRequirement     Float?
  attendanceRequired Float?

  status     String   @default("ACTIVE")
  statusNote String?

  fundedBy   String?
  fundSource String?

  awardedBy   String
  awardedAt   DateTime @default(now())

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player  @relation("playerScholarships", fields: [playerId], references: [id], onDelete: Cascade)
  club   Club    @relation("clubScholarships", fields: [clubId], references: [id], onDelete: Cascade)
  season Season? @relation("seasonScholarships", fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([clubId])
  @@index([type])
  @@index([status])
  @@map("scholarships")
}

// ============================================================================
// üè• ENHANCED MEDICAL & WELLNESS (NEW v7.8.0)
// ============================================================================

model RecoveryProtocol {
  id       String @id @default(cuid())
  playerId String
  injuryId String

  name        String
  description String? @db.Text

  phase     RecoveryPhase
  startDate DateTime
  endDate   DateTime?

  exercises    Json?
  restrictions String[]
  medications  String[]
  treatments   String[]

  phaseGoals    String[]
  progressNotes Json?

  checkpoints Json?

  isActive       Boolean   @default(true)
  completedAt    DateTime?
  nextReviewDate DateTime?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerRecoveryProtocols", fields: [playerId], references: [id], onDelete: Cascade)
  injury Injury @relation("injuryRecoveryProtocols", fields: [injuryId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([injuryId])
  @@index([phase])
  @@index([isActive])
  @@map("recovery_protocols")
}

model NutritionPlan {
  id       String @id @default(cuid())
  playerId String

  name        String
  description String? @db.Text

  goals         String[]
  targetWeight  Float?
  targetBodyFat Float?

  dailyCalories   Int?
  proteinGrams    Int?
  carbsGrams      Int?
  fatGrams        Int?
  fiberGrams      Int?

  mealPlan Json?

  allergies     String[]
  restrictions  String[]
  supplements   String[]

  dailyWaterLiters Float?

  isActive  Boolean   @default(true)
  startDate DateTime
  endDate   DateTime?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerNutritionPlans", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([isActive])
  @@map("nutrition_plans")
}

model SleepLog {
  id       String @id @default(cuid())
  playerId String

  date      DateTime @db.Date
  bedTime   DateTime
  wakeTime  DateTime
  duration  Float

  qualityRating    Int?
  restfulness      Int?
  sleepLatency     Int?
  awakenings       Int?

  screenTimeBeforeBed Int?
  caffeineIntake      Boolean?
  exerciseBeforeBed   Boolean?
  stressLevel         Int?

  notes String?

  source String?

  createdAt DateTime @default(now())

  player Player @relation("playerSleepLogs", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, date])
  @@index([playerId])
  @@index([date])
  @@map("sleep_logs")
}

model WellnessCheck {
  id       String @id @default(cuid())
  playerId String

  checkDate DateTime
  category  WellnessCategory

  overallWellness Int
  energyLevel     Int?
  moodRating      Int?
  motivationLevel Int?
  stressLevel     Int?
  anxietyLevel    Int?
  confidenceLevel Int?

  muscleSoreness Int?
  fatigueLevel   Int?
  sleepQuality   Int?
  appetiteLevel  Int?

  concerns      String?
  positives     String?
  supportNeeded String?

  requiresFollowUp Boolean   @default(false)
  followedUpBy     String?
  followedUpAt     DateTime?
  followUpNotes    String?

  isConfidential Boolean @default(true)

  createdAt DateTime @default(now())

  player Player @relation("playerWellnessChecks", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([checkDate])
  @@index([category])
  @@index([requiresFollowUp])
  @@map("wellness_checks")
}

model PerformanceBenchmark {
  id String @id @default(cuid())

  sport    Sport
  ageGroup String
  gender   String
  level    String

  metric       String
  percentile10 Float
  percentile25 Float
  percentile50 Float
  percentile75 Float
  percentile90 Float
  percentile99 Float

  unit   String?
  source String?
  year   Int?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([sport, ageGroup, gender, level, metric])
  @@index([sport])
  @@index([ageGroup])
  @@index([metric])
  @@map("performance_benchmarks")
}

// ============================================================================
// üìà ANALYTICS & INSIGHTS (NEW v7.8.0)
// ============================================================================

model TeamChemistry {
  id     String @id @default(cuid())
  teamId String

  assessmentDate DateTime
  seasonId       String?

  overallChemistry Float
  communication    Float?
  trust            Float?
  cohesion         Float?
  motivation       Float?
  leadership       Float?
  conflictLevel    Float?

  playerRelationships Json?

  strengths       String[]
  improvements    String[]
  recommendations String[]

  assessedBy String
  notes      String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team   Team    @relation("teamChemistry", fields: [teamId], references: [id], onDelete: Cascade)
  season Season? @relation("seasonChemistry", fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([teamId])
  @@index([assessmentDate])
  @@index([seasonId])
  @@map("team_chemistry")
}

// ============================================================================
// üéÆ GAMIFICATION SYSTEM (NEW v7.8.0)
// ============================================================================

model Challenge {
  id     String  @id @default(cuid())
  clubId String?

  name        String
  description String  @db.Text
  type        ChallengeType

  startDate DateTime
  endDate   DateTime
  status    ChallengeStatus @default(UPCOMING)

  targetMetric String
  targetValue  Float
  unit         String?

  rewardTitle       String?
  rewardDescription String?
  rewardBadgeId     String?
  rewardPoints      Int?

  eligibleRoles   String[]
  eligibleTeamIds String[]
  minParticipants Int?
  maxParticipants Int?

  currentLeaderId  String?
  currentLeadValue Float?

  isPublic Boolean @default(true)

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club         Club?                  @relation("clubChallenges", fields: [clubId], references: [id], onDelete: SetNull)
  participants ChallengeParticipant[]

  @@index([clubId])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@map("challenges")
}

model ChallengeParticipant {
  id          String @id @default(cuid())
  challengeId String
  userId      String
  playerId    String?

  joinedAt DateTime @default(now())

  currentValue Float   @default(0)
  rank         Int?
  lastUpdated  DateTime?

  isCompleted   Boolean   @default(false)
  completedAt   DateTime?
  rewardClaimed Boolean   @default(false)

  challenge Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)
  user      User      @relation("userChallenges", fields: [userId], references: [id], onDelete: Cascade)
  player    Player?   @relation("playerChallenges", fields: [playerId], references: [id], onDelete: SetNull)

  @@unique([challengeId, userId])
  @@index([challengeId])
  @@index([userId])
  @@index([rank])
  @@map("challenge_participants")
}

model Leaderboard {
  id     String  @id @default(cuid())
  clubId String?
  teamId String?

  name        String
  description String?

  type      LeaderboardType
  scope     LeaderboardScope
  sport     Sport?

  periodType String
  startDate  DateTime?
  endDate    DateTime?
  seasonId   String?

  metric          String
  sortOrder       String @default("DESC")
  minParticipation Int?

  isActive  Boolean @default(true)
  isPublic  Boolean @default(true)

  lastUpdated DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club    Club?              @relation("clubLeaderboards", fields: [clubId], references: [id], onDelete: SetNull)
  team    Team?              @relation("teamLeaderboards", fields: [teamId], references: [id], onDelete: SetNull)
  season  Season?            @relation("seasonLeaderboards", fields: [seasonId], references: [id], onDelete: SetNull)
  entries LeaderboardEntry[]

  @@index([clubId])
  @@index([teamId])
  @@index([type])
  @@index([isActive])
  @@map("leaderboards")
}

model LeaderboardEntry {
  id            String @id @default(cuid())
  leaderboardId String
  playerId      String

  rank       Int
  value      Float
  change     Int?
  trend      String?

  gamesPlayed Int?
  lastUpdated DateTime

  leaderboard Leaderboard @relation(fields: [leaderboardId], references: [id], onDelete: Cascade)
  player      Player      @relation("playerLeaderboardEntries", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([leaderboardId, playerId])
  @@index([leaderboardId])
  @@index([playerId])
  @@index([rank])
  @@map("leaderboard_entries")
}

model Streak {
  id       String @id @default(cuid())
  playerId String

  type        String
  description String?

  currentStreak  Int      @default(0)
  longestStreak  Int      @default(0)
  lastActivityAt DateTime?

  startDate      DateTime
  endDate        DateTime?

  milestones Json?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerStreaks", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([type])
  @@index([isActive])
  @@index([currentStreak])
  @@map("streaks")
}

model SeasonAward {
  id       String @id @default(cuid())
  clubId   String
  teamId   String?
  seasonId String

  category    AwardCategory
  customName  String?
  description String?

  winnerId    String?
  winnerType  String
  winnerName  String

  votingEnabled Boolean @default(false)
  votingStartAt DateTime?
  votingEndAt   DateTime?
  totalVotes    Int     @default(0)

  nominees Json?

  awardedAt    DateTime?
  awardedBy    String?
  presentedAt  String?
  photoUrl     String?
  certificateUrl String?

  isAnnounced Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club   Club    @relation("clubSeasonAwards", fields: [clubId], references: [id], onDelete: Cascade)
  team   Team?   @relation("teamSeasonAwards", fields: [teamId], references: [id], onDelete: SetNull)
  season Season  @relation("seasonAwards", fields: [seasonId], references: [id], onDelete: Cascade)

  @@unique([clubId, seasonId, category, teamId])
  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([category])
  @@map("season_awards")
}

// ============================================================================
// üè¢ ORGANISATION MODELS
// ============================================================================

model Organisation {
  id   String @id @default(cuid())
  slug String @unique @db.VarChar(63)

  name        String
  description String? @db.Text
  logo        String?
  banner      String?
  website     String?

  email    String
  phone    String?
  country  String
  timezone String @default("Europe/London")

  tier          OrganisationTier @default(STARTER)
  monthlyBudget Float?
  currency      String           @default("GBP")

  registrationNumber      String?   @unique
  taxId                   String?   @unique
  complianceStatus        String    @default("PENDING")
  gdprCompliant           Boolean   @default(false)
  dataProcessingAgreement DateTime?

  totalUsers    Int @default(0)
  totalTeams    Int @default(0)
  totalMatches  Int @default(0)
  storageUsedMb Int @default(0)

  enabledFeatures String[] @default([])
  customFeatures  Json?

  maxUsers            Int @default(100)
  maxTeams            Int @default(10)
  maxStorageMb        Int @default(5120)
  maxApiCallsPerMonth Int @default(10000)
  maxConcurrentUsers  Int @default(50)

  subscriptionId  String?   @unique
  billingEmail    String?
  billingCycle    String    @default("MONTHLY")
  nextBillingDate DateTime?

  lastActivityAt DateTime?
  isActive       Boolean   @default(true)
  isArchived     Boolean   @default(false)
  archivedAt     DateTime?

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  owner                User                     @relation("organisationOwner", fields: [ownerId], references: [id])
  ownerId              String
  members              OrganisationMember[]
  invitations          OrganisationInvitation[]
  clubs                Club[]
  apiKeys              ApiKey[]
  webhooks             Webhook[]
  auditLogs            AuditLog[]
  backups              DatabaseBackup[]
  subscriptions        Subscription[]
  dataExportRequests   DataExportRequest[]
  dataDeletionRequests DataDeletionRequest[]
  apiUsageMetrics      ApiUsageMetrics[]
  quotaUsage           QuotaUsage[]
  seasons              Season[]
  facilities           Facility[]
  venues               Venue[]                  @relation("organisationVenues")
  sponsors             Sponsor[]
  mediaAssets          MediaAsset[]
  mediaContent         MediaContent[]
  competitions         Competition[]
  budgets              Budget[]
  exportRequests       ExportRequest[]          @relation("orgExports")
  exportTemplates      ExportTemplate[]         @relation("orgExportTemplates")
  reportSchedules      ReportSchedule[]         @relation("orgReportSchedules")

  @@index([slug])
  @@index([ownerId])
  @@index([tier])
  @@index([isActive])
  @@index([createdAt])
  @@index([country])
  @@index([deletedAt])
  @@map("organisations")
}

model OrganisationMember {
  id             String  @id @default(cuid())
  organisationId String
  userId         String
  roleId         String?

  role OrganisationRole @default(MEMBER)
  customPermissions String[]

  joinedAt  DateTime  @default(now())
  invitedBy String?
  invitedAt DateTime?

  lastAccessAt DateTime?
  lastAccessIp String?

  removedAt DateTime?
  removedBy String?

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  user         User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  customRole   Role?        @relation("roleMembers", fields: [roleId], references: [id], onDelete: SetNull)

  @@unique([organisationId, userId])
  @@index([organisationId])
  @@index([userId])
  @@index([roleId])
  @@index([role])
  @@index([joinedAt])
  @@map("organisation_members")
}

model OrganisationInvitation {
  id             String           @id @default(cuid())
  organisationId String
  email          String
  role           OrganisationRole @default(MEMBER)

  invitedBy String
  invitedAt DateTime @default(now())
  expiresAt DateTime

  acceptedAt DateTime?
  acceptedBy String?

  status InvitationStatus @default(PENDING)
  token String @unique @default(cuid())

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@unique([organisationId, email])
  @@index([organisationId])
  @@index([status])
  @@index([token])
  @@index([expiresAt])
  @@map("organisation_invitations")
}

model Season {
  id             String @id @default(cuid())
  organisationId String

  name      String
  startDate DateTime
  endDate   DateTime

  isActive  Boolean @default(false)
  isCurrent Boolean @default(false)
  description String?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation     Organisation       @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  competitions     Competition[]
  transfers        Transfer[]
  budgets          Budget[]
  coachAssignments CoachAssignment[]  @relation("seasonCoachAssignments")
  scholarships     Scholarship[]      @relation("seasonScholarships")
  teamChemistry    TeamChemistry[]    @relation("seasonChemistry")
  leaderboards     Leaderboard[]      @relation("seasonLeaderboards")
  seasonAwards     SeasonAward[]      @relation("seasonAwards")

  @@unique([organisationId, name])
  @@index([organisationId])
  @@index([isActive])
  @@index([isCurrent])
  @@index([deletedAt])
  @@map("seasons")
}

// ============================================================================
// üë§ USER & AUTHENTICATION MODELS
// ============================================================================

model User {
  id            String    @id @default(cuid())
  email         String    @unique @db.Citext
  emailVerified DateTime?
  phone         String?   @unique
  phoneVerified DateTime?

  firstName   String
  lastName    String
  middleName  String?
  displayName String?
  avatar      String?
  banner      String?
  bio         String?   @db.Text
  dateOfBirth DateTime?
  nationality String?
  language    String    @default("en-GB")
  timezone    String    @default("Europe/London")

  userType     UserType    @default(INDIVIDUAL)
  accountTier  AccountTier @default(FREE)
  roles        UserRole[]  @default([PLAYER])
  status       UserStatus  @default(PENDING_EMAIL_VERIFICATION)
  isSuperAdmin Boolean     @default(false)

  primaryOrganisationId String?
  clubId                String?
  teamId                String?

  password            String?
  passwordChangedAt   DateTime?
  passwordResetToken  String?   @unique
  passwordResetExpiry DateTime?

  failedLoginAttempts Int       @default(0)
  lastFailedLoginAt   DateTime?
  lastLoginAt         DateTime?
  lastLoginIp         String?
  loginAttempts       Int       @default(0)
  lockoutUntil        DateTime?

  twoFactorEnabled     Boolean  @default(false)
  twoFactorSecret      String?  @unique
  twoFactorBackupCodes String[]

  fcmTokens String[] @default([])

  emailNotificationsEnabled Boolean @default(true)
  pushNotificationsEnabled  Boolean @default(true)
  smsNotificationsEnabled   Boolean @default(false)
  marketingEmailsEnabled    Boolean @default(false)
  privacyLevel              String  @default("FRIENDS_ONLY")
  showOnlineStatus          Boolean @default(true)
  profileVisibility         String  @default("PUBLIC")

  gdprConsent             Boolean   @default(false)
  gdprConsentDate         DateTime?
  dataProcessingConsent   Boolean   @default(false)
  marketingConsent        Boolean   @default(false)
  cookieConsent           Boolean   @default(false)
  termsAcceptedAt         DateTime?
  privacyPolicyAcceptedAt DateTime?

  followersCount Int @default(0)
  followingCount Int @default(0)

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisationMemberships   OrganisationMember[]
  organisationsOwned        Organisation[]          @relation("organisationOwner")
  accounts                  Account[]
  sessions                  Session[]
  refreshTokens             RefreshToken[]
  twoFactorAuth             TwoFactorAuth?
  apiKeys                   ApiKey[]
  player                    Player?
  coach                     Coach?
  referee                   Referee?
  scout                     Scout?
  analyst                   Analyst?
  clubManager               ClubManager?
  clubOwner                 ClubOwner?
  parent                    Parent?
  treasurer                 Treasurer?
  clubMemberships           ClubMember[]
  managedClubs              Club[]                  @relation("clubManager")
  ownedClubs                Club[]                  @relation("clubOwner")
  notifications             Notification[]
  notificationPrefs         NotificationPreference?
  messages                  Message[]
  chatMembers               ChatMember[]
  chatsCreated              Chat[]                  @relation("chatCreator")
  socialActions             SocialAction[]
  followers                 Follow[]                @relation("follower")
  following                 Follow[]                @relation("following")
  blocks                    UserBlock[]             @relation("blocker")
  blockedBy                 UserBlock[]             @relation("blocked")
  achievements              Achievement[]           @relation("achievementUser")
  badges                    Badge[]                 @relation("badgeUser")
  subscriptions             Subscription[]
  payments                  Payment[]
  invoices                  Invoice[]
  auditLogsCreated          AuditLog[]              @relation("auditLogUser")
  announcementsCreated      Announcement[]          @relation("announcementCreator")
  performanceGoals          PerformanceGoal[]       @relation("goalUser")
  goalsCreated              PerformanceGoal[]       @relation("goalCreator")
  jobApplications           JobApplication[]        @relation("applicant")
  reviewedApplications      JobApplication[]        @relation("applicationReviewer")
  jobPostingsCreated        JobPosting[]            @relation("jobCreator")
  mediaUploaded             MediaContent[]          @relation("mediaUploader")
  matchesCreated            Match[]                 @relation("matchCreator")
  competitionsCreated       Competition[]           @relation("competitionCreator")
  fitnessAssessmentsCreated FitnessAssessment[]     @relation("fitnessAssessor")
  drillsCreated             TrainingDrill[]         @relation("drillsCreated")
  budgetsCreated            Budget[]                @relation("budgetsCreated")
  expensesCreated           Expense[]               @relation("expensesCreated")
  expensesApproved          Expense[]               @relation("expensesApproved")
  exportRequests            ExportRequest[]         @relation("userExports")
  exportTemplates           ExportTemplate[]        @relation("userExportTemplates")
  reportSchedules           ReportSchedule[]        @relation("userReportSchedules")
  paymentPlans              PaymentPlan[]           @relation("userPaymentPlans")
  eventRSVPs                EventRSVP[]             @relation("userRSVPs")
  challengeParticipations   ChallengeParticipant[]  @relation("userChallenges")
  teamAnnouncementsCreated  TeamAnnouncement[]      @relation("userTeamAnnouncements")

  @@index([email])
  @@index([phone])
  @@index([status])
  @@index([clubId])
  @@index([teamId])
  @@index([failedLoginAttempts])
  @@index([primaryOrganisationId])
  @@index([createdAt])
  @@index([lastName, firstName])
  @@index([isSuperAdmin])
  @@index([passwordResetToken])
  @@index([twoFactorEnabled])
  @@index([deletedAt])
  @@map("users")
}

model TwoFactorAuth {
  id     String @id @default(cuid())
  userId String @unique

  secret      String
  enabled     Boolean  @default(false)
  backupCodes String[]

  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  lastUsedAt DateTime?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([enabled])
  @@map("two_factor_auth")
}

model Account {
  id                String @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String

  refresh_token String? @db.Text
  access_token  String? @db.Text
  expires_at    Int?
  token_type    String?
  scope         String?
  id_token      String? @db.Text
  session_state String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime

  ipAddress String?
  userAgent String?
  device    String?
  location  String?

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([sessionToken])
  @@index([expires])
  @@map("sessions")
}

model RefreshToken {
  id        String    @id @default(cuid())
  userId    String
  token     String    @unique
  expiresAt DateTime
  revokedAt DateTime?
  usedAt    DateTime?

  ipAddress String?
  userAgent String?

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([expiresAt])
  @@index([token])
  @@map("refresh_tokens")
}

model VerificationToken {
  id         String           @id @default(cuid())
  identifier String
  token      String           @unique
  type       VerificationType @default(EMAIL)
  expires    DateTime

  createdAt DateTime @default(now())

  @@unique([identifier, token])
  @@index([type])
  @@index([expires])
  @@index([identifier])
  @@map("verification_tokens")
}

model ApiKey {
  id             String  @id @default(cuid())
  userId         String
  organisationId String?

  name        String
  key         String    @unique @db.Char(32)
  secret      String?   @unique
  lastUsed    DateTime?
  expiresAt   DateTime?
  permissions String[]  @default([])

  rateLimit      Int @default(1000)
  rateLimitReset Int @default(3600)

  createdAt DateTime  @default(now())
  revokedAt DateTime?

  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  organisation Organisation? @relation(fields: [organisationId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([key])
  @@index([organisationId])
  @@index([expiresAt])
  @@map("api_keys")
}

model Role {
  id             String @id @default(cuid())
  organisationId String

  name        String
  slug        String
  description String? @db.Text

  isBuiltIn Boolean @default(false)
  isCustom  Boolean @default(true)
  level     Int     @default(0)

  permissions          String[]
  customPermissionJson Json?

  memberCount Int @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisationMembers OrganisationMember[] @relation("roleMembers")

  @@unique([organisationId, slug])
  @@index([organisationId])
  @@index([level])
  @@map("roles")
}

model Permission {
  id String @id @default(cuid())

  type        PermissionType @unique
  description String?
  category    String

  @@index([category])
  @@map("permissions")
}

model ResourcePermission {
  id String @id @default(cuid())

  resourceType String
  resourceId   String

  userId     String
  permission String

  grantedAt DateTime  @default(now())
  grantedBy String
  expiresAt DateTime?

  @@unique([resourceType, resourceId, userId, permission])
  @@index([userId])
  @@index([resourceType, resourceId])
  @@index([expiresAt])
  @@map("resource_permissions")
}

// ============================================================================
// üìã AUDIT & DATA GOVERNANCE
// ============================================================================

model AuditLog {
  id             String  @id @default(cuid())
  organisationId String?
  userId         String?

  action AuditActionType

  resourceType String
  resourceId   String

  beforeState Json?
  afterState  Json?
  changes     String[]

  ipAddress String?
  userAgent String?
  sessionId String?
  requestId String?

  severity        String  @default("INFO")
  isCompliance    Boolean @default(false)
  requiresReview  Boolean @default(false)
  isLegalHold     Boolean @default(false)
  legalHoldReason String?

  durationMs Int?

  createdAt DateTime @default(now())

  organisation Organisation? @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  user         User?         @relation("auditLogUser", fields: [userId], references: [id], onDelete: SetNull)

  @@index([organisationId])
  @@index([userId])
  @@index([action])
  @@index([resourceType, resourceId])
  @@index([createdAt])
  @@index([severity])
  @@index([isCompliance])
  @@map("audit_logs")
}

model EntityVersion {
  id String @id @default(cuid())

  entityType String
  entityId   String
  version    Int

  data Json

  changedBy    String
  changeReason String?
  changeType   String

  checksum String?

  retentionPolicy     DataRetentionPolicy @default(STANDARD)
  deletionScheduledAt DateTime?
  deletedAt           DateTime?

  createdAt DateTime @default(now())

  @@unique([entityType, entityId, version])
  @@index([entityType, entityId])
  @@index([deletionScheduledAt])
  @@index([retentionPolicy])
  @@map("entity_versions")
}

model ConsentLog {
  id     String @id @default(cuid())
  userId String

  type String

  granted   Boolean
  grantedAt DateTime

  evidence  Json?
  ipAddress String?
  userAgent String?

  withdrawnAt DateTime?

  @@index([userId])
  @@index([type])
  @@index([grantedAt])
  @@map("consent_logs")
}

model DataExportRequest {
  id             String @id @default(cuid())
  userId         String
  organisationId String

  status String @default("PENDING")

  requestedAt DateTime  @default(now())
  processedAt DateTime?
  expiresAt   DateTime

  fileUrl  String?
  fileSize Int?
  format   String  @default("JSON")

  progress Int @default(0)
  error    String?

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([expiresAt])
  @@map("data_export_requests")
}

model DataDeletionRequest {
  id             String @id @default(cuid())
  userId         String
  organisationId String

  reason      String?
  requestedAt DateTime @default(now())

  status      String    @default("PENDING")
  approvedAt  DateTime?
  completedAt DateTime?

  verificationToken  String?   @unique
  verificationSentAt DateTime?

  dataCategories String[]
  retainedData   String[]

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([requestedAt])
  @@map("data_deletion_requests")
}

// ============================================================================
// üèÉ PLAYER MODEL (ENHANCED v7.8.0)
// ============================================================================

model Player {
  id     String @id @default(cuid())
  userId String @unique

  height            Float?
  weight            Float?
  dateOfBirth       DateTime?
  nationality       String?
  secondNationality String?

  jerseyNumber      Int?
  preferredFoot     PreferredFoot?
  primaryPosition   Position?
  secondaryPosition Position?
  tertiaryPosition  Position?

  marketValue      Float?
  valueLastUpdated DateTime?
  currency         String    @default("GBP")

  isActive            Boolean @default(true)
  isVerified          Boolean @default(false)
  hasCompletedProfile Boolean @default(false)
  isAcademy           Boolean @default(false)
  isYouth             Boolean @default(false)
  youthCategory       String?

  overallRating    Float?    @default(0)
  formRating       Float?    @default(0)
  developmentPhase String?
  fitnessLevel     Float?
  injuryStatus     String?
  lastFitnessTest  DateTime?

  availabilityStatus String @default("AVAILABLE")

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user                    User                      @relation(fields: [userId], references: [id], onDelete: Cascade)
  statistics              PlayerStatistic[]
  aggregateStats          PlayerAggregateStats?
  analytics               PlayerAnalytic?           @relation("playerAnalytics")
  insights                PlayerInsight?            @relation("playerInsights")
  contracts               Contract[]
  injuries                Injury[]
  medicalRecords          MedicalRecord[]
  fitnessAssessments      FitnessAssessment[]       @relation("playerFitnessAssessments")
  matchAttendance         MatchAttendance[]
  familyLinks             PlayerFamily[]
  scoutingReports         ScoutingReport[]
  scoutWatchlists         ScoutWatchlist[]
  highlights              PlayerHighlight[]
  badges                  Badge[]                   @relation("badgePlayer")
  achievements            Achievement[]             @relation("achievementPlayer")
  transfers               Transfer[]
  availabilityWindow      PlayerAvailability[]
  performanceGoals        PerformanceGoal[]         @relation("goalPlayer")
  trainingAttendance      TrainingAttendance[]
  teamPlayers             TeamPlayer[]
  joinRequests            TeamJoinRequest[]         @relation("playerJoinRequests")
  matchPerformances       PlayerMatchPerformance[]  @relation("playerPerformances")
  matchSquads             MatchSquad[]              @relation("playerSquad")
  matchEvents             MatchEvent[]              @relation("eventPlayer")
  matchEventsAssisted     MatchEvent[]              @relation("assistPlayer")
  matchEventsRelated      MatchEvent[]              @relation("relatedPlayer")
  developmentPlans        PlayerDevelopmentPlan[]   @relation("playerDevelopmentPlans")
  skillAssessments        SkillAssessment[]         @relation("playerSkillAssessments")
  milestones              SkillMilestone[]          @relation("playerMilestones")
  mentorshipsAsMentor     MentorshipAssignment[]    @relation("mentorAssignments")
  mentorshipsAsMentee     MentorshipAssignment[]    @relation("menteeAssignments")
  parentAccess            ParentPortalAccess[]      @relation("playerParentAccess")
  scholarships            Scholarship[]             @relation("playerScholarships")
  recoveryProtocols       RecoveryProtocol[]        @relation("playerRecoveryProtocols")
  nutritionPlans          NutritionPlan[]           @relation("playerNutritionPlans")
  sleepLogs               SleepLog[]                @relation("playerSleepLogs")
  wellnessChecks          WellnessCheck[]           @relation("playerWellnessChecks")
  challengeParticipations ChallengeParticipant[]    @relation("playerChallenges")
  leaderboardEntries      LeaderboardEntry[]        @relation("playerLeaderboardEntries")
  streaks                 Streak[]                  @relation("playerStreaks")

  @@index([userId])
  @@index([isActive])
  @@index([isVerified])
  @@index([primaryPosition])
  @@index([marketValue])
  @@index([createdAt])
  @@index([availabilityStatus])
  @@index([deletedAt])
  @@map("players")
}

model PlayerStatistic {
  id       String  @id @default(cuid())
  playerId String
  season   Int
  teamId   String?
  leagueId String?

  matches       Int @default(0)
  starts        Int @default(0)
  minutesPlayed Int @default(0)
  goals         Int @default(0)
  assists       Int @default(0)
  ownGoals      Int @default(0)

  yellowCards   Int @default(0)
  secondYellows Int @default(0)
  redCards      Int @default(0)
  foulsCommited Int @default(0)
  foulsSuffered Int @default(0)

  passes          Int    @default(0)
  passAccuracy    Float?
  keyPasses       Int    @default(0)
  tackles         Int    @default(0)
  tackleSuccess   Float?
  interceptions   Int    @default(0)
  clearances      Int    @default(0)
  blocks          Int    @default(0)
  aerialDuelsWon  Int    @default(0)
  aerialDuelsLost Int    @default(0)

  shots         Int    @default(0)
  shotsOnTarget Int    @default(0)
  shotAccuracy  Float?

  cleanSheets   Int    @default(0)
  saves         Int    @default(0)
  savePercent   Float?
  goalsConceded Int    @default(0)
  penaltySaves  Int    @default(0)

  dribbles        Int    @default(0)
  dribbleSuccess  Float?
  crossesAttempt  Int    @default(0)
  crossesComplete Int    @default(0)

  sportSpecificStats Json?

  averageRating Float?
  highestRating Float?
  lowestRating  Float?

  lastUpdated DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, season, teamId, leagueId])
  @@index([playerId])
  @@index([season])
  @@index([teamId])
  @@index([leagueId])
  @@map("player_statistics")
}

model PlayerAggregateStats {
  id       String @id @default(cuid())
  playerId String @unique

  totalMatches     Int @default(0)
  totalStarts      Int @default(0)
  totalGoals       Int @default(0)
  totalAssists     Int @default(0)
  totalMinutes     Int @default(0)
  totalYellowCards Int @default(0)
  totalRedCards    Int @default(0)
  totalCleanSheets Int @default(0)

  avgGoalsPerMatch   Float @default(0)
  avgAssistsPerMatch Float @default(0)
  avgMinutesPerMatch Float @default(0)
  avgRating          Float @default(0)

  seasonGoals   Int @default(0)
  seasonAssists Int @default(0)
  seasonMatches Int @default(0)

  formGoals   Int    @default(0)
  formAssists Int    @default(0)
  formRating  Float?

  positionRank Int?
  leagueRank   Int?
  clubRank     Int?

  milestone100Matches DateTime?
  milestone50Goals    DateTime?
  milestone100Goals   DateTime?

  lastUpdatedAt DateTime @default(now())
  refreshedAt   DateTime @default(now())

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([lastUpdatedAt])
  @@map("player_aggregate_stats")
}

model PlayerAnalytic {
  id       String @id @default(cuid())
  playerId String @unique

  overallRating        Float @default(0)
  formRating           Float @default(0)
  consistencyIndex     Float @default(0)
  injuryRisk           Float @default(0)
  developmentPotential Float @default(0)
  fatigueLevelEstimate Float @default(0)
  workRateIndex        Float @default(0)

  positionRank Int?
  leagueRank   Int?
  globalRank   Int?
  ageGroupRank Int?

  weeklyTrend  Float?
  monthlyTrend Float?
  seasonTrend  Float?

  lastMatchRating  Float?
  last5MatchesAvg  Float?
  last10MatchesAvg Float?
  seasonAverage    Float?

  predictions          Json?
  predictionConfidence Float?

  expectedGoals       Float?
  expectedAssists     Float?
  passCompletionTrend Float?
  pressureIndex       Float?
  tacticalAwareness   Float?

  strengths        String[]
  weaknesses       String[]
  developmentAreas String[]
  recommendations  String?   @db.Text
  lastAnalysisDate DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerAnalytics", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([overallRating])
  @@index([injuryRisk])
  @@index([formRating])
  @@map("player_analytics")
}

model PlayerInsight {
  id       String @id @default(cuid())
  playerId String @unique

  strengths         String[]
  weaknesses        String[]
  developmentAreas  String[]
  playingStyle      String?
  strongFoot        String?
  comparablePlayers String[]

  pace                 Int?
  shooting             Int?
  passing              Int?
  dribbling            Int?
  defending            Int?
  physical             Int?
  aggressiveness       Int?
  defensiveAbility     Int?
  leadership           Int?
  teamwork             Int?
  situationalAwareness Int?
  composure            Int?
  creativity           Int?
  workRate             Int?

  determination Int?
  concentration Int?
  decisions     Int?
  anticipation  Int?
  vision        Int?

  recommendations String?   @db.Text
  careerAdvice    String?   @db.Text
  lastReviewDate  DateTime?
  reviewedBy      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation("playerInsights", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@map("player_insights")
}

model PlayerFamily {
  id           String  @id @default(cuid())
  playerId     String
  parentId     String?
  guardianId   String?
  relationship String

  isEmergencyContact Boolean @default(false)
  phone              String?
  email              String?

  canViewMedical Boolean @default(false)
  canSignForms   Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player  @relation(fields: [playerId], references: [id], onDelete: Cascade)
  parent Parent? @relation("parentChildren", fields: [parentId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([parentId])
  @@map("player_family")
}

model PlayerHighlight {
  id       String  @id @default(cuid())
  playerId String
  matchId  String?

  title         String
  description   String? @db.Text
  videoUrl      String?
  thumbnailUrl  String?
  duration      Int?
  highlightType String

  processingStatus TranscodingStatus @default(PENDING)

  viewCount Int @default(0)
  likeCount Int @default(0)

  isPublic   Boolean @default(true)
  isFeatured Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([matchId])
  @@index([isFeatured])
  @@map("player_highlights")
}

model PlayerAvailability {
  id       String @id @default(cuid())
  playerId String

  startDate DateTime
  endDate   DateTime

  reason String
  status MatchAttendanceStatus

  notes String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([startDate, endDate])
  @@map("player_availability")
}

model Injury {
  id       String @id @default(cuid())
  playerId String

  type     String
  severity InjurySeverity @default(MINOR)
  location String

  dateFrom        DateTime
  dateTo          DateTime?
  estimatedReturn DateTime?
  actualReturn    DateTime?

  description String?      @db.Text
  treatment   String?
  therapist   String?
  status      InjuryStatus @default(ACTIVE)

  diagnosedBy String?
  facility    String?
  scans       String[]
  notes       String? @db.Text

  recoveryProgress Int?
  lastAssessment   DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player             Player              @relation(fields: [playerId], references: [id], onDelete: Cascade)
  fitnessAssessments FitnessAssessment[] @relation("injuryAssessments")
  recoveryProtocols  RecoveryProtocol[]  @relation("injuryRecoveryProtocols")

  @@index([playerId])
  @@index([dateFrom])
  @@index([status])
  @@index([severity])
  @@map("injuries")
}

model MedicalRecord {
  id       String @id @default(cuid())
  playerId String

  recordType String
  date       DateTime

  results     Json?
  notes       String?  @db.Text
  provider    String?
  facility    String?
  attachments String[]

  isClearanceRecord Boolean @default(false)
  clearanceStatus   String?
  clearanceExpiry   DateTime?

  isConfidential   Boolean @default(true)
  accessRestricted Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([recordType])
  @@index([date])
  @@map("medical_records")
}

model FitnessAssessment {
  id         String @id @default(cuid())
  playerId   String
  assessorId String

  type FitnessAssessmentType
  date DateTime

  weight    Float?
  bodyFat   Float?
  restingHR Int?
  maxHR     Int?
  vo2Max    Float?

  sprintTime    Float?
  agilityTime   Float?
  verticalJump  Float?
  beepTestLevel Float?

  flexibilityScore Float?
  mobilityNotes    String? @db.Text

  strengthTests Json?

  overallScore Float?
  status       FitnessStatus @default(PENDING_REVIEW)

  isRTPAssessment Boolean   @default(false)
  injuryId        String?
  rtpStage        Int?
  rtpCleared      Boolean   @default(false)
  rtpClearedDate  DateTime?

  notes               String?  @db.Text
  recommendations     String[] @default([])
  attachments         String[]
  nextAssessmentDue   DateTime?

  sportSpecificMetrics Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player   Player  @relation("playerFitnessAssessments", fields: [playerId], references: [id], onDelete: Cascade)
  assessor User    @relation("fitnessAssessor", fields: [assessorId], references: [id])
  injury   Injury? @relation("injuryAssessments", fields: [injuryId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([assessorId])
  @@index([injuryId])
  @@index([date])
  @@index([type])
  @@index([status])
  @@index([isRTPAssessment])
  @@map("fitness_assessments")
}

model Contract {
  id       String  @id @default(cuid())
  playerId String
  clubId   String?

  position Position

  salary           Float?
  currency         String @default("GBP")
  bonusStructure   Json?
  performanceBonus Float?
  signOnBonus      Float?
  loyaltyBonus     Float?
  appearanceFee    Float?
  goalBonus        Float?

  startDate DateTime
  endDate   DateTime?

  contractType     String  @default("PROFESSIONAL")
  status           String  @default("ACTIVE")
  contractDocument String?

  extensionOption Boolean   @default(false)
  extensionDate   DateTime?
  extensionYears  Int?
  buyoutClause    Float?
  releaseClause   Float?
  matchingRights  Boolean   @default(false)

  imageRightsPercent Float?

  agentName       String?
  agentEmail      String?
  agentPhone      String?
  agentCommission Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([clubId])
  @@index([status])
  @@index([endDate])
  @@map("contracts")
}

model Transfer {
  id String @id @default(cuid())

  playerId   String
  fromClubId String?
  toClubId   String?
  seasonId   String?

  type   TransferType
  status TransferStatus @default(PENDING)

  fee           Float?
  feeType       String   @default("FIXED")
  currency      String   @default("GBP")
  addOns        Json?
  sellOnPercent Float?
  installments  Json?
  agentFee      Float?

  loanFee          Float?
  wageContribution Float?
  buyOption        Float?
  buyObligation    Float?
  recallClause     Boolean @default(false)

  announcedAt   DateTime?
  completedAt   DateTime?
  effectiveDate DateTime
  loanEndDate   DateTime?

  medicalPassed  Boolean   @default(false)
  medicalDate    DateTime?
  contractSigned Boolean   @default(false)
  contractDate   DateTime?

  notes String? @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  player Player  @relation(fields: [playerId], references: [id], onDelete: Cascade)
  season Season? @relation(fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([fromClubId])
  @@index([toClubId])
  @@index([status])
  @@index([effectiveDate])
  @@map("transfers")
}

// ============================================================================
// üèÜ COACH MODELS (ENHANCED v7.8.0)
// ============================================================================

model Coach {
  id     String @id @default(cuid())
  userId String @unique

  coachType       String   @default("HEAD_COACH")
  specialization  String[]
  certifications  String[]
  yearsExperience Int?
  qualifications  String[] @db.Text
  bio             String?  @db.Text

  hourlyRate   Float?
  dailyRate    Float?
  currency     String  @default("GBP")
  bankDetails  Json?
  taxId        String?
  contractType String?

  isVerified            Boolean   @default(false)
  verificationDate      DateTime?
  licenseNumber         String?   @unique
  licenseExpiry         DateTime?
  backgroundCheckExpiry DateTime?
  dbsCheckNumber        String?
  dbsCheckExpiry        DateTime?
  safeguardingExpiry    DateTime?
  firstAidExpiry        DateTime?

  overallRating       Float? @default(0)
  totalPlayersCoached Int    @default(0)
  successRate         Float?
  matchesManaged      Int    @default(0)
  winRate             Float?

  isAvailable       Boolean @default(true)
  availabilityNotes String?

  isOpenToOpportunities  Boolean  @default(false)
  preferredRoles         String[]
  preferredLocations     String[]
  expectedSalary         Float?
  expectedSalaryCurrency String   @default("GBP")
  noticePeriod           String?

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user                  User                    @relation(fields: [userId], references: [id], onDelete: Cascade)
  clubMemberships       ClubMember[]            @relation("coachMemberships")
  trainingSessions      TrainingSession[]
  timesheets            CoachTimesheet[]        @relation("coach")
  payments              CoachPayment[]
  achievements          Achievement[]           @relation("achievementCoach")
  jobApplications       JobApplication[]        @relation("coachApplications")
  matchesCreatedByCoach Match[]                 @relation("matchCreatedByCoach")
  coachRates            CoachRate[]             @relation("coachRates")
  coachAssignments      CoachAssignment[]       @relation("coachAssignments")
  coachCertifications   CoachCertification[]    @relation("coachCertifications")
  coachReviews          CoachPerformanceReview[] @relation("coachReviews")
  developmentPlans      PlayerDevelopmentPlan[] @relation("coachDevelopmentPlans")
  skillAssessments      SkillAssessment[]       @relation("coachSkillAssessments")

  @@index([userId])
  @@index([isVerified])
  @@index([coachType])
  @@index([licenseExpiry])
  @@index([isOpenToOpportunities])
  @@index([deletedAt])
  @@map("coaches")
}

model CoachTimesheet {
  id      String  @id @default(cuid())
  coachId String
  clubId  String?
  teamId  String?

  period        String
  weekStartDate DateTime
  weekEndDate   DateTime

  trainingHours Float @default(0)
  matchHours    Float @default(0)
  adminHours    Float @default(0)
  travelHours   Float @default(0)
  meetingHours  Float @default(0)
  otherHours    Float @default(0)
  totalHours    Float @default(0)

  hourlyRate Float?
  dailyRate  Float?
  hourlyCost Float?
  totalCost  Float?
  currency   String @default("GBP")

  breakdown Json?

  description String?  @db.Text
  attachments String[]

  status          TimesheetStatus @default(DRAFT)
  submittedAt     DateTime?
  submittedNotes  String?
  
  reviewedBy      String?
  reviewedAt      DateTime?
  reviewNotes     String?
  
  approvedAt      DateTime?
  approvedBy      String?
  approvalNotes   String?
  
  rejectedAt      DateTime?
  rejectedBy      String?
  rejectionReason String?
  
  paidAt          DateTime?
  paymentId       String?
  paymentRef      String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  coach Coach  @relation("coach", fields: [coachId], references: [id], onDelete: Cascade)
  club  Club?  @relation("clubTimesheets", fields: [clubId], references: [id], onDelete: SetNull)
  team  Team?  @relation("teamTimesheets", fields: [teamId], references: [id], onDelete: SetNull)

  @@unique([coachId, period])
  @@index([coachId])
  @@index([clubId])
  @@index([teamId])
  @@index([status])
  @@index([weekStartDate])
  @@index([period])
  @@map("coach_timesheets")
}

model CoachPayment {
  id      String @id @default(cuid())
  coachId String

  amount        Float
  currency      String   @default("GBP")
  paymentDate   DateTime
  paymentMethod String

  invoiceNumber String? @unique
  reference     String?
  timesheetId   String?

  status      PaymentStatus @default(PENDING)
  description String?

  taxAmount Float?
  netAmount Float?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  coach Coach @relation(fields: [coachId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([status])
  @@index([paymentDate])
  @@map("coach_payments")
}

// ============================================================================
// ‚ö´ REFEREE MODEL (ENHANCED v7.6.0)
// ============================================================================

model Referee {
  id     String @id @default(cuid())
  userId String @unique

  licenseNumber     String?      @unique
  licenseLevel      RefereeLevel @default(GRASSROOTS)
  yearsOfExperience Int?

  certifiedSports Sport[] @default([])
  specializations String[]

  certificationDate     DateTime?
  certificationExpiry   DateTime?
  backgroundCheckExpiry DateTime?
  fitnessTestDate       DateTime?
  fitnessTestExpiry     DateTime?
  safeguardingExpiry    DateTime?
  firstAidExpiry        DateTime?

  matchesOfficiated   Int    @default(0)
  averageRating       Float?
  totalReviews        Int    @default(0)
  cardsIssued         Int    @default(0)
  penaltiesAwarded    Int    @default(0)
  
  sportRatings Json?

  matchFee        Float?
  travelFee       Float?
  currency        String  @default("GBP")
  bankDetails     Json?
  taxId           String?
  invoiceEmail    String?
  paymentMethod   String?

  homeCity        String?
  homeCountry     String?
  travelRadiusKm  Int?    @default(50)
  preferredVenues String[] @default([])
  hasOwnTransport Boolean  @default(true)

  availableWeekdays  Boolean @default(true)
  availableWeekends  Boolean @default(true)
  availableEvenings  Boolean @default(true)
  blackoutDates      Json?
  maxMatchesPerWeek  Int     @default(3)

  emergencyContact      String?
  emergencyContactPhone String?

  isVerified        Boolean   @default(false)
  isActive          Boolean   @default(true)
  isSuspended       Boolean   @default(false)
  suspensionReason  String?
  suspensionEndDate DateTime?

  notes String? @db.Text
  bio   String? @db.Text

  assignedMatches Int @default(0)

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user           User                  @relation(fields: [userId], references: [id], onDelete: Cascade)
  matchOfficials MatchOfficial[]
  availability   RefereeAvailability[]
  qualifications RefereeQualification[]
  payments       RefereePayment[]
  matchReports   RefereeMatchReport[]

  @@index([userId])
  @@index([isVerified])
  @@index([licenseLevel])
  @@index([isActive])
  @@index([homeCity])
  @@index([homeCountry])
  @@index([deletedAt])
  @@map("referees")
}

// ============================================================================
// üîç SCOUT MODEL (ENHANCED v7.6.0)
// ============================================================================

model Scout {
  id     String @id @default(cuid())
  userId String @unique

  specializations Position[] @default([])
  regions         String[]   @default([])
  focusAgeGroups  String[]   @default([])
  focusSports     Sport[]    @default([])

  specialization  String[]
  region          String?
  focusAgeGroup   String?
  focusPositions  Position[]

  yearsExperience Int?
  bio             String? @db.Text

  primaryClubId String?

  playersRecommended Int @default(0)
  playersSigned      Int @default(0)
  successRate        Float?
  totalReports       Int @default(0)

  averageRating Float?
  totalReviews  Int   @default(0)

  matchesAttended    Int       @default(0)
  lastMatchAttended  DateTime?
  lastReportDate     DateTime?

  isAvailableForHire Boolean @default(false)
  hourlyRate         Float?
  dailyRate          Float?
  currency           String  @default("GBP")

  isVerified    Boolean   @default(false)
  verifiedAt    DateTime?
  verifiedBy    String?
  credentials   String[]  @default([])

  isActive Boolean @default(true)

  notes String? @db.Text

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user            User                   @relation(fields: [userId], references: [id], onDelete: Cascade)
  scoutingReports ScoutingReport[]
  watchlist       ScoutWatchlist[]
  matchAttendance ScoutMatchAttendance[]

  @@index([userId])
  @@index([isVerified])
  @@index([isActive])
  @@index([primaryClubId])
  @@index([region])
  @@index([deletedAt])
  @@map("scouts")
}

// ============================================================================
// ü§ù OTHER STAFF MODELS
// ============================================================================

model Analyst {
  id     String @id @default(cuid())
  userId String @unique

  specialization  String[]
  tools           String[]
  yearsExperience Int?

  isVerified Boolean @default(false)
  isActive   Boolean @default(true)

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([isVerified])
  @@index([deletedAt])
  @@map("analysts")
}

model ClubManager {
  id     String @id @default(cuid())
  userId String @unique

  managingStyle   String?
  yearsExperience Int?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([deletedAt])
  @@map("club_managers")
}

model ClubOwner {
  id     String @id @default(cuid())
  userId String @unique

  businessType    String?
  yearsInBusiness Int?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([deletedAt])
  @@map("club_owners")
}

model Parent {
  id     String @id @default(cuid())
  userId String @unique

  childrenCount Int @default(0)

  preferredContactMethod String?
  alternatePhone         String?
  workPhone              String?

  photoVideoConsent       Boolean   @default(false)
  photoVideoConsentDate   DateTime?
  medicalConsentGiven     Boolean   @default(false)
  medicalConsentDate      DateTime?
  transportConsentGiven   Boolean   @default(false)
  transportConsentDate    DateTime?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User                 @relation(fields: [userId], references: [id], onDelete: Cascade)
  children     PlayerFamily[]       @relation("parentChildren")
  portalAccess ParentPortalAccess[] @relation("parentPortalAccess")

  @@index([userId])
  @@index([deletedAt])
  @@map("parents")
}

model Treasurer {
  id     String @id @default(cuid())
  userId String @unique

  yearsExperience Int?
  bankDetails     Json?
  qualifications  String[]

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([deletedAt])
  @@map("treasurers")
}

// ============================================================================
// üè¢ CLUB & TEAM MODELS (ENHANCED v7.8.0)
// ============================================================================

model Club {
  id             String  @id @default(cuid())
  organisationId String?
  name           String
  slug           String  @unique
  shortName      String?
  description    String? @db.Text
  logo           String?
  banner         String?
  website        String?
  email          String?
  phone          String?
  foundedYear    Int?

  city          String?
  state         String?
  country       String?
  address       String?
  postcode      String?
  venue         String?
  venueCapacity Int?
  coordinates   Json?

  sport    Sport
  teamType TeamType @default(AMATEUR)

  managerId String
  ownerId   String?

  primaryColor   String?
  secondaryColor String?

  isVerified       Boolean @default(false)
  isPublic         Boolean @default(true)
  acceptingPlayers Boolean @default(true)
  acceptingStaff   Boolean @default(true)
  status           String  @default("ACTIVE")

  followerCount Int @default(0)
  joinedMembers Int @default(0)

  twitter   String?
  facebook  String?
  instagram String?
  youtube   String?
  tiktok    String?

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation        Organisation?            @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  manager             User                     @relation("clubManager", fields: [managerId], references: [id])
  owner               User?                    @relation("clubOwner", fields: [ownerId], references: [id])
  members             ClubMember[]
  teams               Team[]
  formations          TeamFormation[]
  tactics             Tactic[]
  trainingSessions    TrainingSession[]
  homeMatches         Match[]                  @relation("homeClub")
  awayMatches         Match[]                  @relation("awayClub")
  aggregateStats      TeamAggregateStats?
  announcements       Announcement[]
  sponsors            ClubSponsor[]
  jobPostings         JobPosting[]
  mediaContent        MediaContent[]           @relation("clubMedia")
  competitions        Competition[]            @relation("clubCompetitions")
  competitionTeams    CompetitionTeam[]
  socialAccounts      SocialAccount[]          @relation("clubSocialAccounts")
  drills              TrainingDrill[]          @relation("clubDrills")
  budgets             Budget[]                 @relation("clubBudgets")
  expenses            Expense[]                @relation("clubExpenses")
  timesheets          CoachTimesheet[]         @relation("clubTimesheets")
  coachRates          CoachRate[]              @relation("clubCoachRates")
  coachAssignments    CoachAssignment[]        @relation("clubCoachAssignments")
  coachReviews        CoachPerformanceReview[] @relation("clubCoachReviews")
  developmentPlans    PlayerDevelopmentPlan[]  @relation("clubDevelopmentPlans")
  mentorships         MentorshipAssignment[]   @relation("clubMentorships")
  teamAnnouncements   TeamAnnouncement[]       @relation("clubTeamAnnouncements")
  parentAccess        ParentPortalAccess[]     @relation("clubParentAccess")
  paymentPlans        PaymentPlan[]            @relation("clubPaymentPlans")
  feeStructures       FeeStructure[]           @relation("clubFeeStructures")
  scholarships        Scholarship[]            @relation("clubScholarships")
  challenges          Challenge[]              @relation("clubChallenges")
  leaderboards        Leaderboard[]            @relation("clubLeaderboards")
  seasonAwards        SeasonAward[]            @relation("clubSeasonAwards")
  exportRequests      ExportRequest[]          @relation("clubExports")
  exportTemplates     ExportTemplate[]         @relation("clubExportTemplates")
  reportSchedules     ReportSchedule[]         @relation("clubReportSchedules")

  @@index([organisationId])
  @@index([managerId])
  @@index([ownerId])
  @@index([sport])
  @@index([isPublic])
  @@index([city])
  @@index([country])
  @@index([status])
  @@index([acceptingPlayers])
  @@index([acceptingStaff])
  @@index([deletedAt])
  @@map("clubs")
}

model SocialAccount {
  id     String @id @default(cuid())
  clubId String

  platform    SocialPlatform
  accountName String
  accountId   String?

  accessToken  String? @db.Text
  refreshToken String? @db.Text
  tokenExpiry  DateTime?

  profileUrl     String?
  followerCount  Int     @default(0)
  followingCount Int     @default(0)

  isConnected    Boolean   @default(false)
  connectedAt    DateTime?
  connectedBy    String?
  lastSyncAt     DateTime?
  lastPostAt     DateTime?

  permissions String[] @default([])

  lastError   String?
  errorCount  Int      @default(0)
  lastErrorAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club Club @relation("clubSocialAccounts", fields: [clubId], references: [id], onDelete: Cascade)

  @@unique([clubId, platform])
  @@index([clubId])
  @@index([platform])
  @@index([isConnected])
  @@map("social_accounts")
}

model ClubMember {
  id      String  @id @default(cuid())
  userId  String
  clubId  String
  coachId String?

  role ClubMemberRole @default(STAFF)

  joinedAt  DateTime  @default(now())
  leftAt    DateTime?
  isActive  Boolean   @default(true)
  isCaptain Boolean   @default(false)

  salary      Float?
  currency    String    @default("GBP")
  contractEnd DateTime?

  canManageRoster  Boolean @default(false)
  canManageMatches Boolean @default(false)
  canManageBilling Boolean @default(false)
  canManageMedia   Boolean @default(false)

  canCreateFriendlyMatches Boolean @default(false)
  canManageLineups         Boolean @default(false)

  deletedAt DateTime?

  user  User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  club  Club   @relation(fields: [clubId], references: [id], onDelete: Cascade)
  coach Coach? @relation("coachMemberships", fields: [coachId], references: [id], onDelete: SetNull)

  @@unique([userId, clubId])
  @@index([userId])
  @@index([clubId])
  @@index([coachId])
  @@index([role])
  @@index([isActive])
  @@index([deletedAt])
  @@map("club_members")
}

model Team {
  id     String @id @default(cuid())
  clubId String

  name        String
  description String? @db.Text
  logo        String?
  ageGroup    String?
  gender      String?
  status      TeamStatus @default(ACTIVE)

  minPlayers Int?
  maxPlayers Int?

  defaultFormation FormationType?

  acceptingJoinRequests Boolean @default(true)
  requiresApproval      Boolean @default(true)

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club              Club                @relation(fields: [clubId], references: [id], onDelete: Cascade)
  players           TeamPlayer[]
  matchSquads       MatchSquad[]
  formations        TeamFormation[]
  competitionTeams  CompetitionTeam[]
  joinRequests      TeamJoinRequest[]
  trainingSessions  TrainingSession[]   @relation("teamTraining")
  mediaContent      MediaContent[]      @relation("teamMedia")
  homeMatches       Match[]             @relation("homeTeam")
  awayMatches       Match[]             @relation("awayTeam")
  budgets           Budget[]            @relation("teamBudgets")
  expenses          Expense[]           @relation("teamExpenses")
  timesheets        CoachTimesheet[]    @relation("teamTimesheets")
  coachAssignments  CoachAssignment[]   @relation("teamCoachAssignments")
  teamAnnouncements TeamAnnouncement[]  @relation("teamAnnouncements")
  feeStructures     FeeStructure[]      @relation("teamFeeStructures")
  teamChemistry     TeamChemistry[]     @relation("teamChemistry")
  leaderboards      Leaderboard[]       @relation("teamLeaderboards")
  seasonAwards      SeasonAward[]       @relation("teamSeasonAwards")

  @@unique([clubId, name])
  @@index([clubId])
  @@index([ageGroup])
  @@index([status])
  @@index([acceptingJoinRequests])
  @@index([deletedAt])
  @@map("teams")
}

model TeamPlayer {
  id       String @id @default(cuid())
  teamId   String
  playerId String

  position      Position?
  jerseyNumber  Int?
  isActive      Boolean   @default(true)
  isCaptain     Boolean   @default(false)
  isViceCaptain Boolean   @default(false)

  joinedAt DateTime  @default(now())
  leftAt   DateTime?

  joinedVia     String?
  joinRequestId String?

  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)
  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([teamId, playerId])
  @@index([teamId])
  @@index([playerId])
  @@index([isActive])
  @@map("team_players")
}

model TeamFormation {
  id     String  @id @default(cuid())
  clubId String
  teamId String?

  name        String?
  formation   FormationType @default(FOUR_FOUR_TWO)
  description String?
  diagram     Json?

  positions Json?

  isDefault Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club Club  @relation(fields: [clubId], references: [id], onDelete: Cascade)
  team Team? @relation(fields: [teamId], references: [id], onDelete: SetNull)

  @@index([clubId])
  @@index([teamId])
  @@map("team_formations")
}

model TeamJoinRequest {
  id       String @id @default(cuid())
  teamId   String
  playerId String

  status                JoinRequestStatus @default(PENDING)
  message               String?           @db.Text
  preferredPosition     Position?
  preferredJerseyNumber Int?

  playerProfileSnapshot Json?

  reviewedBy      String?
  reviewedAt      DateTime?
  reviewNotes     String?   @db.Text
  rejectionReason String?

  expiresAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team   Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)
  player Player @relation("playerJoinRequests", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([teamId, playerId, status])
  @@index([teamId])
  @@index([playerId])
  @@index([status])
  @@index([createdAt])
  @@index([expiresAt])
  @@map("team_join_requests")
}

// ============================================================================
// üèÜ COMPETITION SYSTEM
// ============================================================================

model Competition {
  id             String  @id @default(cuid())
  organisationId String?
  clubId         String?
  seasonId       String?

  name        String
  shortName   String?
  slug        String        @unique
  description String?       @db.Text
  logo        String?
  banner      String?

  sport Sport
  type  CompetitionType @default(LEAGUE)

  format     LeagueFormat     @default(ROUND_ROBIN)
  visibility LeagueVisibility @default(PRIVATE)

  startDate            DateTime
  endDate              DateTime?
  registrationDeadline DateTime?

  status String @default("DRAFT")

  maxTeams        Int?
  teamsRegistered Int  @default(0)

  tiebreakers String[] @default(["GOAL_DIFFERENCE", "GOALS_FOR", "HEAD_TO_HEAD"])

  pointsForWin  Int @default(3)
  pointsForDraw Int @default(1)
  pointsForLoss Int @default(0)

  scoringRules Json?

  rules String? @db.Text

  totalMatches     Int @default(0)
  completedMatches Int @default(0)
  totalGoals       Int @default(0)

  createdBy String

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation?            @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?                    @relation("clubCompetitions", fields: [clubId], references: [id], onDelete: SetNull)
  season       Season?                  @relation(fields: [seasonId], references: [id], onDelete: SetNull)
  creator      User                     @relation("competitionCreator", fields: [createdBy], references: [id])
  teams        CompetitionTeam[]
  matches      Match[]
  standings    CompetitionStanding[]
  brackets     TournamentBracket[]
  stages       CompetitionStageConfig[]

  @@index([organisationId])
  @@index([clubId])
  @@index([seasonId])
  @@index([sport])
  @@index([type])
  @@index([status])
  @@index([startDate])
  @@index([deletedAt])
  @@map("competitions")
}

model CompetitionTeam {
  id            String @id @default(cuid())
  competitionId String
  teamId        String
  clubId        String

  joinedAt   DateTime  @default(now())
  leftAt     DateTime?
  isActive   Boolean   @default(true)
  seedNumber Int?
  groupName  String?

  competition Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)
  team        Team        @relation(fields: [teamId], references: [id], onDelete: Cascade)
  club        Club        @relation(fields: [clubId], references: [id], onDelete: Cascade)

  @@unique([competitionId, teamId])
  @@index([competitionId])
  @@index([teamId])
  @@index([clubId])
  @@index([groupName])
  @@map("competition_teams")
}

model CompetitionStanding {
  id            String  @id @default(cuid())
  competitionId String
  teamId        String?
  groupName     String?

  position       Int
  played         Int @default(0)
  wins           Int @default(0)
  draws          Int @default(0)
  losses         Int @default(0)
  goalsFor       Int @default(0)
  goalsAgainst   Int @default(0)
  goalDifference Int @default(0)
  points         Int @default(0)

  scoreBreakdown Json?

  form String?

  homeWins   Int @default(0)
  homeDraws  Int @default(0)
  homeLosses Int @default(0)
  awayWins   Int @default(0)
  awayDraws  Int @default(0)
  awayLosses Int @default(0)

  updatedAt DateTime @updatedAt

  competition Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, teamId, groupName])
  @@index([competitionId])
  @@index([position])
  @@index([groupName])
  @@map("competition_standings")
}

model CompetitionStageConfig {
  id            String @id @default(cuid())
  competitionId String

  stage CompetitionStage
  name  String?
  order Int              @default(0)

  numberOfTeams  Int?
  numberOfGroups Int?
  matchesPerTeam Int?
  isHomeAndAway  Boolean @default(false)

  startDate DateTime?
  endDate   DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  competition Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, stage])
  @@index([competitionId])
  @@index([order])
  @@map("competition_stage_configs")
}

model TournamentBracket {
  id            String @id @default(cuid())
  competitionId String

  round    Int
  position Int
  matchId  String?

  homeTeamId String?
  awayTeamId String?
  homeScore  Int?
  awayScore  Int?
  winnerId   String?

  homeSourceBracketId String?
  awaySourceBracketId String?

  scheduledAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  competition Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, round, position])
  @@index([competitionId])
  @@index([round])
  @@map("tournament_brackets")
}

// ============================================================================
// üèüÔ∏è VENUE & FACILITY MODELS
// ============================================================================

model Venue {
  id             String  @id @default(cuid())
  organisationId String?

  name      String
  shortName String?
  type      VenueType @default(STADIUM)

  address     String?
  city        String?
  state       String?
  postcode    String?
  country     String?
  coordinates Json?

  capacity    Int?
  surface     String?
  description String?  @db.Text
  facilities  String[]
  images      String[]

  contactName  String?
  contactEmail String?
  contactPhone String?
  website      String?

  operatingHours Json?

  isActive   Boolean @default(true)
  isVerified Boolean @default(false)

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation? @relation("organisationVenues", fields: [organisationId], references: [id], onDelete: SetNull)
  matches      Match[]       @relation("matchVenue")

  @@index([organisationId])
  @@index([city])
  @@index([country])
  @@index([type])
  @@index([isActive])
  @@index([deletedAt])
  @@map("venues")
}

model Facility {
  id             String @id @default(cuid())
  organisationId String

  name        String
  type        FacilityType
  description String?      @db.Text

  address     String?
  city        String?
  postcode    String?
  country     String?
  coordinates Json?

  capacity Int?

  isActive       Boolean @default(true)
  operatingHours Json?

  amenities String[]
  images    String[]

  contactName  String?
  contactPhone String?
  contactEmail String?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation      @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  bookings     FacilityBooking[]
  matches      Match[]           @relation("matchFacility")

  @@index([organisationId])
  @@index([type])
  @@index([isActive])
  @@index([deletedAt])
  @@map("facilities")
}

model FacilityBooking {
  id         String @id @default(cuid())
  facilityId String

  startTime DateTime
  endTime   DateTime

  purpose     String
  description String?
  bookedBy    String

  status BookingStatus @default(PENDING)

  isRecurring     Boolean @default(false)
  recurrenceRule  String?
  parentBookingId String?

  cost     Float?
  currency String  @default("GBP")
  paid     Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  facility Facility @relation(fields: [facilityId], references: [id], onDelete: Cascade)

  @@index([facilityId])
  @@index([startTime, endTime])
  @@index([status])
  @@index([bookedBy])
  @@map("facility_bookings")
}

// ============================================================================
// ‚öΩ MATCH MODELS
// ============================================================================

model Match {
  id String @id @default(cuid())

  competitionId String?

  homeTeamId String
  awayTeamId String

  homeClubId String
  awayClubId String

  matchType MatchType @default(LEAGUE)

  stage     CompetitionStage?
  groupName String?
  round     Int?
  matchday  Int?
  leg       Int?

  title       String?
  description String? @db.Text

  kickOffTime DateTime
  endTime     DateTime?
  status      MatchStatus @default(SCHEDULED)

  venueId    String?
  facilityId String?
  venue      String?
  pitch      String?

  weather     String?
  temperature Int?
  humidity    Int?
  windSpeed   Float?

  homeScore          Int?
  awayScore          Int?
  homeHalftimeScore  Int?
  awayHalftimeScore  Int?
  homePenalties      Int?
  awayPenalties      Int?
  homeExtraTimeScore Int?
  awayExtraTimeScore Int?

  homeScoreBreakdown Json?
  awayScoreBreakdown Json?

  homeFormation FormationType?
  awayFormation FormationType?

  attendance Int?
  capacity   Int?

  actualDuration   Int?
  injuryTimeFirst  Int?
  injuryTimeSecond Int?

  resultApprovalStatus ResultApprovalStatus @default(PENDING)
  approvedBy           String?
  approvedAt           DateTime?
  disputeReason        String?

  isHighlighted  Boolean @default(false)
  isFeatured     Boolean @default(false)
  isNeutralVenue Boolean @default(false)

  isBroadcasted Boolean @default(false)
  broadcastUrl  String?

  createdById      String
  createdByCoachId String?

  matchReport String? @db.Text
  notes       String? @db.Text

  deletedAt DateTime?
  deletedBy String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  competition        Competition?             @relation(fields: [competitionId], references: [id], onDelete: SetNull)
  homeTeam           Team                     @relation("homeTeam", fields: [homeTeamId], references: [id])
  awayTeam           Team                     @relation("awayTeam", fields: [awayTeamId], references: [id])
  homeClub           Club                     @relation("homeClub", fields: [homeClubId], references: [id])
  awayClub           Club                     @relation("awayClub", fields: [awayClubId], references: [id])
  venueRelation      Venue?                   @relation("matchVenue", fields: [venueId], references: [id])
  facilityRelation   Facility?                @relation("matchFacility", fields: [facilityId], references: [id])
  creator            User                     @relation("matchCreator", fields: [createdById], references: [id])
  createdByCoach     Coach?                   @relation("matchCreatedByCoach", fields: [createdByCoachId], references: [id])
  events             MatchEvent[]
  squads             MatchSquad[]
  playerAttendance   MatchAttendance[]
  playerPerformances PlayerMatchPerformance[]
  officials          MatchOfficial[]
  mediaContent       MediaContent[]           @relation("matchMedia")

  @@index([competitionId])
  @@index([homeTeamId])
  @@index([awayTeamId])
  @@index([homeClubId])
  @@index([awayClubId])
  @@index([venueId])
  @@index([facilityId])
  @@index([matchType])
  @@index([status])
  @@index([kickOffTime])
  @@index([resultApprovalStatus])
  @@index([createdById])
  @@index([createdByCoachId])
  @@index([deletedAt])
  @@map("matches")
}

model MatchEvent {
  id       String  @id @default(cuid())
  matchId  String
  playerId String?

  eventType       MatchEventType
  minute          Int
  secondaryMinute Int?
  period          String?

  teamSide String?

  relatedPlayerId String?
  assistPlayerId  String?

  goalType   String?
  cardReason String?
  injuryType String?

  xPosition Float?
  yPosition Float?

  details        Json?
  videoTimestamp Int?
  videoUrl       String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  match         Match   @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player        Player? @relation("eventPlayer", fields: [playerId], references: [id])
  assistPlayer  Player? @relation("assistPlayer", fields: [assistPlayerId], references: [id])
  relatedPlayer Player? @relation("relatedPlayer", fields: [relatedPlayerId], references: [id])

  @@index([matchId])
  @@index([eventType])
  @@index([playerId])
  @@index([minute])
  @@index([teamSide])
  @@map("match_events")
}

model MatchSquad {
  id       String  @id @default(cuid())
  matchId  String
  teamId   String
  playerId String?

  lineupPosition Int?
  shirtNumber    Int?
  position       Position?

  status MatchAttendanceStatus @default(NOT_SELECTED)

  isCaptain       Boolean @default(false)
  substituteOrder Int?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  match  Match   @relation(fields: [matchId], references: [id], onDelete: Cascade)
  team   Team    @relation(fields: [teamId], references: [id], onDelete: Cascade)
  player Player? @relation("playerSquad", fields: [playerId], references: [id])

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([teamId])
  @@index([playerId])
  @@index([status])
  @@map("match_squads")
}

model MatchAttendance {
  id       String @id @default(cuid())
  matchId  String
  playerId String

  status          MatchAttendanceStatus @default(AVAILABLE)
  notesFromPlayer String?
  responseDate    DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  match  Match  @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([playerId])
  @@index([status])
  @@map("match_attendance")
}

model MatchOfficial {
  id        String @id @default(cuid())
  matchId   String
  refereeId String

  role MatchOfficialRole

  performanceRating Float?
  notes             String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  match   Match   @relation(fields: [matchId], references: [id], onDelete: Cascade)
  referee Referee @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@unique([matchId, role])
  @@index([matchId])
  @@index([refereeId])
  @@map("match_officials")
}

model PlayerMatchPerformance {
  id       String @id @default(cuid())
  matchId  String
  playerId String
  teamId   String

  minutesPlayed Int     @default(0)
  startedMatch  Boolean @default(false)
  substituteOn  Int?
  substituteOff Int?

  goals        Int     @default(0)
  assists      Int     @default(0)
  yellowCards  Int     @default(0)
  redCard      Boolean @default(false)
  secondYellow Boolean @default(false)

  passes         Int    @default(0)
  passesComplete Int    @default(0)
  passAccuracy   Float?
  keyPasses      Int    @default(0)
  longBalls      Int    @default(0)
  throughBalls   Int    @default(0)
  crosses        Int    @default(0)
  crossesComplete Int   @default(0)

  tackles       Int @default(0)
  tacklesWon    Int @default(0)
  interceptions Int @default(0)
  clearances    Int @default(0)
  blocks        Int @default(0)

  shots         Int @default(0)
  shotsOnTarget Int @default(0)
  dribbles      Int @default(0)
  dribblesWon   Int @default(0)

  aerialsWon  Int @default(0)
  aerialsLost Int @default(0)
  duelsWon    Int @default(0)
  duelsLost   Int @default(0)

  fouls  Int @default(0)
  fouled Int @default(0)

  saves         Int     @default(0)
  goalsConceded Int     @default(0)
  cleanSheet    Boolean @default(false)
  penaltySaves  Int     @default(0)

  touches    Int    @default(0)
  possession Float?

  rating      Float?
  coachRating Float?

  coachNotes String? @db.Text

  sportSpecificStats Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  match  Match  @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player Player @relation("playerPerformances", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([playerId])
  @@index([teamId])
  @@index([rating])
  @@map("player_match_performances")
}

// ============================================================================
// üìä TRAINING MODELS
// ============================================================================

model TrainingSession {
  id      String  @id @default(cuid())
  clubId  String
  teamId  String?
  coachId String

  name        String
  description String? @db.Text

  startTime DateTime
  endTime   DateTime

  intensity TrainingIntensity @default(MEDIUM)
  category  TrainingCategory

  customCategory String?

  location        String?
  facilityId      String?
  maxParticipants Int?

  drills    Json?
  notes     String? @db.Text
  equipment String[]

  focusAreas String[]

  status TrainingStatus @default(SCHEDULED)

  attendanceCount Int @default(0)
  avgRating       Float?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club          Club                   @relation(fields: [clubId], references: [id], onDelete: Cascade)
  team          Team?                  @relation("teamTraining", fields: [teamId], references: [id], onDelete: SetNull)
  coach         Coach                  @relation(fields: [coachId], references: [id], onDelete: Cascade)
  attendance    TrainingAttendance[]
  media         MediaContent[]         @relation("trainingMedia")
  sessionDrills TrainingSessionDrill[]

  @@index([clubId])
  @@index([teamId])
  @@index([coachId])
  @@index([startTime])
  @@index([status])
  @@index([category])
  @@index([deletedAt])
  @@map("training_sessions")
}

model TrainingAttendance {
  id        String @id @default(cuid())
  sessionId String
  playerId  String

  status      AttendanceStatus @default(PRESENT)
  arrivalTime DateTime?
  departTime  DateTime?
  notes       String?

  injuryId String?

  performanceRating Float?
  effortRating      Float?
  coachNotes        String?

  customMetrics Json?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  session TrainingSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  player  Player          @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([sessionId, playerId])
  @@index([sessionId])
  @@index([playerId])
  @@index([status])
  @@map("training_attendance")
}

model ScoutingReport {
  id       String @id @default(cuid())
  scoutId  String
  playerId String

  rating       Float?
  observations String? @db.Text

  technicalRating Float?
  tacticalRating  Float?
  physicalRating  Float?
  mentalRating    Float?

  recommendation String?
  urgency        String?
  suggestedValue Float?
  currency       String  @default("GBP")

  matchWatched String?
  matchDate    DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  scout  Scout  @relation(fields: [scoutId], references: [id], onDelete: Cascade)
  player Player @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([scoutId])
  @@index([playerId])
  @@index([recommendation])
  @@map("scouting_reports")
}

model Tactic {
  id     String @id @default(cuid())
  clubId String

  name        String
  description String? @db.Text
  diagram     Json?
  formation   FormationType?

  defendingStyle  String?
  attackingStyle  String?
  pressingTrigger String?
  buildUpPlay     String?

  corners   Json?
  freeKicks Json?
  throwIns  Json?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club Club @relation(fields: [clubId], references: [id], onDelete: Cascade)

  @@index([clubId])
  @@index([isActive])
  @@map("tactics")
}

model TeamAggregateStats {
  id     String @id @default(cuid())
  clubId String @unique

  totalMatches      Int @default(0)
  totalWins         Int @default(0)
  totalDraws        Int @default(0)
  totalLosses       Int @default(0)
  totalGoalsFor     Int @default(0)
  totalGoalsAgainst Int @default(0)
  winRate           Float?

  homeMatches Int @default(0)
  homeWins    Int @default(0)
  homeDraws   Int @default(0)
  homeLosses  Int @default(0)

  awayMatches Int @default(0)
  awayWins    Int @default(0)
  awayDraws   Int @default(0)
  awayLosses  Int @default(0)

  currentStreak     Int     @default(0)
  streakType        String?
  longestWinStreak  Int     @default(0)
  longestLossStreak Int     @default(0)

  cleanSheets Int @default(0)

  lastUpdatedAt DateTime @default(now())

  club Club @relation(fields: [clubId], references: [id], onDelete: Cascade)

  @@index([clubId])
  @@map("team_aggregate_stats")
}

model PerformanceGoal {
  id String @id @default(cuid())

  userId   String?
  playerId String?

  type        GoalType
  title       String
  description String?  @db.Text

  targetValue  Float?
  currentValue Float?
  unit         String?

  startDate DateTime
  endDate   DateTime
  status    GoalStatus @default(NOT_STARTED)

  progress   Int   @default(0)
  milestones Json?

  reviewedAt DateTime?
  reviewedBy String?
  feedback   String?   @db.Text

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user    User?   @relation("goalUser", fields: [userId], references: [id], onDelete: Cascade)
  player  Player? @relation("goalPlayer", fields: [playerId], references: [id], onDelete: Cascade)
  creator User    @relation("goalCreator", fields: [createdBy], references: [id])

  @@index([userId])
  @@index([playerId])
  @@index([status])
  @@index([type])
  @@map("performance_goals")
}

// ============================================================================
// üìπ MEDIA MODELS
// ============================================================================

model MediaContent {
  id             String  @id @default(cuid())
  organisationId String?
  clubId         String?
  teamId         String?
  matchId        String?
  trainingId     String?

  uploadedBy String

  type     MediaType
  category MediaCategory @default(OTHER)

  title       String
  description String? @db.Text
  tags        String[]

  filename     String
  originalName String
  mimeType     String
  sizeBytes    Int
  url          String
  cdnUrl       String?

  duration     Int?
  thumbnailUrl String?

  width  Int?
  height Int?

  processingStatus   MediaProcessingStatus @default(PENDING)
  processingProvider VideoProcessingProvider?
  processingError    String?
  processedAt        DateTime?

  qualityVariants Json?

  visibility  MediaVisibility  @default(CLUB_ONLY)
  isPublic    Boolean          @default(false)
  accessRoles ClubMemberRole[]

  viewCount     Int @default(0)
  downloadCount Int @default(0)
  likeCount     Int @default(0)

  startTimestamp Int?
  endTimestamp   Int?

  parentMediaId String?

  metadata Json?

  expiresAt DateTime?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation?    @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  club         Club?            @relation("clubMedia", fields: [clubId], references: [id], onDelete: SetNull)
  team         Team?            @relation("teamMedia", fields: [teamId], references: [id], onDelete: SetNull)
  match        Match?           @relation("matchMedia", fields: [matchId], references: [id], onDelete: SetNull)
  training     TrainingSession? @relation("trainingMedia", fields: [trainingId], references: [id], onDelete: SetNull)
  uploader     User             @relation("mediaUploader", fields: [uploadedBy], references: [id])

  @@index([organisationId])
  @@index([clubId])
  @@index([teamId])
  @@index([matchId])
  @@index([trainingId])
  @@index([uploadedBy])
  @@index([type])
  @@index([category])
  @@index([visibility])
  @@index([processingStatus])
  @@index([createdAt])
  @@index([deletedAt])
  @@map("media_content")
}

model MediaAsset {
  id             String @id @default(cuid())
  organisationId String

  type     String
  filename String
  url      String
  mimeType String

  width  Int?
  height Int?

  sizeBytes Int

  duration           Int?
  thumbnailUrl       String?
  processingStatus   TranscodingStatus?
  processingProvider VideoProcessingProvider?

  alt         String?
  description String?
  tags        String[]

  usageCount Int @default(0)

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([organisationId])
  @@index([type])
  @@index([createdAt])
  @@map("media_assets")
}

// ============================================================================
// üíº JOB & APPLICATION MODELS
// ============================================================================

model JobPosting {
  id     String @id @default(cuid())
  clubId String

  title            String
  slug             String
  description      String  @db.Text
  shortDescription String?

  category        JobCategory
  role            ClubMemberRole
  employmentType  EmploymentType  @default(FULL_TIME)
  experienceLevel ExperienceLevel @default(MID)

  requirements    String[]
  qualifications  String[]
  certifications  String[]
  skills          String[]
  yearsExperience Int?

  salaryMin      Float?
  salaryMax      Float?
  currency       String   @default("GBP")
  salaryPeriod   String?
  benefits       String[]
  bonusStructure Json?

  location       String?
  city           String?
  country        String?
  isRemote       Boolean @default(false)
  isHybrid       Boolean @default(false)
  travelRequired Boolean @default(false)

  status      JobPostingStatus @default(DRAFT)
  publishedAt DateTime?
  deadline    DateTime?
  startDate   DateTime?

  isUrgent       Boolean @default(false)
  isFeatured     Boolean @default(false)
  isConfidential Boolean @default(false)

  maxApplications     Int?
  requiresCoverLetter Boolean @default(true)
  requiresResume      Boolean @default(true)
  customQuestions     Json?

  viewCount        Int @default(0)
  applicationCount Int @default(0)
  shortlistedCount Int @default(0)

  createdBy String

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club         Club             @relation(fields: [clubId], references: [id], onDelete: Cascade)
  creator      User             @relation("jobCreator", fields: [createdBy], references: [id])
  applications JobApplication[]

  @@unique([clubId, slug])
  @@index([clubId])
  @@index([category])
  @@index([role])
  @@index([status])
  @@index([publishedAt])
  @@index([deadline])
  @@index([city])
  @@index([country])
  @@index([isRemote])
  @@index([isFeatured])
  @@index([createdAt])
  @@index([deletedAt])
  @@map("job_postings")
}

model JobApplication {
  id           String  @id @default(cuid())
  jobPostingId String
  userId       String
  coachId      String?

  coverLetter   String? @db.Text
  resumeUrl     String?
  portfolioUrl  String?
  linkedInUrl   String?
  customAnswers Json?

  applicantSnapshot Json?

  status JobApplicationStatus @default(PENDING)

  reviewedBy  String?
  reviewedAt  DateTime?
  reviewNotes String?   @db.Text
  rating      Int?

  interviewDate     DateTime?
  interviewLocation String?
  interviewNotes    String?   @db.Text
  interviewRating   Int?

  offerDate          DateTime?
  offerSalary        Float?
  offerAcceptedAt    DateTime?
  offerDeclinedAt    DateTime?
  offerDeclineReason String?

  rejectionReason String?
  rejectionDate   DateTime?

  withdrawnAt    DateTime?
  withdrawReason String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  jobPosting JobPosting @relation(fields: [jobPostingId], references: [id], onDelete: Cascade)
  user       User       @relation("applicant", fields: [userId], references: [id], onDelete: Cascade)
  coach      Coach?     @relation("coachApplications", fields: [coachId], references: [id], onDelete: SetNull)
  reviewer   User?      @relation("applicationReviewer", fields: [reviewedBy], references: [id], onDelete: SetNull)

  @@unique([jobPostingId, userId])
  @@index([jobPostingId])
  @@index([userId])
  @@index([coachId])
  @@index([status])
  @@index([createdAt])
  @@index([rating])
  @@map("job_applications")
}

model Announcement {
  id     String @id @default(cuid())
  clubId String

  title   String
  content String  @db.Text
  excerpt String?

  priority AnnouncementPriority @default(NORMAL)
  status   AnnouncementStatus   @default(DRAFT)

  publishAt DateTime?
  expiresAt DateTime?

  targetRoles   ClubMemberRole[]
  targetTeamIds String[]
  isPublic      Boolean          @default(false)

  attachments String[]
  imageUrl    String?

  viewCount Int @default(0)

  authorId String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club   Club @relation(fields: [clubId], references: [id], onDelete: Cascade)
  author User @relation("announcementCreator", fields: [authorId], references: [id])

  @@index([clubId])
  @@index([status])
  @@index([publishAt])
  @@index([priority])
  @@map("announcements")
}

// ============================================================================
// üí∞ BILLING & SUBSCRIPTION MODELS
// ============================================================================

model Subscription {
  id             String  @id @default(cuid())
  userId         String?
  organisationId String?

  stripeSubscriptionId String? @unique
  stripeCustomerId     String?
  stripePriceId        String?

  status SubscriptionStatus @default(ACTIVE)
  tier   AccountTier        @default(FREE)

  currentPeriodStart DateTime
  currentPeriodEnd   DateTime

  trialStart DateTime?
  trialEnd   DateTime?

  cancelledAt       DateTime?
  cancelledReason   String?
  cancelAtPeriodEnd Boolean   @default(false)

  usageLimit   Int?
  usageCurrent Int  @default(0)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user         User?         @relation(fields: [userId], references: [id], onDelete: Cascade)
  organisation Organisation? @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([organisationId])
  @@index([status])
  @@index([currentPeriodEnd])
  @@map("subscriptions")
}

model Payment {
  id     String  @id @default(cuid())
  userId String?

  amount   Float
  currency String @default("GBP")

  status PaymentStatus @default(PENDING)
  type   PaymentType   @default(SUBSCRIPTION)

  stripePaymentIntentId String? @unique
  stripeChargeId        String?

  description String?
  metadata    Json?

  refundedAmount Float?
  refundedAt     DateTime?
  refundReason   String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User? @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([status])
  @@index([type])
  @@index([createdAt])
  @@map("payments")
}

model Invoice {
  id     String @id @default(cuid())
  userId String

  invoiceNumber String @unique
  amount        Float
  tax           Float?
  total         Float
  currency      String @default("GBP")

  issuedAt DateTime
  dueAt    DateTime
  paidAt   DateTime?

  status String @default("ISSUED")

  lineItems Json?

  pdfUrl          String?
  stripeInvoiceId String?

  remindersSent Int       @default(0)
  lastReminder  DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([dueAt])
  @@index([invoiceNumber])
  @@map("invoices")
}

// ============================================================================
// ü§ù SPONSOR MODELS
// ============================================================================

model Sponsor {
  id             String @id @default(cuid())
  organisationId String

  name        String
  logo        String?
  website     String?
  description String? @db.Text

  contactName  String?
  contactEmail String?
  contactPhone String?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation  @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  clubSponsors ClubSponsor[]

  @@index([organisationId])
  @@index([isActive])
  @@map("sponsors")
}

model ClubSponsor {
  id        String @id @default(cuid())
  clubId    String
  sponsorId String

  type      String
  value     Float?
  currency  String    @default("GBP")
  startDate DateTime
  endDate   DateTime?

  deliverables Json?

  isActive Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  club    Club    @relation(fields: [clubId], references: [id], onDelete: Cascade)
  sponsor Sponsor @relation(fields: [sponsorId], references: [id], onDelete: Cascade)

  @@unique([clubId, sponsorId, type])
  @@index([clubId])
  @@index([sponsorId])
  @@map("club_sponsors")
}

// ============================================================================
// üì± NOTIFICATION & CHAT MODELS
// ============================================================================

model Notification {
  id     String @id @default(cuid())
  userId String

  title   String
  message String @db.Text
  type    String

  read   Boolean   @default(false)
  readAt DateTime?

  link     String?
  metadata Json?

  emailSent Boolean @default(false)
  pushSent  Boolean @default(false)

  scheduledFor DateTime?

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([read])
  @@index([type])
  @@index([createdAt])
  @@map("notifications")
}

model NotificationPreference {
  id     String @id @default(cuid())
  userId String @unique

  emailMatches   Boolean @default(true)
  emailTeam      Boolean @default(true)
  emailCoach     Boolean @default(true)
  emailTraining  Boolean @default(true)
  emailNews      Boolean @default(false)
  emailMarketing Boolean @default(false)
  emailJobs      Boolean @default(true)
  emailMedia     Boolean @default(true)

  pushMatches  Boolean @default(true)
  pushTeam     Boolean @default(true)
  pushTraining Boolean @default(true)
  pushChat     Boolean @default(true)
  pushJobs     Boolean @default(true)
  pushMedia    Boolean @default(true)

  smsMatches Boolean @default(false)
  smsUrgent  Boolean @default(false)

  quietHoursStart String?
  quietHoursEnd   String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("notification_preferences")
}

model Chat {
  id String @id @default(cuid())

  type ChatType @default(DIRECT)
  name String?

  teamId String?
  clubId String?

  isArchived Boolean @default(false)
  isMuted    Boolean @default(false)

  lastMessageAt      DateTime?
  lastMessagePreview String?

  createdBy String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  creator  User         @relation("chatCreator", fields: [createdBy], references: [id])
  members  ChatMember[]
  messages Message[]

  @@index([type])
  @@index([teamId])
  @@index([clubId])
  @@index([lastMessageAt])
  @@map("chats")
}

model Message {
  id       String @id @default(cuid())
  senderId String
  chatId   String

  content String @db.Text

  attachments Json?

  readBy   String[]  @default([])
  editedAt DateTime?

  replyToId String?

  deletedAt DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  sender User @relation(fields: [senderId], references: [id], onDelete: Cascade)
  chat   Chat @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@index([senderId])
  @@index([chatId])
  @@index([createdAt])
  @@map("messages")
}

model ChatMember {
  id     String @id @default(cuid())
  userId String
  chatId String

  role     String    @default("MEMBER")
  joinedAt DateTime  @default(now())
  leftAt   DateTime?

  isMuted     Boolean   @default(false)
  lastReadAt  DateTime?
  unreadCount Int       @default(0)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  chat Chat @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@unique([userId, chatId])
  @@index([userId])
  @@index([chatId])
  @@map("chat_members")
}

// ============================================================================
// üë• SOCIAL & GAMIFICATION MODELS
// ============================================================================

model Follow {
  id          String @id @default(cuid())
  followerId  String
  followingId String

  createdAt DateTime @default(now())

  follower  User @relation("follower", fields: [followerId], references: [id], onDelete: Cascade)
  following User @relation("following", fields: [followingId], references: [id], onDelete: Cascade)

  @@unique([followerId, followingId])
  @@index([followerId])
  @@index([followingId])
  @@map("follows")
}

model UserBlock {
  id        String @id @default(cuid())
  blockerId String
  blockedId String

  reason String?

  createdAt DateTime @default(now())

  blocker User @relation("blocker", fields: [blockerId], references: [id], onDelete: Cascade)
  blocked User @relation("blocked", fields: [blockedId], references: [id], onDelete: Cascade)

  @@unique([blockerId, blockedId])
  @@index([blockerId])
  @@map("user_blocks")
}

model SocialAction {
  id     String @id @default(cuid())
  userId String

  type         String
  resourceId   String
  resourceType String

  createdAt DateTime @default(now())

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, type, resourceId, resourceType])
  @@index([userId])
  @@index([resourceType, resourceId])
  @@map("social_actions")
}

model Achievement {
  id String @id @default(cuid())

  userId   String?
  playerId String?
  coachId  String?

  type        String
  title       String
  description String? @db.Text
  icon        String?

  progress Int     @default(100)
  tier     String?

  unlockedAt DateTime @default(now())

  user   User?   @relation("achievementUser", fields: [userId], references: [id], onDelete: Cascade)
  player Player? @relation("achievementPlayer", fields: [playerId], references: [id], onDelete: Cascade)
  coach  Coach?  @relation("achievementCoach", fields: [coachId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([playerId])
  @@index([coachId])
  @@index([type])
  @@map("achievements")
}

model Badge {
  id String @id @default(cuid())

  userId   String?
  playerId String?

  name        String
  description String?
  icon        String?
  category    String?

  rarity String @default("COMMON")

  awardedAt DateTime @default(now())

  user   User?   @relation("badgeUser", fields: [userId], references: [id], onDelete: Cascade)
  player Player? @relation("badgePlayer", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([playerId])
  @@index([category])
  @@map("badges")
}

// ============================================================================
// üîå API & INTEGRATION MODELS
// ============================================================================

model Webhook {
  id             String @id @default(cuid())
  organisationId String

  name   String?
  event  WebhookEvent
  url    String

  isActive Boolean @default(true)
  secret   String?

  headers Json?

  maxRetries   Int @default(3)
  retryDelayMs Int @default(1000)

  failureCount  Int       @default(0)
  lastFailedAt  DateTime?
  lastSuccessAt DateTime?
  lastError     String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  organisation Organisation      @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  deliveries   WebhookDelivery[]

  @@index([organisationId])
  @@index([event])
  @@index([isActive])
  @@map("webhooks")
}

model WebhookDelivery {
  id        String @id @default(cuid())
  webhookId String

  event    WebhookEvent
  payload  Json
  response Json?

  statusCode   Int?
  success      Boolean
  errorMessage String?
  durationMs   Int?

  attemptNumber Int @default(1)

  createdAt DateTime @default(now())

  webhook Webhook @relation(fields: [webhookId], references: [id], onDelete: Cascade)

  @@index([webhookId])
  @@index([success])
  @@index([createdAt])
  @@map("webhook_deliveries")
}

model ApiUsageMetrics {
  id             String @id @default(cuid())
  organisationId String

  date DateTime @db.Date

  callsCount          Int    @default(0)
  averageResponseTime Float?
  errorCount          Int    @default(0)
  bandwidthBytes      BigInt @default(0)

  endpointBreakdown Json?

  updatedAt DateTime @updatedAt

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@unique([organisationId, date])
  @@index([organisationId])
  @@index([date])
  @@map("api_usage_metrics")
}

model QuotaUsage {
  id             String @id @default(cuid())
  organisationId String

  usersUsed             Int @default(0)
  teamsUsed             Int @default(0)
  storageUsedMb         Int @default(0)
  apiCallsUsedThisMonth Int @default(0)
  matchesThisMonth      Int @default(0)
  mediaStorageUsedMb    Int @default(0)

  monthlyResetDate DateTime?

  updatedAt DateTime @updatedAt

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([organisationId])
  @@map("quota_usage")
}

model DatabaseBackup {
  id             String @id @default(cuid())
  organisationId String

  type   String @default("FULL")
  size   Int
  status String @default("COMPLETED")

  backupUrl String?
  checksum  String?
  expiresAt DateTime

  tablesIncluded String[]
  rowsCaptured   Int?

  createdAt DateTime @default(now())

  organisation Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([organisationId])
  @@index([expiresAt])
  @@index([status])
  @@map("database_backups")
}

// ============================================================================
// END OF SCHEMA v7.8.0
// ============================================================================
// 
// TOTAL MODELS: 145
// TOTAL ENUMS: 95
// 
// ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
// ‚ïë                         VERSION 7.8.0 SUMMARY                             ‚ïë
// ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
// ‚ïë                                                                           ‚ïë
// ‚ïë  NEW MODELS IN v7.8.0 (35):                                               ‚ïë
// ‚ïë  ‚îú‚îÄ Coach Management (4):                                                 ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ CoachRate          - Flexible rate structures                      ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ CoachAssignment    - Team-level coach assignments                  ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ CoachCertification - Qualification tracking                        ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ CoachPerformanceReview - Coach evaluations                         ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Export & Reporting (4):                                               ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ ExportRequest      - Export job tracking                           ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ ExportTemplate     - Saved export configurations                   ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ ReportSchedule     - Automated report scheduling                   ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ SportFieldConfig   - Sport-aware field mapping                     ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Player Development (4):                                               ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ PlayerDevelopmentPlan - Structured growth paths                    ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ SkillAssessment    - Detailed skill tracking                       ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ SkillMilestone     - Progress milestones                           ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ MentorshipAssignment - Player mentoring                            ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Communication (3):                                                    ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ TeamAnnouncement   - Team-specific messaging                       ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ EventRSVP          - Event attendance tracking                     ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ ParentPortalAccess - Parent engagement & permissions               ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Enhanced Payments (4):                                                ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ PaymentPlan        - Installment payment plans                     ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ InstallmentPayment - Individual payment tracking                   ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ FeeStructure       - Club/team fee definitions                     ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ Scholarship        - Financial aid tracking                        ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Medical & Wellness (5):                                               ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ RecoveryProtocol   - Injury recovery phases                        ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ NutritionPlan      - Player nutrition tracking                     ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ SleepLog           - Sleep/recovery monitoring                     ‚ïë
// ‚ïë  ‚îÇ  ‚îú‚îÄ WellnessCheck      - Mental health tracking                        ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ PerformanceBenchmark - Comparative analysis                        ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îú‚îÄ Analytics (1):                                                        ‚ïë
// ‚ïë  ‚îÇ  ‚îî‚îÄ TeamChemistry      - Team dynamics tracking                        ‚ïë
// ‚ïë  ‚îÇ                                                                        ‚ïë
// ‚ïë  ‚îî‚îÄ Gamification (6):                                                     ‚ïë
// ‚ïë     ‚îú‚îÄ Challenge          - Player challenges                             ‚ïë
// ‚ïë     ‚îú‚îÄ ChallengeParticipant - Challenge tracking                          ‚ïë
// ‚ïë     ‚îú‚îÄ Leaderboard        - Competitive rankings                          ‚ïë
// ‚ïë     ‚îú‚îÄ LeaderboardEntry   - Player rankings                               ‚ïë
// ‚ïë     ‚îú‚îÄ Streak             - Consistency tracking                          ‚ïë
// ‚ïë     ‚îî‚îÄ SeasonAward        - End-of-season recognition                     ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïë  ENHANCED MODELS:                                                         ‚ïë
// ‚ïë  ‚îú‚îÄ CoachTimesheet        - Added period, breakdown, workflow fields      ‚ïë
// ‚ïë  ‚îú‚îÄ Player                - Added development, wellness relations         ‚ïë
// ‚ïë  ‚îú‚îÄ Coach                 - Added rates, assignments, certifications      ‚ïë
// ‚ïë  ‚îú‚îÄ Club                  - Added export, payment, gamification rels      ‚ïë
// ‚ïë  ‚îú‚îÄ Team                  - Added chemistry, leaderboard, award rels      ‚ïë
// ‚ïë  ‚îú‚îÄ Season                - Added coach assignments, awards rels          ‚ïë
// ‚ïë  ‚îú‚îÄ Parent                - Added portal access relation                  ‚ïë
// ‚ïë  ‚îú‚îÄ Injury                - Added recovery protocols relation             ‚ïë
// ‚ïë  ‚îî‚îÄ User                  - Added export, RSVP, challenge relations       ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïë  NEW ENUMS (14):                                                          ‚ïë
// ‚ïë  ‚îú‚îÄ ExportFormat, ExportStatus, ExportType                                ‚ïë
// ‚ïë  ‚îú‚îÄ CoachRateType, CoachAssignmentType, CertificationStatus               ‚ïë
// ‚ïë  ‚îú‚îÄ DevelopmentPhase, SkillCategory, MilestoneStatus                      ‚ïë
// ‚ïë  ‚îú‚îÄ RSVPStatus, PaymentPlanStatus, ScholarshipType                        ‚ïë
// ‚ïë  ‚îú‚îÄ RecoveryPhase, WellnessCategory                                       ‚ïë
// ‚ïë  ‚îú‚îÄ ChallengeType, ChallengeStatus, LeaderboardType                       ‚ïë
// ‚ïë  ‚îú‚îÄ LeaderboardScope, AwardCategory, ReportFrequency                      ‚ïë
// ‚ïë  ‚îî‚îÄ 40+ new AuditActionType values                                        ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïë  NEW PERMISSIONS (35+):                                                   ‚ïë
// ‚ïë  ‚îú‚îÄ Coach: COACH_RATE_*, COACH_ASSIGNMENT_*, COACH_CERTIFICATION_*        ‚ïë
// ‚ïë  ‚îú‚îÄ Export: EXPORT_*, REPORT_SCHEDULE_*                                   ‚ïë
// ‚ïë  ‚îú‚îÄ Development: DEVELOPMENT_PLAN_*, SKILL_ASSESSMENT_*, MENTORSHIP_*     ‚ïë
// ‚ïë  ‚îú‚îÄ Wellness: WELLNESS_*, RECOVERY_PROTOCOL_*, NUTRITION_*                ‚ïë
// ‚ïë  ‚îú‚îÄ Payments: PAYMENT_PLAN_*, SCHOLARSHIP_*                               ‚ïë
// ‚ïë  ‚îú‚îÄ Gamification: CHALLENGE_*, LEADERBOARD_*, SEASON_AWARD_*              ‚ïë
// ‚ïë  ‚îî‚îÄ Parent: PARENT_PORTAL_*                                               ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïë  NEW WEBHOOK EVENTS (25+):                                                ‚ïë
// ‚ïë  ‚îú‚îÄ Coach: COACH_ASSIGNED, TIMESHEET_*, CERTIFICATION_EXPIRING            ‚ïë
// ‚ïë  ‚îú‚îÄ Export: EXPORT_COMPLETED, REPORT_GENERATED                            ‚ïë
// ‚ïë  ‚îú‚îÄ Development: MILESTONE_COMPLETED, SKILL_ASSESSMENT_COMPLETED          ‚ïë
// ‚ïë  ‚îú‚îÄ Wellness: WELLNESS_ALERT, RECOVERY_PHASE_CHANGED                      ‚ïë
// ‚ïë  ‚îú‚îÄ Payments: PAYMENT_DUE, PAYMENT_OVERDUE                                ‚ïë
// ‚ïë  ‚îî‚îÄ Gamification: CHALLENGE_*, LEADERBOARD_*, STREAK_*, AWARD_*           ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïë  MULTI-SPORT SUPPORT: Full 12 sports                                      ‚ïë
// ‚ïë  ‚îú‚îÄ FOOTBALL, FUTSAL, BEACH_FOOTBALL                                      ‚ïë
// ‚ïë  ‚îú‚îÄ RUGBY, CRICKET, AMERICAN_FOOTBALL                                     ‚ïë
// ‚ïë  ‚îú‚îÄ BASKETBALL, HOCKEY, LACROSSE                                          ‚ïë
// ‚ïë  ‚îú‚îÄ NETBALL, AUSTRALIAN_RULES, GAELIC_FOOTBALL                            ‚ïë
// ‚ïë  ‚îî‚îÄ 65+ position types across all sports                                  ‚ïë
// ‚ïë                                                                           ‚ïë
// ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
// ============================================================================
