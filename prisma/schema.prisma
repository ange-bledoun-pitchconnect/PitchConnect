// =============================================================================
// üèÜ PITCHCONNECT DATABASE SCHEMA v7.10.1 - VIDEO ANALYTICS EDITION
// =============================================================================
//
// Version History:
// - v7.0.0: Initial enterprise schema
// - v7.1.0: Added Two-Factor Auth, Password Reset, Email Verification
// - v7.2.0: Added Team Join Requests, Job Posting System
// - v7.3.0: Added MediaContent, Hybrid Training, Enhanced Attendance
// - v7.4.0: Competition System, Match Enhancements, Multi-Sport
// - v7.5.0: Social Accounts, Fitness Assessments, Parent-Child Relations
// - v7.6.0: AI Predictions, Enhanced Referee/Scout, Watchlists, Analytics
// - v7.7.0: Training Drill Library, Budget & Expense System, Enhanced Stats
// - v7.8.0: Coach Management, Export System, Player Development, Gamification
// - v7.9.0: SuperAdmin System, Enhanced 2FA, System Settings, Notifications
// - v7.10.0: Achievement System, XP/Leveling, Milestones, Streaks
// - v7.10.1: Video Analytics System, Comments, Watch History, Engagement Tracking
//
// =============================================================================
// NEW IN v7.10.1 - VIDEO ANALYTICS SYSTEM
// =============================================================================
//
// üé¨ VIDEO ANALYTICS SYSTEM (7 new models):
// - MediaViewLog: Detailed view analytics with device/geo/network tracking
// - MediaInteraction: User engagement (likes, bookmarks, shares, ratings)
// - MediaComment: Comments with threading, timestamps, moderation
// - MediaCommentLike: Comment engagement tracking
// - MediaAnalyticsSummary: Aggregated analytics per media item
// - WatchHistory: User watch history for recommendations
// - BookmarkFolder: Organize saved media into folders
//
// üìä NEW ENUMS (1 total):
// - CommentStatus: PENDING, PUBLISHED, HIDDEN, FLAGGED, REMOVED, DELETED
//
// üîî ENHANCED NOTIFICATIONS:
// - VIDEO_COMMENT_RECEIVED, VIDEO_COMMENT_REPLY
// - VIDEO_LIKED, VIDEO_SHARED, VIDEO_BOOKMARKED
// - VIDEO_MILESTONE_VIEWS, VIDEO_TRENDING
//
// üîó ENHANCED WEBHOOK EVENTS:
// - VIDEO_COMMENT_POSTED, VIDEO_ENGAGEMENT_MILESTONE
// - VIDEO_TRENDING, VIDEO_ANALYTICS_READY
//
// üîó UPDATED MODELS:
// - MediaContent: Added relations for views, interactions, comments, analytics
// - User: Added relations for media views, interactions, comments, watch history
//
// =============================================================================

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearchPostgres", "views", "postgresqlExtensions"]
  binaryTargets   = ["native", "rhel-openssl-1.0.x", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  directUrl  = env("DIRECT_URL")
  extensions = [citext]
}

// =============================================================================
// üìã ENUMS - USER & AUTHENTICATION
// =============================================================================

enum UserRole {
  SUPERADMIN
  ADMIN
  PLAYER
  PLAYER_PRO
  COACH
  COACH_PRO
  MANAGER
  CLUB_MANAGER
  CLUB_OWNER
  TREASURER
  REFEREE
  SCOUT
  ANALYST
  PARENT
  GUARDIAN
  LEAGUE_ADMIN
  MEDICAL_STAFF
  MEDIA_MANAGER
  FAN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  BANNED
  PENDING_VERIFICATION
  PENDING_EMAIL_VERIFICATION
  PENDING_PHONE_VERIFICATION
  PENDING_APPROVAL
  ARCHIVED
  DELETED
  DEACTIVATED
}

enum UserType {
  INDIVIDUAL
  ORGANIZATION
  FAMILY
}

enum AccountTier {
  FREE
  PRO
  PREMIUM
  ENTERPRISE
}

enum OrganisationRole {
  OWNER
  ADMIN
  MANAGER
  MEMBER
  VIEWER
}

enum OrganisationTier {
  STARTER
  PROFESSIONAL
  ENTERPRISE
  CUSTOM
}

enum VerificationType {
  EMAIL
  PHONE
  PASSWORD_RESET
  TWO_FACTOR
  ACCOUNT_RECOVERY
}

// =============================================================================
// üìã ENUMS - SYSTEM SETTINGS (v7.9.0)
// =============================================================================

enum SettingCategory {
  GENERAL
  SECURITY
  NOTIFICATIONS
  PAYMENTS
  FEATURES
  INTEGRATIONS
  LIMITS
  MAINTENANCE
}

enum SettingValueType {
  STRING
  NUMBER
  BOOLEAN
  JSON
  ARRAY
  ENCRYPTED
}

// =============================================================================
// üìã ENUMS - NOTIFICATIONS (ENHANCED v7.10.1)
// =============================================================================

enum NotificationType {
  // Generic Notifications
  SYSTEM_ALERT
  SYSTEM_MAINTENANCE
  SYSTEM_UPDATE
  ACCOUNT_UPDATE
  PASSWORD_CHANGED
  EMAIL_VERIFIED
  PROFILE_UPDATE
  SETTINGS_CHANGED

  // Match Notifications
  MATCH_SCHEDULED
  MATCH_REMINDER
  MATCH_STARTING
  MATCH_LIVE
  MATCH_HALFTIME
  MATCH_FULLTIME
  MATCH_CANCELLED
  MATCH_POSTPONED
  MATCH_RESULT
  MATCH_LINEUP_ANNOUNCED
  MATCH_SQUAD_SELECTED
  MATCH_NOT_SELECTED

  // Team Notifications
  TEAM_JOINED
  TEAM_LEFT
  TEAM_INVITE
  TEAM_REMOVED
  TEAM_UPDATE
  TEAM_ANNOUNCEMENT

  // Training Notifications
  TRAINING_SCHEDULED
  TRAINING_REMINDER
  TRAINING_CANCELLED
  TRAINING_UPDATED
  TRAINING_ATTENDANCE_REQUIRED

  // Player Notifications
  PLAYER_INJURED
  PLAYER_RECOVERED
  PLAYER_CLEARED
  PLAYER_MILESTONE
  PLAYER_ACHIEVEMENT
  PLAYER_TRANSFER
  PLAYER_CONTRACT

  // Coach Notifications
  COACH_ASSIGNED
  COACH_UNASSIGNED
  COACH_REVIEW
  COACH_CERTIFICATION_EXPIRING

  // Financial Notifications
  PAYMENT_RECEIVED
  PAYMENT_DUE
  PAYMENT_OVERDUE
  PAYMENT_FAILED
  SUBSCRIPTION_RENEWED
  SUBSCRIPTION_EXPIRING
  SUBSCRIPTION_CANCELLED
  INVOICE_GENERATED
  REFUND_PROCESSED

  // Admin Notifications
  USER_REGISTERED
  USER_SUSPENDED
  USER_BANNED
  USER_UNBANNED
  UPGRADE_REQUEST_SUBMITTED
  UPGRADE_REQUEST_APPROVED
  UPGRADE_REQUEST_REJECTED
  ROLE_CHANGED
  PERMISSION_CHANGED

  // Communication Notifications
  NEW_MESSAGE
  MESSAGE_MENTION
  ANNOUNCEMENT_POSTED
  COMMENT_RECEIVED
  FEEDBACK_RECEIVED

  // Job Notifications
  JOB_POSTED
  JOB_APPLICATION_RECEIVED
  JOB_APPLICATION_REVIEWED
  JOB_APPLICATION_ACCEPTED
  JOB_APPLICATION_REJECTED
  JOB_INTERVIEW_SCHEDULED

  // Scouting Notifications
  SCOUTING_REPORT_SUBMITTED
  WATCHLIST_PLAYER_ADDED
  WATCHLIST_ALERT
  PLAYER_RECOMMENDED

  // Achievement & Gamification Notifications (v7.10.0)
  BADGE_EARNED
  ACHIEVEMENT_UNLOCKED
  ACHIEVEMENT_PROGRESS
  ACHIEVEMENT_TIER_UNLOCKED
  MILESTONE_REACHED
  MILESTONE_APPROACHING
  LEVEL_UP
  XP_EARNED
  XP_BONUS
  PRESTIGE_UNLOCKED
  STREAK_MILESTONE
  STREAK_AT_RISK
  STREAK_LOST
  STREAK_RESTORED
  STREAK_RECORD
  LEADERBOARD_POSITION_CHANGED
  CHALLENGE_STARTED
  CHALLENGE_COMPLETED
  CHALLENGE_REWARD_CLAIMED

  // Development Notifications
  DEVELOPMENT_PLAN_CREATED
  MILESTONE_COMPLETED
  SKILL_ASSESSED
  MENTORSHIP_STARTED

  // Medical/Wellness Notifications
  FITNESS_ASSESSMENT_DUE
  WELLNESS_CHECK_REQUIRED
  RECOVERY_PHASE_CHANGED
  MEDICAL_CLEARANCE_REQUIRED

  // =========================================================================
  // üé¨ VIDEO & MEDIA NOTIFICATIONS (NEW v7.10.1)
  // =========================================================================
  VIDEO_COMMENT_RECEIVED
  VIDEO_COMMENT_REPLY
  VIDEO_COMMENT_MENTION
  VIDEO_LIKED
  VIDEO_SHARED
  VIDEO_BOOKMARKED
  VIDEO_DOWNLOADED
  VIDEO_MILESTONE_VIEWS
  VIDEO_TRENDING
  VIDEO_PROCESSING_COMPLETE
  VIDEO_PROCESSING_FAILED
  VIDEO_UPLOAD_COMPLETE

  // Sport-Specific Notifications (v7.9.0)
  // Football/Soccer
  FOOTBALL_GOAL_SCORED
  FOOTBALL_ASSIST
  FOOTBALL_CARD_ISSUED
  FOOTBALL_SUBSTITUTION
  FOOTBALL_PENALTY
  FOOTBALL_VAR_REVIEW
  FOOTBALL_OFFSIDE
  FOOTBALL_CORNER
  FOOTBALL_FREE_KICK

  // Rugby
  RUGBY_TRY_SCORED
  RUGBY_CONVERSION
  RUGBY_PENALTY_KICK
  RUGBY_DROP_GOAL
  RUGBY_SIN_BIN
  RUGBY_RED_CARD
  RUGBY_SCRUM
  RUGBY_LINEOUT
  RUGBY_TMO_REVIEW

  // Basketball
  BASKETBALL_QUARTER_END
  BASKETBALL_TIMEOUT
  BASKETBALL_FOUL
  BASKETBALL_THREE_POINTER
  BASKETBALL_DUNK
  BASKETBALL_FAST_BREAK
  BASKETBALL_TECHNICAL_FOUL

  // Cricket
  CRICKET_WICKET
  CRICKET_BOUNDARY
  CRICKET_SIX
  CRICKET_OVER_COMPLETE
  CRICKET_INNINGS_END
  CRICKET_DRINKS_BREAK
  CRICKET_RAIN_DELAY
  CRICKET_DRS_REVIEW

  // American Football
  AMERICAN_FOOTBALL_TOUCHDOWN
  AMERICAN_FOOTBALL_FIELD_GOAL
  AMERICAN_FOOTBALL_SAFETY
  AMERICAN_FOOTBALL_TWO_POINT
  AMERICAN_FOOTBALL_QUARTER_END
  AMERICAN_FOOTBALL_TURNOVER
  AMERICAN_FOOTBALL_SACK

  // Hockey
  HOCKEY_GOAL
  HOCKEY_PENALTY
  HOCKEY_PERIOD_END
  HOCKEY_SHOOTOUT
  HOCKEY_POWER_PLAY
  HOCKEY_HAT_TRICK

  // Netball
  NETBALL_GOAL
  NETBALL_QUARTER_END
  NETBALL_CENTER_PASS
  NETBALL_OBSTRUCTION

  // Other
  GENERAL_SCORE_UPDATE
  PERIOD_END
  OVERTIME_START
  MATCH_DELAYED
  WEATHER_UPDATE
}

// =============================================================================
// üìã ENUMS - AI PREDICTIONS (v7.6.0)
// =============================================================================

enum PredictionType {
  PERFORMANCE
  FORM_TREND
  GOALS_ASSISTS
  INJURY_RISK
  FATIGUE_LEVEL
  RECOVERY_TIME
  MARKET_VALUE
  TRANSFER_LIKELIHOOD
  CONTRACT_VALUE
  FORMATION
  LINEUP
  TACTICAL_MATCHUP
  MATCH_OUTCOME
  SCORE_PREDICTION
  POTENTIAL_RATING
  DEVELOPMENT_PATH
  TEAM_CHEMISTRY
  RECRUITMENT_FIT
}

enum PredictionStatus {
  PENDING
  ACTIVE
  VERIFIED_CORRECT
  VERIFIED_INCORRECT
  PARTIALLY_CORRECT
  EXPIRED
  INVALIDATED
}

enum PredictionImpact {
  CRITICAL
  HIGH
  MEDIUM
  LOW
  INFORMATIONAL
}

// =============================================================================
// üìã ENUMS - SCOUT WATCHLIST (v7.6.0)
// =============================================================================

enum WatchlistStatus {
  MONITORING
  INTERESTED
  HOT_PROSPECT
  RECOMMENDED
  IN_NEGOTIATION
  SIGNED
  PASSED
  UNAVAILABLE
}

enum WatchlistPriority {
  CRITICAL
  HIGH
  MEDIUM
  LOW
  WATCHING
}

// =============================================================================
// üìã ENUMS - REFEREE (v7.6.0)
// =============================================================================

enum RefereeLevel {
  TRAINEE
  GRASSROOTS
  COUNTY
  NATIONAL
  FIFA
  UEFA
  ELITE
}

enum RefereeAvailabilityStatus {
  AVAILABLE
  UNAVAILABLE
  TENTATIVE
  ASSIGNED
  BLOCKED
}

// =============================================================================
// üìã ENUMS - EXPORT SYSTEM (v7.8.0)
// =============================================================================

enum ExportFormat {
  CSV
  PDF
  EXCEL
  JSON
  XML
}

enum ExportStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
  EXPIRED
  CANCELLED
}

enum ExportType {
  PLAYERS
  TEAMS
  MATCHES
  STANDINGS
  TRAINING
  ATTENDANCE
  PERFORMANCE
  FINANCIAL
  MEDICAL
  SCOUTING
  ANALYTICS
  CUSTOM
}

// =============================================================================
// üìã ENUMS - DATA EXPORT (ENHANCED v7.9.0)
// =============================================================================

enum DataExportStatus {
  PENDING
  QUEUED
  PROCESSING
  GENERATING
  ENCRYPTING
  UPLOADING
  COMPLETED
  FAILED
  EXPIRED
  DOWNLOADED
  DELETED
}

// =============================================================================
// üìã ENUMS - COACH MANAGEMENT (v7.8.0)
// =============================================================================

enum CoachRateType {
  HOURLY
  DAILY
  SESSION
  MATCH
  WEEKLY
  MONTHLY
  FIXED
  PER_PLAYER
}

enum CoachAssignmentType {
  HEAD_COACH
  ASSISTANT_COACH
  GOALKEEPER_COACH
  FITNESS_COACH
  YOUTH_COACH
  DEVELOPMENT_COACH
  TECHNICAL_DIRECTOR
  INTERIM
  SPECIALIST
  CONSULTANT
}

enum CertificationStatus {
  ACTIVE
  EXPIRED
  PENDING_RENEWAL
  SUSPENDED
  REVOKED
}

// =============================================================================
// üìã ENUMS - PLAYER DEVELOPMENT (v7.8.0)
// =============================================================================

enum DevelopmentPhase {
  FOUNDATION
  DEVELOPMENT
  MASTERY
  ELITE
  PROFESSIONAL
}

enum SkillCategory {
  TECHNICAL
  TACTICAL
  PHYSICAL
  MENTAL
  SOCIAL
  LEADERSHIP
}

enum MilestoneStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  OVERDUE
  CANCELLED
}

// =============================================================================
// üìã ENUMS - COMMUNICATION (v7.8.0)
// =============================================================================

enum RSVPStatus {
  PENDING
  ATTENDING
  NOT_ATTENDING
  MAYBE
  WAITLISTED
}

// =============================================================================
// üìã ENUMS - PAYMENTS (v7.8.0)
// =============================================================================

enum PaymentPlanStatus {
  ACTIVE
  COMPLETED
  DEFAULTED
  CANCELLED
  PAUSED
}

enum ScholarshipType {
  FULL
  PARTIAL
  MERIT
  NEED_BASED
  ATHLETIC
  ACADEMIC
}

// =============================================================================
// üìã ENUMS - MEDICAL & WELLNESS (v7.8.0)
// =============================================================================

enum RecoveryPhase {
  ACUTE
  SUBACUTE
  REMODELING
  FUNCTIONAL
  RETURN_TO_SPORT
  FULL_CLEARANCE
}

enum WellnessCategory {
  PHYSICAL
  MENTAL
  EMOTIONAL
  SOCIAL
  SLEEP
  NUTRITION
  STRESS
}

// =============================================================================
// üìã ENUMS - GAMIFICATION (v7.8.0)
// =============================================================================

enum ChallengeType {
  INDIVIDUAL
  TEAM
  CLUB
  GLOBAL
}

enum ChallengeStatus {
  UPCOMING
  ACTIVE
  COMPLETED
  EXPIRED
  CANCELLED
}

enum LeaderboardType {
  GOALS
  ASSISTS
  CLEAN_SHEETS
  RATING
  ATTENDANCE
  FITNESS
  TRAINING
  CUSTOM
}

enum LeaderboardScope {
  TEAM
  CLUB
  LEAGUE
  REGION
  NATIONAL
  GLOBAL
}

enum AwardCategory {
  MVP
  TOP_SCORER
  TOP_ASSISTER
  BEST_DEFENDER
  BEST_GOALKEEPER
  MOST_IMPROVED
  COACHES_AWARD
  FAIR_PLAY
  ATTENDANCE
  LEADERSHIP
  ROOKIE_OF_YEAR
  CUSTOM
}

enum ReportFrequency {
  DAILY
  WEEKLY
  BIWEEKLY
  MONTHLY
  QUARTERLY
  YEARLY
  ON_DEMAND
}

// =============================================================================
// üìã ENUMS - TRAINING DRILL SYSTEM (v7.7.0)
// =============================================================================

enum DrillCategory {
  // Universal Categories (All Sports)
  WARM_UP
  COOL_DOWN
  CONDITIONING
  STRENGTH_POWER
  SPEED_AGILITY
  FLEXIBILITY_MOBILITY
  RECOVERY
  MENTAL_PREPARATION
  VIDEO_ANALYSIS
  TEAM_MEETING

  // Technical - Ball Sports
  PASSING
  SHOOTING
  DRIBBLING
  FIRST_TOUCH
  CROSSING
  HEADING

  // Tactical Categories
  DEFENSIVE_SHAPE
  ATTACKING_PATTERNS
  SET_PIECES
  TRANSITIONS
  PRESSING
  BUILD_UP_PLAY
  COUNTER_ATTACK

  // Position-Specific Training
  GOALKEEPER_TRAINING
  DEFENDER_TRAINING
  MIDFIELDER_TRAINING
  FORWARD_TRAINING

  // Team Training
  SMALL_SIDED_GAMES
  MATCH_SIMULATION
  TEAM_TACTICS

  // Rugby-Specific
  SCRUMMAGING
  LINEOUT
  RUCKING
  MAULING
  TACKLING_TECHNIQUE
  BREAKDOWN

  // Basketball-Specific
  FREE_THROWS
  THREE_POINT_SHOOTING
  POST_MOVES
  PICK_AND_ROLL
  FAST_BREAK
  ZONE_DEFENSE
  MAN_TO_MAN

  // Cricket-Specific
  BATTING_TECHNIQUE
  BOWLING_TECHNIQUE
  FIELDING_DRILLS
  CATCHING
  WICKET_KEEPING

  // American Football-Specific
  BLOCKING
  ROUTE_RUNNING
  COVERAGE
  SPECIAL_TEAMS

  // Netball-Specific
  FOOTWORK
  INTERCEPTIONS
  COURT_MOVEMENT
  CIRCLE_WORK

  // Hockey-Specific
  STICK_HANDLING
  SLAP_SHOT
  POWER_PLAY
  PENALTY_KILL

  // Other Categories
  REHABILITATION
  INDIVIDUAL_SKILL
  FUN_GAMES
  OTHER
}

enum DrillIntensity {
  RECOVERY
  LOW
  MEDIUM
  HIGH
  MAXIMUM
  VARIABLE
}

enum DrillDifficulty {
  BEGINNER
  INTERMEDIATE
  ADVANCED
  ELITE
}

// =============================================================================
// üìã ENUMS - BUDGET & EXPENSE SYSTEM (v7.7.0)
// =============================================================================

enum BudgetStatus {
  DRAFT
  ACTIVE
  FROZEN
  CLOSED
  ARCHIVED
}

enum BudgetPeriodType {
  SEASON
  CALENDAR_YEAR
  FISCAL_YEAR
  QUARTERLY
  MONTHLY
  CUSTOM
}

enum ExpenseCategory {
  // Equipment & Gear
  EQUIPMENT_PURCHASE
  EQUIPMENT_MAINTENANCE
  EQUIPMENT_RENTAL
  UNIFORMS_KITS
  TRAINING_GEAR

  // Facilities
  FACILITY_RENTAL
  FACILITY_MAINTENANCE
  PITCH_HIRE
  GYM_MEMBERSHIP

  // Travel & Accommodation
  TRAVEL_TRANSPORT
  TRAVEL_FUEL
  ACCOMMODATION
  MEALS_CATERING

  // Staff & Personnel
  COACHING_FEES
  REFEREE_FEES
  MEDICAL_STAFF
  ADMINISTRATIVE_STAFF

  // Medical & Welfare
  MEDICAL_SUPPLIES
  PHYSIOTHERAPY
  INSURANCE_PREMIUMS
  PLAYER_WELFARE

  // Competition & Registration
  LEAGUE_FEES
  COMPETITION_ENTRY
  REGISTRATION_FEES
  FINES_PENALTIES

  // Marketing & Admin
  MARKETING_PROMOTION
  WEBSITE_HOSTING
  SOFTWARE_SUBSCRIPTIONS
  PRINTING_STATIONERY

  // Events
  EVENTS_SOCIALS
  AWARDS_TROPHIES
  END_OF_SEASON

  // Other
  MISCELLANEOUS
  CONTINGENCY
  OTHER
}

enum ExpenseStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  REJECTED
  PAID
  REIMBURSED
  CANCELLED
}

// =============================================================================
// üìã ENUMS - PERMISSIONS (ENHANCED v7.9.0)
// =============================================================================

enum PermissionType {
  // User Management
  USER_CREATE
  USER_READ
  USER_UPDATE
  USER_DELETE
  USER_SUSPEND
  USER_BAN

  // Team Management
  TEAM_CREATE
  TEAM_READ
  TEAM_UPDATE
  TEAM_DELETE
  TEAM_INVITE
  TEAM_REMOVE_MEMBER

  // Match Management
  MATCH_CREATE
  MATCH_READ
  MATCH_UPDATE
  MATCH_DELETE
  MATCH_PUBLISH
  MATCH_APPROVE_RESULT
  MATCH_RECORD_STATS
  MATCH_MANAGE_LINEUP
  MATCH_RECORD_EVENTS

  // Competition Management
  COMPETITION_CREATE
  COMPETITION_READ
  COMPETITION_UPDATE
  COMPETITION_DELETE
  COMPETITION_MANAGE_TEAMS

  // Player Management
  PLAYER_CREATE
  PLAYER_READ
  PLAYER_UPDATE
  PLAYER_DELETE
  PLAYER_VERIFY
  PLAYER_TRANSFER

  // Medical & Health
  MEDICAL_READ
  MEDICAL_CREATE
  MEDICAL_UPDATE
  MEDICAL_READ_FULL
  MEDICAL_READ_AVAILABILITY

  // Financial
  BILLING_READ
  BILLING_UPDATE
  BILLING_MANAGE_SUBSCRIPTIONS
  BUDGET_VIEW
  BUDGET_CREATE
  BUDGET_UPDATE
  BUDGET_DELETE
  EXPENSE_VIEW
  EXPENSE_CREATE
  EXPENSE_APPROVE
  EXPENSE_DELETE
  PAYMENT_PLAN_VIEW
  PAYMENT_PLAN_CREATE
  PAYMENT_PLAN_MANAGE
  SCHOLARSHIP_VIEW
  SCHOLARSHIP_MANAGE

  // Analytics & Predictions
  ANALYTICS_VIEW
  ANALYTICS_EXPORT
  PREDICTIONS_VIEW
  PREDICTIONS_CREATE
  PREDICTIONS_MANAGE

  // Scouting
  SCOUTING_VIEW
  SCOUTING_CREATE_REPORT
  SCOUTING_MANAGE_WATCHLIST

  // Referee
  REFEREE_VIEW_ASSIGNMENTS
  REFEREE_MANAGE_AVAILABILITY
  REFEREE_SUBMIT_REPORTS
  REFEREE_VIEW_FEES

  // Training
  TRAINING_VIEW
  TRAINING_CREATE
  TRAINING_UPDATE
  TRAINING_DELETE
  TRAINING_MANAGE_DRILLS
  DRILL_CREATE
  DRILL_UPDATE
  DRILL_DELETE
  DRILL_MANAGE_LIBRARY

  // Coach Management
  COACH_RATE_VIEW
  COACH_RATE_CREATE
  COACH_RATE_UPDATE
  COACH_RATE_DELETE
  COACH_ASSIGNMENT_VIEW
  COACH_ASSIGNMENT_CREATE
  COACH_ASSIGNMENT_UPDATE
  COACH_ASSIGNMENT_DELETE
  COACH_CERTIFICATION_VIEW
  COACH_CERTIFICATION_MANAGE
  COACH_REVIEW_VIEW
  COACH_REVIEW_CREATE

  // Export & Reports
  EXPORT_REQUEST
  EXPORT_TEMPLATE_CREATE
  EXPORT_TEMPLATE_MANAGE
  REPORT_SCHEDULE_CREATE
  REPORT_SCHEDULE_MANAGE

  // Player Development
  DEVELOPMENT_PLAN_VIEW
  DEVELOPMENT_PLAN_CREATE
  DEVELOPMENT_PLAN_MANAGE
  SKILL_ASSESSMENT_VIEW
  SKILL_ASSESSMENT_CREATE
  MENTORSHIP_VIEW
  MENTORSHIP_MANAGE

  // Wellness
  WELLNESS_VIEW
  WELLNESS_CREATE
  WELLNESS_VIEW_CONFIDENTIAL
  RECOVERY_PROTOCOL_VIEW
  RECOVERY_PROTOCOL_MANAGE
  NUTRITION_VIEW
  NUTRITION_MANAGE

  // Gamification
  CHALLENGE_VIEW
  CHALLENGE_CREATE
  CHALLENGE_MANAGE
  LEADERBOARD_VIEW
  LEADERBOARD_MANAGE
  SEASON_AWARD_VIEW
  SEASON_AWARD_MANAGE

  // Parent Portal
  PARENT_PORTAL_VIEW
  PARENT_PORTAL_MANAGE

  // API & System
  API_ACCESS
  API_KEY_CREATE
  API_KEY_REVOKE

  // Facilities & Venues
  FACILITY_MANAGE
  FACILITY_BOOK
  VENUE_CREATE
  VENUE_UPDATE

  // Admin & Audit
  SYSTEM_ADMIN
  AUDIT_LOG_VIEW

  // Media
  MEDIA_UPLOAD
  MEDIA_DELETE
  MEDIA_MANAGE

  // Social
  SOCIAL_CONNECT
  SOCIAL_POST
  SOCIAL_MANAGE

  // SuperAdmin (v7.9.0)
  SUPERADMIN_SETTINGS_VIEW
  SUPERADMIN_SETTINGS_MANAGE
  SUPERADMIN_USERS_MANAGE
  SUPERADMIN_SYSTEM_MANAGE
  SUPERADMIN_ANALYTICS_VIEW
  SUPERADMIN_BILLING_MANAGE

  // =========================================================================
  // üé¨ VIDEO ANALYTICS PERMISSIONS (NEW v7.10.1)
  // =========================================================================
  VIDEO_ANALYTICS_VIEW
  VIDEO_ANALYTICS_EXPORT
  VIDEO_COMMENTS_MODERATE
  VIDEO_COMMENTS_DELETE
}

enum DataRetentionPolicy {
  EPHEMERAL
  TEMPORARY
  STANDARD
  PERMANENT
  DELETED
}

// =============================================================================
// üìã ENUMS - AUDIT ACTION TYPES (ENHANCED v7.10.1)
// =============================================================================

enum AuditActionType {
  // User Actions
  USER_CREATED
  USER_UPDATED
  USER_DELETED
  USER_SUSPENDED
  USER_BANNED
  USER_UNBANNED
  USER_REACTIVATED
  USER_SOFT_DELETED
  USER_HARD_DELETED
  USER_RESTORED
  ROLE_ASSIGNED
  ROLE_REMOVED
  USER_REGISTERED
  USER_LOGIN
  USER_LOGOUT
  LOGIN_FAILED
  LOGIN_LOCKED

  // Verification & Security
  EMAIL_VERIFIED
  PHONE_VERIFIED
  PASSWORD_CHANGED
  PASSWORD_RESET_REQUESTED
  PASSWORD_RESET_COMPLETED
  TWO_FACTOR_ENABLED
  TWO_FACTOR_DISABLED
  TWO_FACTOR_VERIFIED
  TWO_FACTOR_BACKUP_USED
  TWO_FACTOR_BACKUP_REGENERATED
  TWO_FACTOR_LOCKOUT
  SESSION_CREATED
  SESSION_REVOKED
  SESSION_EXPIRED
  VERIFICATION_EMAIL_SENT
  VERIFICATION_EMAIL_RESENT

  // Subscription & Payment
  SUBSCRIPTION_GRANTED
  SUBSCRIPTION_UPGRADED
  SUBSCRIPTION_DOWNGRADED
  SUBSCRIPTION_CANCELLED
  SUBSCRIPTION_BULK_GRANTED
  PAYMENT_PROCESSED
  PAYMENT_FAILED
  REFUND_PROCESSED
  MANUAL_PAYMENT_CREATED

  // Data Management
  DATA_EXPORTED
  DATA_DELETED
  DATA_IMPORTED

  // Organisation & Club
  TEAM_CREATED
  TEAM_UPDATED
  TEAM_DELETED
  CLUB_CREATED
  CLUB_UPDATED
  CLUB_DELETED

  // Match & Competition
  MATCH_CREATED
  MATCH_UPDATED
  MATCH_RESULT_UPDATED
  MATCH_CANCELLED
  MATCH_LINEUP_SET
  MATCH_EVENT_RECORDED
  MATCH_STATUS_CHANGED
  COMPETITION_CREATED
  COMPETITION_UPDATED
  COMPETITION_DELETED
  COMPETITION_TEAM_ADDED
  COMPETITION_TEAM_REMOVED

  // Player & Medical
  PLAYER_TRANSFER
  PLAYER_CONTRACT_SIGNED
  PLAYER_PERFORMANCE_RECORDED
  MEDICAL_RECORD_ACCESSED
  MEDICAL_RECORD_CREATED
  FITNESS_ASSESSMENT_CREATED
  FITNESS_ASSESSMENT_UPDATED
  PLAYER_CLEARED_TO_PLAY

  // Join Requests & Jobs
  JOIN_REQUEST_SUBMITTED
  JOIN_REQUEST_APPROVED
  JOIN_REQUEST_REJECTED
  JOIN_REQUEST_CANCELLED
  JOB_POSTED
  JOB_CLOSED
  JOB_APPLICATION_SUBMITTED
  JOB_APPLICATION_REVIEWED
  JOB_APPLICATION_ACCEPTED
  JOB_APPLICATION_REJECTED

  // Training & Drills
  TRAINING_CREATED
  TRAINING_UPDATED
  TRAINING_CANCELLED
  DRILL_CREATED
  DRILL_UPDATED
  DRILL_DELETED
  DRILL_ADDED_TO_SESSION
  DRILL_REMOVED_FROM_SESSION

  // Media & Social
  MEDIA_UPLOADED
  MEDIA_DELETED
  MEDIA_SHARED
  SOCIAL_ACCOUNT_CONNECTED
  SOCIAL_ACCOUNT_DISCONNECTED
  SOCIAL_POST_PUBLISHED

  // AI Predictions
  PREDICTION_CREATED
  PREDICTION_VERIFIED
  PREDICTION_FEEDBACK_SUBMITTED

  // Scouting
  SCOUTING_REPORT_CREATED
  WATCHLIST_PLAYER_ADDED
  WATCHLIST_PLAYER_UPDATED
  WATCHLIST_PLAYER_REMOVED

  // Referee
  REFEREE_ASSIGNED
  REFEREE_AVAILABILITY_UPDATED
  REFEREE_REPORT_SUBMITTED
  REFEREE_PAYMENT_PROCESSED

  // Budget & Expense
  BUDGET_CREATED
  BUDGET_UPDATED
  BUDGET_DELETED
  BUDGET_STATUS_CHANGED
  BUDGET_CATEGORY_ADDED
  BUDGET_CATEGORY_UPDATED
  EXPENSE_CREATED
  EXPENSE_UPDATED
  EXPENSE_DELETED
  EXPENSE_SUBMITTED
  EXPENSE_APPROVED
  EXPENSE_REJECTED
  EXPENSE_PAID
  EXPENSE_REIMBURSED

  // Coach Management
  COACH_RATE_CREATED
  COACH_RATE_UPDATED
  COACH_RATE_DELETED
  COACH_ASSIGNMENT_CREATED
  COACH_ASSIGNMENT_UPDATED
  COACH_ASSIGNMENT_ENDED
  COACH_CERTIFICATION_ADDED
  COACH_CERTIFICATION_EXPIRED
  COACH_REVIEW_CREATED
  COACH_REVIEW_ACKNOWLEDGED

  // Export & Reports
  EXPORT_REQUESTED
  EXPORT_COMPLETED
  EXPORT_FAILED
  EXPORT_DOWNLOADED
  EXPORT_TEMPLATE_CREATED
  EXPORT_TEMPLATE_UPDATED
  EXPORT_TEMPLATE_DELETED
  REPORT_SCHEDULED
  REPORT_GENERATED

  // Player Development
  DEVELOPMENT_PLAN_CREATED
  DEVELOPMENT_PLAN_UPDATED
  MILESTONE_COMPLETED
  SKILL_ASSESSED
  MENTORSHIP_STARTED
  MENTORSHIP_ENDED

  // Wellness
  WELLNESS_CHECK_FLAGGED
  RECOVERY_PHASE_CHANGED

  // Payments
  PAYMENT_PLAN_CREATED
  INSTALLMENT_PAID
  INSTALLMENT_OVERDUE
  SCHOLARSHIP_AWARDED
  SCHOLARSHIP_REVOKED

  // Gamification
  CHALLENGE_CREATED
  CHALLENGE_COMPLETED
  LEADERBOARD_UPDATED
  STREAK_MILESTONE_REACHED
  SEASON_AWARD_ANNOUNCED

  // Notifications (v7.9.0)
  NOTIFICATION_SENT
  NOTIFICATION_BATCH_SENT
  NOTIFICATION_TEMPLATE_CREATED

  // System Settings (v7.9.0)
  SYSTEM_SETTING_UPDATED
  SYSTEM_SETTING_CREATED
  MAINTENANCE_MODE_ENABLED
  MAINTENANCE_MODE_DISABLED

  // SuperAdmin Actions (v7.9.0)
  SUPERADMIN_IMPERSONATION_STARTED
  SUPERADMIN_IMPERSONATION_ENDED
  SUPERADMIN_USER_MODIFIED
  SUPERADMIN_BULK_OPERATION
  SUPERADMIN_SYSTEM_HEALTH_CHECK

  // GDPR & Security
  CONSENT_UPDATED
  GDPR_REQUEST
  DATA_RETENTION_APPLIED
  SYSTEM_MAINTENANCE
  API_KEY_GENERATED
  API_KEY_REVOKED
  SUSPICIOUS_LOGIN
  SECURITY_ALERT

  // =========================================================================
  // üé¨ VIDEO ANALYTICS AUDIT ACTIONS (NEW v7.10.1)
  // =========================================================================
  VIDEO_VIEWED
  VIDEO_LIKED
  VIDEO_UNLIKED
  VIDEO_BOOKMARKED
  VIDEO_UNBOOKMARKED
  VIDEO_SHARED
  VIDEO_DOWNLOADED
  VIDEO_COMMENT_CREATED
  VIDEO_COMMENT_EDITED
  VIDEO_COMMENT_DELETED
  VIDEO_COMMENT_MODERATED
  VIDEO_COMMENT_REPORTED
  VIDEO_ANALYTICS_EXPORTED
}

// =============================================================================
// üìã ENUMS - SPORT & POSITION (Full 12-Sport Support)
// =============================================================================

enum Sport {
  FOOTBALL
  NETBALL
  RUGBY
  CRICKET
  AMERICAN_FOOTBALL
  BASKETBALL
  HOCKEY
  LACROSSE
  AUSTRALIAN_RULES
  GAELIC_FOOTBALL
  FUTSAL
  BEACH_FOOTBALL
}

enum Position {
  // Football / Soccer / Futsal / Beach Football
  GOALKEEPER
  LEFT_BACK
  CENTER_BACK
  RIGHT_BACK
  LEFT_WING_BACK
  RIGHT_WING_BACK
  DEFENSIVE_MIDFIELDER
  CENTRAL_MIDFIELDER
  LEFT_MIDFIELDER
  RIGHT_MIDFIELDER
  ATTACKING_MIDFIELDER
  LEFT_WINGER
  RIGHT_WINGER
  STRIKER
  CENTER_FORWARD
  SECOND_STRIKER

  // Netball
  GOALKEEPER_NETBALL
  GOAL_ATTACK
  WING_ATTACK
  CENTER
  WING_DEFENSE
  GOAL_DEFENSE
  GOAL_SHOOTER

  // Rugby Union
  PROP
  HOOKER
  LOCK
  FLANKER
  NUMBER_8
  SCRUM_HALF
  FLY_HALF
  INSIDE_CENTER
  OUTSIDE_CENTER
  FULLBACK

  // Rugby League (additional)
  HOOKER_LEAGUE
  PROP_LEAGUE
  SECOND_ROW
  LOOSE_FORWARD

  // American Football
  QUARTERBACK
  RUNNING_BACK
  WIDE_RECEIVER
  TIGHT_END
  LEFT_TACKLE
  LEFT_GUARD
  CENTER_POSITION
  RIGHT_GUARD
  RIGHT_TACKLE
  LINEBACKER
  DEFENSIVE_END
  DEFENSIVE_TACKLE
  SAFETY
  CORNERBACK
  PUNTER
  KICKER

  // Basketball
  POINT_GUARD
  SHOOTING_GUARD
  SMALL_FORWARD
  POWER_FORWARD
  CENTER_BASKETBALL

  // Cricket
  BATSMAN
  BOWLER
  ALL_ROUNDER
  FIELDER
  WICKET_KEEPER

  // Hockey / Lacrosse
  GOALTENDER
  DEFENSEMAN
  WINGER
  CENTER_HOCKEY

  // Australian Rules Football (AFL)
  FULL_FORWARD
  HALF_FORWARD
  FULL_BACK_AFL
  HALF_BACK_AFL
  RUCK
  RUCK_ROVER
  ROVER

  // General
  UTILITY
  SUBSTITUTE
}

enum PreferredFoot {
  LEFT
  RIGHT
  BOTH
}

enum FormationType {
  // Football / Soccer
  FOUR_FOUR_TWO
  FOUR_THREE_THREE
  THREE_FIVE_TWO
  FIVE_THREE_TWO
  FIVE_FOUR_ONE
  THREE_FOUR_THREE
  FOUR_TWO_THREE_ONE
  FOUR_ONE_FOUR_ONE
  THREE_THREE_FOUR
  FIVE_TWO_THREE
  TWO_THREE_FIVE
  FOUR_ONE_TWO_THREE
  FOUR_FOUR_ONE_ONE
  FOUR_THREE_TWO_ONE
  FOUR_FIVE_ONE

  // Futsal / Small-Sided
  ONE_THREE_ONE
  TWO_THREE
  TWO_ONE_TWO
  THREE_TWO
  ONE_TWO_TWO

  // American Football
  I_FORMATION
  SHOTGUN
  PISTOL
  SPREAD
  SINGLE_BACK
  PRO_SET
  WILDCAT

  // Netball
  PODS
  DIAMOND
  FLAT_LINE

  // Custom
  CUSTOM
}

// =============================================================================
// üìã ENUMS - MATCH & COMPETITION
// =============================================================================

enum MatchType {
  LEAGUE
  CUP
  FRIENDLY
  PLAYOFF
  TOURNAMENT
  QUALIFIER
  FINAL
  SEMI_FINAL
  QUARTER_FINAL
  GROUP_STAGE
  TRAINING_MATCH
  PRACTICE
  EXHIBITION
}

enum MatchStatus {
  SCHEDULED
  WARMUP
  LIVE
  HALFTIME
  SECOND_HALF
  EXTRA_TIME_FIRST
  EXTRA_TIME_SECOND
  PENALTIES
  FINISHED
  CANCELLED
  POSTPONED
  ABANDONED
  REPLAY_SCHEDULED
  VOIDED
  DELAYED
  SUSPENDED
}

enum CompetitionType {
  LEAGUE
  CUP
  TOURNAMENT
  FRIENDLY_SERIES
  SUPER_CUP
  PLAYOFF
  QUALIFIER
  CHAMPIONSHIP
  INVITATIONAL
}

enum CompetitionStage {
  GROUP_STAGE
  ROUND_OF_32
  ROUND_OF_16
  QUARTER_FINAL
  SEMI_FINAL
  THIRD_PLACE
  FINAL
  PRELIMINARY
  FIRST_ROUND
  SECOND_ROUND
  PLAYOFF_ROUND
}

enum LeagueFormat {
  ROUND_ROBIN
  DOUBLE_ROUND_ROBIN
  KNOCKOUT
  GROUP_KNOCKOUT
  ROUND_ROBIN_WITH_PLAYOFFS
  SWISS_SYSTEM
  LADDER_SYSTEM
  HOME_AND_AWAY
  CUSTOM
}

enum LeagueVisibility {
  PUBLIC
  PRIVATE
  UNLISTED
  INVITE_ONLY
  FRIENDS_ONLY
}

enum ResultApprovalStatus {
  PENDING
  APPROVED
  REJECTED
  DISPUTED
  REQUIRES_REVISION
  UNDER_REVIEW
  AUTO_APPROVED
}

enum MatchAttendanceStatus {
  AVAILABLE
  UNAVAILABLE
  CONFIRMED
  MAYBE
  LATE
  NO_SHOW
  EXCUSED_ABSENCE
  INJURED
  ILL
  SUSPENDED
  NOT_SELECTED
  SUBSTITUTE
  STARTING_LINEUP
  ATTENDED
  UNUSED_SUB
  UNUSED_SQUAD
  INTERNATIONAL_DUTY
  LOAN
}

enum MatchEventType {
  // Universal Events
  GOAL
  ASSIST
  YELLOW_CARD
  SECOND_YELLOW
  RED_CARD
  SUBSTITUTION_ON
  SUBSTITUTION_OFF
  INJURY
  INJURY_TIME
  FULLTIME
  HALFTIME
  KICKOFF
  PENALTY_SCORED
  PENALTY_MISSED
  PENALTY_SAVED
  OWN_GOAL
  VAR_REVIEW
  VAR_DECISION
  OFFSIDE
  FOUL
  FREE_KICK
  CORNER
  THROW_IN
  GOAL_KICK
  CHALLENGE_REVIEW
  TIMEOUT
  INTERCEPT
  REBOUND
  CAPTAIN_CHANGE
  WEATHER_DELAY
  FLOODLIGHT_FAILURE
  PERIOD_START
  PERIOD_END
  OVERTIME_START
  SHOOTOUT_START

  // Netball-Specific
  CENTER_PASS
  OBSTRUCTION
  CONTACT
  HELD_BALL
  STEPPING
  OVER_THIRD

  // Rugby-Specific
  TRY
  CONVERSION
  PENALTY_GOAL
  DROP_GOAL
  SCRUM
  LINEOUT
  MAUL
  RUCK
  KNOCK_ON
  HIGH_TACKLE
  SIN_BIN
  YELLOW_CARD_RUGBY
  RED_CARD_RUGBY

  // Cricket-Specific
  WICKET
  BOUNDARY
  SIX
  MAIDEN_OVER
  WIDE
  NO_BALL
  BYE
  LEG_BYE
  OVERTHROW
  RUN_OUT
  CAUGHT
  BOWLED
  LBW
  STUMPED

  // Basketball-Specific
  THREE_POINTER
  TWO_POINTER
  FREE_THROW_MADE
  FREE_THROW_MISSED
  FAST_BREAK
  TURNOVER
  OFFENSIVE_FOUL
  DEFENSIVE_FOUL
  TRAVEL
  DOUBLE_DRIBBLE
  BLOCK
  STEAL
  DUNK
  ALLEY_OOP

  // American Football-Specific
  TOUCHDOWN
  FIELD_GOAL
  SAFETY_SCORE
  INTERCEPTION
  FUMBLE
  SACK
  TWO_POINT_CONVERSION
  EXTRA_POINT
  PUNT
  KICKOFF_RETURN
  FAIR_CATCH

  // Hockey-Specific
  HAT_TRICK
  MAJOR_PENALTY
  MINOR_PENALTY
  FIGHT
  POWER_PLAY_GOAL
  SHORTHANDED_GOAL
  EMPTY_NET_GOAL

  // Australian Rules-Specific
  BEHIND
  RUSHED_BEHIND
  MARK
  HANDBALL
  BOUNCE
}

// =============================================================================
// üìã ENUMS - CLUB, TRAINING, MEDIA, BILLING
// =============================================================================

enum ClubMemberRole {
  OWNER
  MANAGER
  HEAD_COACH
  ASSISTANT_COACH
  PLAYER
  STAFF
  TREASURER
  SCOUT
  ANALYST
  MEDICAL_STAFF
  PHYSIOTHERAPIST
  NUTRITIONIST
  PSYCHOLOGIST
  PERFORMANCE_COACH
  GOALKEEPING_COACH
  KIT_MANAGER
  MEDIA_OFFICER
  VIDEO_ANALYST
}

enum TeamType {
  PROFESSIONAL
  SEMI_PROFESSIONAL
  AMATEUR
  ACADEMY
  YOUTH
  RECREATIONAL
  UNIVERSITY
  SCHOOL
}

enum TeamStatus {
  ACTIVE
  INACTIVE
  SUSPENDED
  ARCHIVED
  DISSOLVED
}

enum TrainingIntensity {
  RECOVERY
  LOW
  MEDIUM
  HIGH
  MAXIMUM
  COMPETITIVE
}

enum TrainingCategory {
  PASSING
  SHOOTING
  DEFENDING
  POSSESSION
  SET_PIECES
  DRIBBLING
  CONDITIONING
  STRENGTH_POWER
  SPEED_AGILITY
  FLEXIBILITY
  BALANCE_COORDINATION
  ENDURANCE
  TACTICAL
  FORMATION_WORK
  GAME_STRATEGY
  TRANSITIONS
  RECOVERY
  MENTAL_PREPARATION
  VIDEO_ANALYSIS
  TEAM_BUILDING
  GOALKEEPER_SPECIFIC
  POSITION_SPECIFIC
  SPORT_SPECIFIC
  WARM_UP
  COOL_DOWN
  SCRIMMAGE
  MATCH_SIMULATION
  INDIVIDUAL_TRAINING
  GROUP_TRAINING
}

enum TrainingStatus {
  DRAFT
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELLED
  POSTPONED
}

enum AttendanceStatus {
  PRESENT
  ABSENT
  EXCUSED
  LATE
  LEFT_EARLY
  PARTIAL
  INJURED
  SICK
  SUSPENDED
}

enum MediaType {
  VIDEO
  IMAGE
  DOCUMENT
  AUDIO
}

enum MediaCategory {
  MATCH_HIGHLIGHT
  MATCH_FULL
  MATCH_ANALYSIS
  GOAL_CLIP
  SAVE_CLIP
  INCIDENT_CLIP
  TRAINING_SESSION
  TRAINING_DRILL
  TRAINING_EXERCISE
  TRAINING_ANALYSIS
  PLAYER_HIGHLIGHT
  PLAYER_INTERVIEW
  PLAYER_PROFILE
  TEAM_PROMO
  TEAM_ANNOUNCEMENT
  PRESS_CONFERENCE
  TACTICS_DOCUMENT
  MEDICAL_DOCUMENT
  CONTRACT_DOCUMENT
  REPORT
  THUMBNAIL
  PROFILE_PHOTO
  BANNER
  LOGO
  OTHER
}

enum MediaVisibility {
  PUBLIC
  CLUB_ONLY
  TEAM_ONLY
  STAFF_ONLY
  PRIVATE
  FOLLOWERS_ONLY  // NEW v7.10.1: Only followers can view
  UNLISTED        // NEW v7.10.1: Only with direct link
}

enum MediaProcessingStatus {
  PENDING
  UPLOADING
  PROCESSING
  TRANSCODING
  COMPLETED
  FAILED
  CANCELLED
}

enum VideoQuality {
  Q_360P
  Q_480P
  Q_720P
  Q_1080P
  Q_2K
  Q_4K
  ORIGINAL
}

enum TranscodingStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  FAILED
  CANCELLED
  QUEUED
}

enum VideoProcessingProvider {
  MUX
  AWS_MEDIACONVERT
  BUNNY_CDN
  CLOUDINARY
  INTERNAL
  VERCEL_BLOB
}

enum SocialPlatform {
  INSTAGRAM
  TWITTER
  FACEBOOK
  YOUTUBE
  TIKTOK
  LINKEDIN
}

enum FitnessAssessmentType {
  PRE_SEASON
  MID_SEASON
  POST_SEASON
  RETURN_TO_PLAY
  INJURY_FOLLOW_UP
  ROUTINE
  TRANSFER_MEDICAL
  INITIAL_REGISTRATION
}

enum FitnessStatus {
  FIT
  FIT_WITH_CAUTION
  LIMITED
  NOT_FIT
  PENDING_REVIEW
  CLEARED
}

enum InjurySeverity {
  MINOR
  MODERATE
  SEVERE
  CRITICAL
  CAREER_THREATENING
}

enum InjuryStatus {
  ACTIVE
  RECOVERING
  REHABILITATION
  CLEARED
  CHRONIC
}

enum TimesheetStatus {
  DRAFT
  SUBMITTED
  UNDER_REVIEW
  APPROVED
  REJECTED
  PAID
  DISPUTED
  ARCHIVED
}

enum JoinRequestStatus {
  PENDING
  APPROVED
  REJECTED
  CANCELLED
  EXPIRED
  WITHDRAWN
}

enum JobPostingStatus {
  DRAFT
  OPEN
  PAUSED
  CLOSED
  FILLED
  CANCELLED
  EXPIRED
}

enum JobApplicationStatus {
  PENDING
  REVIEWING
  SHORTLISTED
  INTERVIEW_SCHEDULED
  INTERVIEW_COMPLETED
  OFFERED
  ACCEPTED
  REJECTED
  WITHDRAWN
  HIRED
}

enum EmploymentType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  INTERNSHIP
  VOLUNTEER
  FREELANCE
  SEASONAL
}

enum JobCategory {
  COACHING
  MANAGEMENT
  MEDICAL
  ANALYSIS
  SCOUTING
  ADMINISTRATION
  MEDIA
  OPERATIONS
  FINANCE
  YOUTH_DEVELOPMENT
  PERFORMANCE
  OTHER
}

enum ExperienceLevel {
  ENTRY
  JUNIOR
  MID
  SENIOR
  LEAD
  DIRECTOR
  EXECUTIVE
}

enum TransferType {
  PERMANENT
  LOAN
  FREE_TRANSFER
  YOUTH_DEVELOPMENT
  TRIAL
  EXCHANGE
}

enum TransferStatus {
  PENDING
  NEGOTIATING
  AGREED
  COMPLETED
  CANCELLED
  REJECTED
  EXPIRED
}

enum FacilityType {
  STADIUM
  TRAINING_GROUND
  INDOOR_ARENA
  GYM
  SWIMMING_POOL
  MEDICAL_CENTER
  MEETING_ROOM
  OFFICE
  CHANGING_ROOM
  HOSPITALITY
  OUTDOOR_PITCH
  INDOOR_PITCH
  MULTI_PURPOSE
}

enum VenueType {
  STADIUM
  ARENA
  SPORTS_COMPLEX
  SCHOOL_GROUND
  PARK
  COMMUNITY_CENTER
  UNIVERSITY
  PRIVATE_FACILITY
  NEUTRAL_VENUE
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
  NO_SHOW
}

enum SubscriptionStatus {
  ACTIVE
  CANCELLED
  EXPIRED
  PAUSED
  PAST_DUE
  TRIAL
  SUSPENDED
  DOWNGRADED
  PENDING_UPGRADE
  PENDING_CANCELLATION
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
  PARTIALLY_REFUNDED
  DISPUTED
  CANCELLED
  PROCESSING
  CHARGEBACK
}

enum PaymentType {
  SUBSCRIPTION
  COACHING_FEE
  MATCH_FEE
  TOURNAMENT_FEE
  TRAINING_FEE
  FACILITY_RENTAL
  EQUIPMENT
  REFUND
  BONUS
  SALARY
  COMMISSION
  TRANSFER_FEE
  LOAN_FEE
  SPONSORSHIP
  REFEREE_FEE
  REFEREE_EXPENSES
  MEMBERSHIP_FEE
  PLAYER_FEE
  CLUB_FEE
  LEAGUE_FEE
  EXPENSE_REIMBURSEMENT
  BUDGET_ALLOCATION
  INSTALLMENT
  SCHOLARSHIP_DISBURSEMENT
  ACHIEVEMENT_REWARD
  XP_PURCHASE
  OTHER
}

enum ChatType {
  DIRECT
  GROUP
  TEAM
  CLUB
  ANNOUNCEMENT
}

enum MatchOfficialRole {
  REFEREE
  ASSISTANT_REFEREE_1
  ASSISTANT_REFEREE_2
  FOURTH_OFFICIAL
  VAR_OFFICIAL
  AVAR_OFFICIAL
  RESERVE_ASSISTANT
  MATCH_COMMISSIONER
  REFEREE_ASSESSOR
}

enum AnnouncementPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

enum AnnouncementStatus {
  DRAFT
  SCHEDULED
  PUBLISHED
  ARCHIVED
}

enum GoalType {
  PERFORMANCE
  DEVELOPMENT
  FITNESS
  BEHAVIORAL
  TEAM
}

enum GoalStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
  EXCEEDED
  MISSED
  CANCELLED
}

enum InvitationStatus {
  PENDING
  ACCEPTED
  REJECTED
  EXPIRED
  CANCELLED
  REVOKED
}

// =============================================================================
// üìã ENUMS - WEBHOOK EVENTS (ENHANCED v7.10.1)
// =============================================================================

enum WebhookEvent {
  // Match Events
  MATCH_CREATED
  MATCH_STARTED
  MATCH_FINISHED
  MATCH_CANCELLED
  MATCH_LINEUP_SET

  // Player Events
  PLAYER_ADDED
  PLAYER_UPDATED
  PLAYER_INJURED
  PLAYER_TRANSFERRED
  PLAYER_CLEARED

  // Team & Competition
  TEAM_UPDATED
  TEAM_CREATED
  COMPETITION_CREATED
  COMPETITION_STARTED
  COMPETITION_FINISHED

  // Billing
  SUBSCRIPTION_UPDATED
  PAYMENT_RECEIVED

  // User
  USER_CREATED
  USER_DELETED

  // Fitness & Medical
  FITNESS_ASSESSMENT_COMPLETED
  PLAYER_RTP_CLEARED

  // Predictions
  PREDICTION_CREATED
  PREDICTION_VERIFIED
  HIGH_RISK_PREDICTION

  // Scouting
  SCOUTING_REPORT_SUBMITTED
  WATCHLIST_ALERT

  // Referee
  REFEREE_ASSIGNED
  REFEREE_REPORT_SUBMITTED

  // Training & Drills
  TRAINING_SCHEDULED
  TRAINING_COMPLETED
  DRILL_CREATED
  DRILL_LIBRARY_UPDATED

  // Budget & Expense
  BUDGET_CREATED
  BUDGET_ALERT
  BUDGET_THRESHOLD_REACHED
  EXPENSE_SUBMITTED
  EXPENSE_APPROVED
  EXPENSE_REJECTED

  // Coach Management
  COACH_ASSIGNED
  COACH_UNASSIGNED
  COACH_CERTIFICATION_EXPIRING
  TIMESHEET_SUBMITTED
  TIMESHEET_APPROVED
  TIMESHEET_REJECTED

  // Export & Reports
  EXPORT_COMPLETED
  REPORT_GENERATED

  // Player Development
  DEVELOPMENT_MILESTONE_COMPLETED
  SKILL_ASSESSMENT_COMPLETED

  // Wellness
  WELLNESS_ALERT
  RECOVERY_PHASE_CHANGED
  PLAYER_CLEARED_TO_PLAY_WELLNESS

  // Payments
  PAYMENT_DUE
  PAYMENT_OVERDUE
  PAYMENT_RECEIVED_INSTALLMENT

  // Gamification (Existing)
  CHALLENGE_STARTED
  CHALLENGE_ENDED
  LEADERBOARD_POSITION_CHANGED
  STREAK_MILESTONE
  SEASON_AWARD_ANNOUNCED

  // Achievement System Webhooks (v7.10.0)
  ACHIEVEMENT_UNLOCKED
  ACHIEVEMENT_PROGRESS_UPDATE
  ACHIEVEMENT_TIER_COMPLETED
  MILESTONE_ACHIEVED
  PLAYER_LEVEL_UP
  XP_AWARDED
  PRESTIGE_LEVEL_REACHED
  STREAK_RECORD_BROKEN
  STREAK_LOST_NOTIFICATION

  // =========================================================================
  // üé¨ VIDEO ANALYTICS WEBHOOKS (NEW v7.10.1)
  // =========================================================================
  VIDEO_UPLOADED
  VIDEO_PROCESSING_STARTED
  VIDEO_PROCESSING_COMPLETED
  VIDEO_PROCESSING_FAILED
  VIDEO_COMMENT_POSTED
  VIDEO_ENGAGEMENT_MILESTONE
  VIDEO_TRENDING
  VIDEO_ANALYTICS_READY
  VIDEO_QUALITY_READY
  VIDEO_THUMBNAIL_GENERATED

  // Other
  RESULT_APPROVED
  ANNOUNCEMENT_POSTED
  JOB_POSTED
  JOB_APPLICATION_RECEIVED
  JOIN_REQUEST_RECEIVED
  MEDIA_UPLOADED
  MEDIA_PROCESSED
}

// =============================================================================
// üéñ ACHIEVEMENT SYSTEM ENUMS (v7.10.0)
// =============================================================================

enum AchievementCategory {
  // Performance Categories
  GOALS
  ASSISTS
  DEFENSE
  GOALKEEPER

  // Participation Categories
  MATCHES
  TRAINING
  SEASONS

  // Team Categories
  CAPTAIN
  TEAM_PLAYER
  LOYALTY

  // Development Categories
  IMPROVEMENT
  CONSISTENCY
  VERSATILITY

  // Special Categories
  DEBUT
  RECORD
  AWARD
  SOCIAL
  SPORT_SPECIFIC
}

enum AchievementRarity {
  COMMON
  UNCOMMON
  RARE
  EPIC
  LEGENDARY
}

enum AchievementCriteriaType {
  TOTAL_COUNT
  SEASON_COUNT
  MATCH_COUNT
  STREAK_COUNT
  RATING_THRESHOLD
  PERCENTAGE
  FIRST_TIME
  PERFECT
  UNIQUE
}

enum MilestoneType {
  // Match Milestones
  MATCHES_PLAYED
  MATCHES_WON
  MATCHES_STARTED
  MINUTES_PLAYED

  // Scoring Milestones
  GOALS_SCORED
  ASSISTS_MADE
  CLEAN_SHEETS
  SAVES_MADE

  // Career Milestones
  DEBUT
  FIRST_GOAL
  FIRST_ASSIST
  FIRST_CLEAN_SHEET
  CAPTAIN_DEBUT

  // Club Milestones
  CLUB_JOINED
  CLUB_LOYALTY
  TEAM_JOINED

  // Award Milestones
  PLAYER_OF_MATCH
  PLAYER_OF_MONTH
  PLAYER_OF_SEASON
  GOLDEN_BOOT
  GOLDEN_GLOVE

  // Sport-Specific: Football
  HAT_TRICK
  BRACE
  POKER

  // Sport-Specific: Basketball
  DOUBLE_DOUBLE
  TRIPLE_DOUBLE
  QUADRUPLE_DOUBLE
  THREE_POINTER_MILESTONE
  FREE_THROW_STREAK

  // Sport-Specific: Cricket
  CENTURY
  HALF_CENTURY
  DOUBLE_CENTURY
  FIVE_WICKETS
  TEN_WICKETS
  BOWLING_ECONOMY

  // Sport-Specific: Rugby
  TRY_SCORING
  CONVERSION_STREAK
  PENALTY_KICKS
  DROP_GOAL_MASTER

  // Sport-Specific: American Football
  TOUCHDOWN_RECORD
  PASSING_YARDS
  RUSHING_YARDS
  RECEIVING_YARDS
  SACK_MILESTONE
  INTERCEPTION_MILESTONE

  // Sport-Specific: Hockey
  SHUTOUT
  HAT_TRICK_HOCKEY
  PENALTY_MINUTES
  PLUS_MINUS

  // Sport-Specific: Tennis/Volleyball
  ACE_MILESTONE
  DOUBLE_FAULT_FREE
  SET_STREAK

  // Sport-Specific: Baseball
  HOME_RUN_MILESTONE
  RBI_MILESTONE
  BATTING_AVERAGE
  ERA_MILESTONE
  STRIKEOUT_MILESTONE
  NO_HITTER
  PERFECT_GAME

  // Sport-Specific: Other
  SERVE_SPEED_RECORD
  SPRINT_RECORD
  DISTANCE_COVERED
}

// =============================================================================
// üé¨ VIDEO ANALYTICS ENUMS (NEW v7.10.1)
// =============================================================================

enum CommentStatus {
  PENDING     // Awaiting moderation
  PUBLISHED   // Visible to all
  HIDDEN      // Hidden by moderator
  FLAGGED     // Flagged for review
  REMOVED     // Removed (violation)
  DELETED     // Deleted by user
}

// =============================================================================
// üîê SYSTEM SETTINGS MODEL (v7.9.0)
// =============================================================================

model SystemSetting {
  id            String           @id @default(cuid())
  key           String           @unique
  category      SettingCategory  @default(GENERAL)
  value         Json
  valueType     SettingValueType @default(STRING)
  description   String?
  isPublic      Boolean          @default(false)
  isEditable    Boolean          @default(true)

  // Audit trail
  updatedBy     String?
  updatedByUser User?            @relation("settingUpdatedBy", fields: [updatedBy], references: [id], onDelete: SetNull)

  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt

  @@index([category])
  @@index([isPublic])
  @@index([updatedBy])
  @@map("system_settings")
}

// =============================================================================
// üè¢ ORGANISATION MODELS
// =============================================================================

model Organisation {
  id                     String              @id @default(cuid())
  slug                   String              @unique @db.VarChar(63)
  name                   String
  description            String?             @db.Text
  logo                   String?
  banner                 String?
  website                String?
  email                  String
  phone                  String?
  country                String
  timezone               String              @default("Europe/London")
  tier                   OrganisationTier    @default(STARTER)
  monthlyBudget          Float?
  currency               String              @default("GBP")
  registrationNumber     String?             @unique
  taxId                  String?             @unique
  complianceStatus       String              @default("PENDING")
  gdprCompliant          Boolean             @default(false)
  dataProcessingAgreement DateTime?
  totalUsers             Int                 @default(0)
  totalTeams             Int                 @default(0)
  totalMatches           Int                 @default(0)
  storageUsedMb          Int                 @default(0)
  enabledFeatures        String[]            @default([])
  customFeatures         Json?
  maxUsers               Int                 @default(100)
  maxTeams               Int                 @default(10)
  maxStorageMb           Int                 @default(5120)
  maxApiCallsPerMonth    Int                 @default(10000)
  maxConcurrentUsers     Int                 @default(50)
  subscriptionId         String?             @unique
  billingEmail           String?
  billingCycle           String              @default("MONTHLY")
  nextBillingDate        DateTime?
  lastActivityAt         DateTime?
  isActive               Boolean             @default(true)
  isArchived             Boolean             @default(false)
  archivedAt             DateTime?
  deletedAt              DateTime?
  deletedBy              String?
  createdAt              DateTime            @default(now())
  updatedAt              DateTime            @updatedAt

  owner                  User                @relation("organisationOwner", fields: [ownerId], references: [id])
  ownerId                String

  members                OrganisationMember[]
  invitations            OrganisationInvitation[]
  clubs                  Club[]
  apiKeys                ApiKey[]
  webhooks               Webhook[]
  auditLogs              AuditLog[]
  backups                DatabaseBackup[]
  subscriptions          Subscription[]
  dataExportRequests     DataExportRequest[]
  dataDeletionRequests   DataDeletionRequest[]
  apiUsageMetrics        ApiUsageMetrics[]
  quotaUsage             QuotaUsage[]
  seasons                Season[]
  facilities             Facility[]
  venues                 Venue[]             @relation("organisationVenues")
  sponsors               Sponsor[]
  mediaAssets            MediaAsset[]
  mediaContent           MediaContent[]
  competitions           Competition[]
  budgets                Budget[]
  exportRequests         ExportRequest[]     @relation("orgExports")
  exportTemplates        ExportTemplate[]    @relation("orgExportTemplates")
  reportSchedules        ReportSchedule[]    @relation("orgReportSchedules")

  @@index([slug])
  @@index([ownerId])
  @@index([tier])
  @@index([isActive])
  @@index([createdAt])
  @@index([country])
  @@index([deletedAt])
  @@map("organisations")
}

model OrganisationMember {
  id                String           @id @default(cuid())
  organisationId    String
  userId            String
  roleId            String?
  role              OrganisationRole @default(MEMBER)
  customPermissions String[]
  joinedAt          DateTime         @default(now())
  invitedBy         String?
  invitedAt         DateTime?
  lastAccessAt      DateTime?
  lastAccessIp      String?
  removedAt         DateTime?
  removedBy         String?

  organisation      Organisation     @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  user              User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  customRole        Role?            @relation("roleMembers", fields: [roleId], references: [id], onDelete: SetNull)

  @@unique([organisationId, userId])
  @@index([organisationId])
  @@index([userId])
  @@index([roleId])
  @@index([role])
  @@index([joinedAt])
  @@map("organisation_members")
}

model OrganisationInvitation {
  id             String           @id @default(cuid())
  organisationId String
  email          String
  role           OrganisationRole @default(MEMBER)
  invitedBy      String
  invitedAt      DateTime         @default(now())
  expiresAt      DateTime
  acceptedAt     DateTime?
  acceptedBy     String?
  status         InvitationStatus @default(PENDING)
  token          String           @unique @default(cuid())

  organisation   Organisation     @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@unique([organisationId, email])
  @@index([organisationId])
  @@index([status])
  @@index([token])
  @@index([expiresAt])
  @@map("organisation_invitations")
}

model Season {
  id              String       @id @default(cuid())
  organisationId  String
  name            String
  startDate       DateTime
  endDate         DateTime
  isActive        Boolean      @default(false)
  isCurrent       Boolean      @default(false)
  description     String?
  deletedAt       DateTime?
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt

  organisation    Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  competitions    Competition[]
  transfers       Transfer[]
  budgets         Budget[]
  coachAssignments CoachAssignment[] @relation("seasonCoachAssignments")
  scholarships    Scholarship[] @relation("seasonScholarships")
  teamChemistry   TeamChemistry[] @relation("seasonChemistry")
  leaderboards    Leaderboard[] @relation("seasonLeaderboards")
  seasonAwards    SeasonAward[] @relation("seasonAwards")
  playerMilestones PlayerMilestone[] @relation("seasonMilestones")

  @@unique([organisationId, name])
  @@index([organisationId])
  @@index([isActive])
  @@index([isCurrent])
  @@index([deletedAt])
  @@map("seasons")
}

// =============================================================================
// üë§ USER & AUTHENTICATION MODELS (ENHANCED v7.10.1)
// =============================================================================

model User {
  id                        String            @id @default(cuid())
  email                     String            @unique @db.Citext
  emailVerified             DateTime?
  phone                     String?           @unique
  phoneVerified             DateTime?
  firstName                 String
  lastName                  String
  middleName                String?
  displayName               String?
  avatar                    String?
  banner                    String?
  bio                       String?           @db.Text
  dateOfBirth               DateTime?
  nationality               String?
  language                  String            @default("en-GB")
  timezone                  String            @default("Europe/London")
  userType                  UserType          @default(INDIVIDUAL)
  accountTier               AccountTier       @default(FREE)
  roles                     UserRole[]        @default([PLAYER])
  status                    UserStatus        @default(PENDING_EMAIL_VERIFICATION)
  isSuperAdmin              Boolean           @default(false)
  primaryOrganisationId     String?
  clubId                    String?
  teamId                    String?
  password                  String?
  passwordChangedAt         DateTime?
  passwordResetToken        String?           @unique
  passwordResetExpiry       DateTime?
  failedLoginAttempts       Int               @default(0)
  lastFailedLoginAt         DateTime?
  lastLoginAt               DateTime?
  lastLoginIp               String?
  loginAttempts             Int               @default(0)
  lockoutUntil              DateTime?
  twoFactorEnabled          Boolean           @default(false)
  twoFactorSecret           String?           @unique
  twoFactorBackupCodes      String[]
  fcmTokens                 String[]          @default([])
  emailNotificationsEnabled Boolean           @default(true)
  pushNotificationsEnabled  Boolean           @default(true)
  smsNotificationsEnabled   Boolean           @default(false)
  marketingEmailsEnabled    Boolean           @default(false)
  privacyLevel              String            @default("FRIENDS_ONLY")
  showOnlineStatus          Boolean           @default(true)
  profileVisibility         String            @default("PUBLIC")
  isProfilePublic           Boolean           @default(true)
  gdprConsent               Boolean           @default(false)
  gdprConsentDate           DateTime?
  dataProcessingConsent     Boolean           @default(false)
  marketingConsent          Boolean           @default(false)
  cookieConsent             Boolean           @default(false)
  termsAcceptedAt           DateTime?
  privacyPolicyAcceptedAt   DateTime?
  followersCount            Int               @default(0)
  followingCount            Int               @default(0)

  // Soft delete support (v7.9.0)
  deletedAt                 DateTime?
  deletedBy                 String?
  suspendedAt               DateTime?
  suspendedReason           String?

  createdAt                 DateTime          @default(now())
  updatedAt                 DateTime          @updatedAt

  // Relations
  organisationMemberships   OrganisationMember[]
  organisationsOwned        Organisation[]    @relation("organisationOwner")
  accounts                  Account[]
  sessions                  Session[]
  refreshTokens             RefreshToken[]
  twoFactorAuth             TwoFactorAuth?
  apiKeys                   ApiKey[]
  player                    Player?
  coach                     Coach?
  referee                   Referee?
  scout                     Scout?
  analyst                   Analyst?
  clubManager               ClubManager?
  clubOwner                 ClubOwner?
  parent                    Parent?
  treasurer                 Treasurer?
  clubMemberships           ClubMember[]
  managedClubs              Club[]            @relation("clubManager")
  ownedClubs                Club[]            @relation("clubOwner")
  notifications             Notification[]
  notificationPrefs         NotificationPreference?
  messages                  Message[]
  chatMembers               ChatMember[]
  chatsCreated              Chat[]            @relation("chatCreator")
  socialActions             SocialAction[]
  followers                 Follow[]          @relation("follower")
  following                 Follow[]          @relation("following")
  blocks                    UserBlock[]       @relation("blocker")
  blockedBy                 UserBlock[]       @relation("blocked")
  achievements              Achievement[]     @relation("achievementUser")
  badges                    Badge[]           @relation("badgeUser")
  subscriptions             Subscription[]
  payments                  Payment[]
  invoices                  Invoice[]
  auditLogsCreated          AuditLog[]        @relation("auditLogUser")
  announcementsCreated      Announcement[]    @relation("announcementCreator")
  performanceGoals          PerformanceGoal[] @relation("goalUser")
  goalsCreated              PerformanceGoal[] @relation("goalCreator")
  jobApplications           JobApplication[]  @relation("applicant")
  reviewedApplications      JobApplication[]  @relation("applicationReviewer")
  jobPostingsCreated        JobPosting[]      @relation("jobCreator")
  mediaUploaded             MediaContent[]    @relation("mediaUploader")
  matchesCreated            Match[]           @relation("matchCreator")
  competitionsCreated       Competition[]     @relation("competitionCreator")
  fitnessAssessmentsCreated FitnessAssessment[] @relation("fitnessAssessor")
  drillsCreated             TrainingDrill[]   @relation("drillsCreated")
  budgetsCreated            Budget[]          @relation("budgetsCreated")
  expensesCreated           Expense[]         @relation("expensesCreated")
  expensesApproved          Expense[]         @relation("expensesApproved")
  exportRequests            ExportRequest[]   @relation("userExports")
  exportTemplates           ExportTemplate[]  @relation("userExportTemplates")
  reportSchedules           ReportSchedule[]  @relation("userReportSchedules")
  paymentPlans              PaymentPlan[]     @relation("userPaymentPlans")
  eventRSVPs                EventRSVP[]       @relation("userRSVPs")
  challengeParticipations   ChallengeParticipant[] @relation("userChallenges")
  teamAnnouncementsCreated  TeamAnnouncement[] @relation("userTeamAnnouncements")
  settingsUpdated           SystemSetting[]   @relation("settingUpdatedBy")

  // =========================================================================
  // üé¨ VIDEO ANALYTICS RELATIONS (NEW v7.10.1)
  // =========================================================================
  mediaViews                MediaViewLog[]    @relation("userMediaViews")
  mediaInteractions         MediaInteraction[] @relation("userMediaInteractions")
  mediaComments             MediaComment[]    @relation("userMediaComments")
  commentLikes              MediaCommentLike[] @relation("userCommentLikes")
  watchHistory              WatchHistory[]    @relation("userWatchHistory")
  bookmarkFolders           BookmarkFolder[]  @relation("userBookmarkFolders")

  @@index([email])
  @@index([phone])
  @@index([status])
  @@index([clubId])
  @@index([teamId])
  @@index([failedLoginAttempts])
  @@index([primaryOrganisationId])
  @@index([createdAt])
  @@index([lastName, firstName])
  @@index([isSuperAdmin])
  @@index([passwordResetToken])
  @@index([twoFactorEnabled])
  @@index([deletedAt])
  @@index([isProfilePublic])
  @@map("users")
}

// =============================================================================
// üîê ENHANCED TWO-FACTOR AUTH MODEL (v7.9.0)
// =============================================================================

model TwoFactorAuth {
  id               String    @id @default(cuid())
  userId           String    @unique
  secret           String
  backupCodes      String[]
  backupCodesUsed  Int       @default(0)
  isEnabled        Boolean   @default(false)
  isVerified       Boolean   @default(false)
  lastUsedAt       DateTime?
  failedAttempts   Int       @default(0)
  lockedUntil      DateTime?
  enabledAt        DateTime?
  disabledAt       DateTime?
  lastIpAddress    String?
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt

  user             User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([isEnabled])
  @@index([lockedUntil])
  @@map("two_factor_auth")
}

model Account {
  id                String   @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?  @db.Text
  access_token      String?  @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?  @db.Text
  session_state     String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  ipAddress    String?
  userAgent    String?
  device       String?
  location     String?
  createdAt    DateTime @default(now())

  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([sessionToken])
  @@index([expires])
  @@map("sessions")
}

model RefreshToken {
  id        String    @id @default(cuid())
  userId    String
  token     String    @unique
  expiresAt DateTime
  revokedAt DateTime?
  usedAt    DateTime?
  ipAddress String?
  userAgent String?
  createdAt DateTime  @default(now())

  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([expiresAt])
  @@index([token])
  @@map("refresh_tokens")
}

model VerificationToken {
  id         String           @id @default(cuid())
  identifier String
  token      String           @unique
  type       VerificationType @default(EMAIL)
  expires    DateTime
  createdAt  DateTime         @default(now())

  @@unique([identifier, token])
  @@index([type])
  @@index([expires])
  @@index([identifier])
  @@map("verification_tokens")
}

model ApiKey {
  id             String        @id @default(cuid())
  userId         String
  organisationId String?
  name           String
  key            String        @unique @db.Char(32)
  secret         String?       @unique
  lastUsed       DateTime?
  expiresAt      DateTime?
  permissions    String[]      @default([])
  rateLimit      Int           @default(1000)
  rateLimitReset Int           @default(3600)
  createdAt      DateTime      @default(now())
  revokedAt      DateTime?

  user           User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  organisation   Organisation? @relation(fields: [organisationId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([key])
  @@index([organisationId])
  @@index([expiresAt])
  @@map("api_keys")
}

model Role {
  id                   String               @id @default(cuid())
  organisationId       String
  name                 String
  slug                 String
  description          String?              @db.Text
  isBuiltIn            Boolean              @default(false)
  isCustom             Boolean              @default(true)
  level                Int                  @default(0)
  permissions          String[]
  customPermissionJson Json?
  memberCount          Int                  @default(0)
  createdAt            DateTime             @default(now())
  updatedAt            DateTime             @updatedAt

  organisationMembers  OrganisationMember[] @relation("roleMembers")

  @@unique([organisationId, slug])
  @@index([organisationId])
  @@index([level])
  @@map("roles")
}

model Permission {
  id          String         @id @default(cuid())
  type        PermissionType @unique
  description String?
  category    String

  @@index([category])
  @@map("permissions")
}

model ResourcePermission {
  id           String   @id @default(cuid())
  resourceType String
  resourceId   String
  userId       String
  permission   String
  grantedAt    DateTime @default(now())
  grantedBy    String
  expiresAt    DateTime?

  @@unique([resourceType, resourceId, userId, permission])
  @@index([userId])
  @@index([resourceType, resourceId])
  @@index([expiresAt])
  @@map("resource_permissions")
}

// =============================================================================
// üìã AUDIT & DATA GOVERNANCE (ENHANCED v7.9.0)
// =============================================================================

model AuditLog {
  id             String          @id @default(cuid())
  organisationId String?
  userId         String?
  targetUserId   String?
  action         AuditActionType
  resourceType   String
  resourceId     String
  beforeState    Json?
  afterState     Json?
  changes        String[]
  details        Json?
  ipAddress      String?
  userAgent      String?
  sessionId      String?
  requestId      String?
  severity       String          @default("INFO")
  isCompliance   Boolean         @default(false)
  requiresReview Boolean         @default(false)
  isLegalHold    Boolean         @default(false)
  legalHoldReason String?
  durationMs     Int?
  createdAt      DateTime        @default(now())

  organisation   Organisation?   @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  user           User?           @relation("auditLogUser", fields: [userId], references: [id], onDelete: SetNull)

  @@index([organisationId])
  @@index([userId])
  @@index([targetUserId])
  @@index([action])
  @@index([resourceType, resourceId])
  @@index([createdAt])
  @@index([severity])
  @@index([isCompliance])
  @@map("audit_logs")
}

model EntityVersion {
  id                  String              @id @default(cuid())
  entityType          String
  entityId            String
  version             Int
  data                Json
  changedBy           String
  changeReason        String?
  changeType          String
  checksum            String?
  retentionPolicy     DataRetentionPolicy @default(STANDARD)
  deletionScheduledAt DateTime?
  deletedAt           DateTime?
  createdAt           DateTime            @default(now())

  @@unique([entityType, entityId, version])
  @@index([entityType, entityId])
  @@index([deletionScheduledAt])
  @@index([retentionPolicy])
  @@map("entity_versions")
}

model ConsentLog {
  id          String    @id @default(cuid())
  userId      String
  type        String
  granted     Boolean
  grantedAt   DateTime
  evidence    Json?
  ipAddress   String?
  userAgent   String?
  withdrawnAt DateTime?

  @@index([userId])
  @@index([type])
  @@index([grantedAt])
  @@map("consent_logs")
}

// =============================================================================
// üìä DATA EXPORT & GDPR MODELS (ENHANCED v7.9.0)
// =============================================================================

model DataExportRequest {
  id              String           @id @default(cuid())
  userId          String
  organisationId  String
  requestedBy     String
  status          DataExportStatus @default(PENDING)
  includeTypes    String[]
  format          String           @default("JSON")
  fileUrl         String?
  fileSize        Int?
  checksum        String?
  encryptionKey   String?
  expiresAt       DateTime?
  requestedAt     DateTime         @default(now())
  startedAt       DateTime?
  processedAt     DateTime?
  completedAt     DateTime?
  downloadedAt    DateTime?
  downloadedBy    String?
  error           String?
  progress        Int              @default(0)

  organisation    Organisation     @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([organisationId])
  @@index([status])
  @@index([expiresAt])
  @@map("data_export_requests")
}

model DataDeletionRequest {
  id                 String       @id @default(cuid())
  userId             String
  organisationId     String
  reason             String?
  requestedAt        DateTime     @default(now())
  status             String       @default("PENDING")
  approvedAt         DateTime?
  completedAt        DateTime?
  verificationToken  String?      @unique
  verificationSentAt DateTime?
  dataCategories     String[]
  retainedData       String[]

  organisation       Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([requestedAt])
  @@map("data_deletion_requests")
}

// =============================================================================
// üì∫ MEDIA MODELS (ENHANCED v7.10.1 - WITH VIDEO ANALYTICS)
// =============================================================================

model MediaContent {
  id                  String                  @id @default(cuid())
  organisationId      String?
  clubId              String?
  uploaderId          String
  title               String
  description         String?                 @db.Text
  type                MediaType
  category            MediaCategory           @default(OTHER)
  url                 String
  thumbnailUrl        String?
  duration            Int?
  fileSize            Int?
  mimeType            String?
  width               Int?
  height              Int?
  processingStatus    MediaProcessingStatus   @default(PENDING)
  transcodingStatus   TranscodingStatus?
  processingProvider  VideoProcessingProvider?
  externalId          String?
  playbackUrl         String?
  hlsUrl              String?
  dashUrl             String?
  availableQualities  VideoQuality[]
  tags                String[]
  relatedEntityType   String?
  relatedEntityId     String?
  visibility          MediaVisibility         @default(CLUB_ONLY)
  viewCount           Int                     @default(0)
  likeCount           Int                     @default(0)
  downloadCount       Int                     @default(0)
  commentCount        Int                     @default(0)           // NEW v7.10.1
  shareCount          Int                     @default(0)           // NEW v7.10.1
  bookmarkCount       Int                     @default(0)           // NEW v7.10.1
  averageRating       Float?                                        // NEW v7.10.1
  totalRatings        Int                     @default(0)           // NEW v7.10.1
  sport               Sport?                                        // NEW v7.10.1
  isPublic            Boolean                 @default(false)
  isFeatured          Boolean                 @default(false)
  allowComments       Boolean                 @default(true)        // NEW v7.10.1
  allowDownloads      Boolean                 @default(false)       // NEW v7.10.1
  publishedAt         DateTime?
  expiresAt           DateTime?
  deletedAt           DateTime?
  createdAt           DateTime                @default(now())
  updatedAt           DateTime                @updatedAt

  organisation        Organisation?           @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  club                Club?                   @relation(fields: [clubId], references: [id], onDelete: SetNull)
  uploader            User                    @relation("mediaUploader", fields: [uploaderId], references: [id])

  // =========================================================================
  // üé¨ VIDEO ANALYTICS RELATIONS (NEW v7.10.1)
  // =========================================================================
  viewLogs            MediaViewLog[]          @relation("mediaViewLogs")
  interactions        MediaInteraction[]      @relation("mediaInteractions")
  comments            MediaComment[]          @relation("mediaComments")
  analytics           MediaAnalyticsSummary?  @relation("mediaAnalytics")
  watchHistory        WatchHistory[]          @relation("mediaWatchHistory")

  @@index([organisationId])
  @@index([clubId])
  @@index([uploaderId])
  @@index([type])
  @@index([category])
  @@index([visibility])
  @@index([processingStatus])
  @@index([sport])
  @@index([deletedAt])
  @@map("media_content")
}

model MediaAsset {
  id             String        @id @default(cuid())
  organisationId String
  clubId         String?
  key            String        @unique
  filename       String
  url            String
  cdnUrl         String?
  mimeType       String
  size           Int
  width          Int?
  height         Int?
  metadata       Json?
  isPublic       Boolean       @default(false)
  uploadedBy     String
  deletedAt      DateTime?
  createdAt      DateTime      @default(now())

  organisation   Organisation  @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  club           Club?         @relation(fields: [clubId], references: [id], onDelete: SetNull)

  @@index([organisationId])
  @@index([clubId])
  @@index([key])
  @@index([deletedAt])
  @@map("media_assets")
}

// =============================================================================
// üé¨ VIDEO ANALYTICS MODELS (NEW v7.10.1)
// =============================================================================

// -----------------------------------------------------------------------------
// Media View Log - Detailed analytics for each view
// -----------------------------------------------------------------------------
model MediaViewLog {
  id                  String              @id @default(cuid())
  
  // Core Relations
  mediaId             String
  userId              String?             // Null for anonymous views
  
  // Session Info
  sessionId           String?
  viewStartedAt       DateTime            @default(now())
  viewEndedAt         DateTime?
  
  // Playback Metrics
  playbackDuration    Int?                // Seconds watched
  totalDuration       Int?                // Total video length
  completionPercent   Float?              // % watched
  playbackSpeed       Float               @default(1.0)
  qualityWatched      String?             // 480p, 720p, 1080p, etc.
  
  // Engagement Points
  pauseCount          Int                 @default(0)
  seekCount           Int                 @default(0)
  replayCount         Int                 @default(0)
  fullscreenUsed      Boolean             @default(false)
  
  // Device Info
  deviceType          String?             // mobile, tablet, desktop
  deviceModel         String?             // iPhone 15, Pixel 8, etc.
  browser             String?             // Chrome, Safari, Firefox
  browserVersion      String?
  os                  String?             // iOS, Android, Windows, macOS
  osVersion           String?
  screenWidth         Int?
  screenHeight        Int?
  
  // Network Info
  connectionType      String?             // wifi, 4g, 5g, ethernet
  bandwidth           Int?                // Estimated bandwidth in Kbps
  
  // Geographic Info
  ipAddress           String?
  countryCode         String?             @db.VarChar(2)
  country             String?
  region              String?
  city                String?
  latitude            Float?
  longitude           Float?
  timezone            String?
  
  // Referral Tracking
  referrerUrl         String?
  referrerType        String?             // direct, social, search, email
  utmSource           String?
  utmMedium           String?
  utmCampaign         String?
  
  // Context
  sport               Sport?
  viewContext         String?             // feed, profile, search, embed
  
  // Error Tracking
  errorOccurred       Boolean             @default(false)
  errorMessage        String?
  bufferingEvents     Int                 @default(0)
  droppedFrames       Int                 @default(0)
  
  // Timestamps
  createdAt           DateTime            @default(now())
  
  // Relations
  media               MediaContent        @relation("mediaViewLogs", fields: [mediaId], references: [id], onDelete: Cascade)
  user                User?               @relation("userMediaViews", fields: [userId], references: [id], onDelete: SetNull)
  
  @@index([mediaId])
  @@index([userId])
  @@index([viewStartedAt])
  @@index([countryCode])
  @@index([deviceType])
  @@index([sport])
  @@index([sessionId])
  @@map("media_view_logs")
}

// -----------------------------------------------------------------------------
// Media Interaction - User engagement tracking (likes, bookmarks, shares)
// -----------------------------------------------------------------------------
model MediaInteraction {
  id                  String              @id @default(cuid())
  
  // Core Relations
  mediaId             String
  userId              String
  
  // Like
  isLiked             Boolean             @default(false)
  likedAt             DateTime?
  
  // Bookmark/Save
  isBookmarked        Boolean             @default(false)
  bookmarkedAt        DateTime?
  bookmarkFolderId    String?
  
  // Share
  shareCount          Int                 @default(0)
  lastSharedAt        DateTime?
  sharedPlatforms     String[]
  
  // Watch Later
  inWatchLater        Boolean             @default(false)
  addedToWatchLaterAt DateTime?
  
  // Download
  downloadCount       Int                 @default(0)
  lastDownloadedAt    DateTime?
  
  // Rating (optional 1-5 star rating)
  rating              Int?
  ratedAt             DateTime?
  
  // Watch Progress (for resume functionality)
  lastWatchedAt       DateTime?
  watchProgress       Int?                // Seconds into video
  watchCompleted      Boolean             @default(false)
  watchCount          Int                 @default(0)
  
  // Notifications
  notificationsEnabled Boolean            @default(false)
  
  // Timestamps
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  media               MediaContent        @relation("mediaInteractions", fields: [mediaId], references: [id], onDelete: Cascade)
  user                User                @relation("userMediaInteractions", fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([mediaId, userId])
  @@index([mediaId])
  @@index([userId])
  @@index([isLiked])
  @@index([isBookmarked])
  @@index([lastWatchedAt])
  @@map("media_interactions")
}

// -----------------------------------------------------------------------------
// Media Comment - Comments on videos with threading support
// -----------------------------------------------------------------------------
model MediaComment {
  id                  String              @id @default(cuid())
  
  // Core Relations
  mediaId             String
  userId              String
  
  // Comment Content
  content             String              @db.Text
  contentHtml         String?             @db.Text
  
  // Threading
  parentId            String?
  rootId              String?
  depth               Int                 @default(0)
  
  // Timestamps (video context)
  timestamp           Int?                // Timestamp in video (seconds)
  isTimestamped       Boolean             @default(false)
  
  // Moderation
  status              CommentStatus       @default(PUBLISHED)
  moderatedBy         String?
  moderatedAt         DateTime?
  moderationReason    String?
  reportCount         Int                 @default(0)
  
  // Engagement
  likeCount           Int                 @default(0)
  replyCount          Int                 @default(0)
  
  // Edit History
  isEdited            Boolean             @default(false)
  editedAt            DateTime?
  editHistory         Json?
  
  // Mentions & Tags
  mentionedUserIds    String[]
  hashtags            String[]
  
  // Pinned (by video owner)
  isPinned            Boolean             @default(false)
  pinnedAt            DateTime?
  pinnedBy            String?
  
  // Creator Response
  isCreatorResponse   Boolean             @default(false)
  isHighlighted       Boolean             @default(false)
  
  // Soft Delete
  deletedAt           DateTime?
  deletedBy           String?
  
  // Timestamps
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  media               MediaContent        @relation("mediaComments", fields: [mediaId], references: [id], onDelete: Cascade)
  user                User                @relation("userMediaComments", fields: [userId], references: [id], onDelete: Cascade)
  parent              MediaComment?       @relation("commentReplies", fields: [parentId], references: [id], onDelete: Cascade)
  replies             MediaComment[]      @relation("commentReplies")
  likes               MediaCommentLike[]  @relation("commentLikes")
  
  @@index([mediaId])
  @@index([userId])
  @@index([parentId])
  @@index([rootId])
  @@index([status])
  @@index([timestamp])
  @@index([createdAt])
  @@index([deletedAt])
  @@map("media_comments")
}

// -----------------------------------------------------------------------------
// Media Comment Like - Track who liked which comments
// -----------------------------------------------------------------------------
model MediaCommentLike {
  id                  String              @id @default(cuid())
  commentId           String
  userId              String
  createdAt           DateTime            @default(now())
  
  // Relations
  comment             MediaComment        @relation("commentLikes", fields: [commentId], references: [id], onDelete: Cascade)
  user                User                @relation("userCommentLikes", fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([commentId, userId])
  @@index([commentId])
  @@index([userId])
  @@map("media_comment_likes")
}

// -----------------------------------------------------------------------------
// Media Analytics Summary - Aggregated analytics per media item
// -----------------------------------------------------------------------------
model MediaAnalyticsSummary {
  id                  String              @id @default(cuid())
  mediaId             String              @unique
  
  // View Metrics
  totalViews          Int                 @default(0)
  uniqueViewers       Int                 @default(0)
  totalWatchTime      Int                 @default(0)
  averageWatchTime    Float               @default(0)
  averageCompletion   Float               @default(0)
  
  // Engagement Metrics
  totalLikes          Int                 @default(0)
  totalBookmarks      Int                 @default(0)
  totalShares         Int                 @default(0)
  totalComments       Int                 @default(0)
  totalDownloads      Int                 @default(0)
  
  // Ratings
  averageRating       Float?
  totalRatings        Int                 @default(0)
  ratingDistribution  Json?               // { "1": 5, "2": 10, "3": 25, "4": 40, "5": 20 }
  
  // Device Breakdown (JSON for flexibility)
  deviceBreakdown     Json?
  browserBreakdown    Json?
  osBreakdown         Json?
  
  // Geographic Breakdown
  countryBreakdown    Json?
  regionBreakdown     Json?
  
  // Quality Breakdown
  qualityBreakdown    Json?
  
  // Time-based Metrics
  viewsByHour         Json?
  viewsByDay          Json?
  viewsByMonth        Json?
  
  // Peak Metrics
  peakConcurrentViews Int                 @default(0)
  peakViewDate        DateTime?
  
  // Engagement Rate
  engagementRate      Float               @default(0)
  
  // Retention Curve (for video heatmap)
  retentionCurve      Json?
  dropoffPoints       Json?               // Where viewers stop watching
  
  // Period Stats
  viewsLast24Hours    Int                 @default(0)
  viewsLast7Days      Int                 @default(0)
  viewsLast30Days     Int                 @default(0)
  
  // Trending
  trendingScore       Float               @default(0)
  isTrending          Boolean             @default(false)
  
  // Timestamps
  lastCalculatedAt    DateTime            @default(now())
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  media               MediaContent        @relation("mediaAnalytics", fields: [mediaId], references: [id], onDelete: Cascade)
  
  @@index([mediaId])
  @@index([totalViews])
  @@index([engagementRate])
  @@index([trendingScore])
  @@index([isTrending])
  @@map("media_analytics_summaries")
}

// -----------------------------------------------------------------------------
// Watch History - User's watch history for recommendations
// -----------------------------------------------------------------------------
model WatchHistory {
  id                  String              @id @default(cuid())
  userId              String
  mediaId             String
  
  // Watch Info
  watchedAt           DateTime            @default(now())
  watchDuration       Int                 @default(0)
  completionPercent   Float               @default(0)
  lastPosition        Int                 @default(0)
  
  // Context
  sport               Sport?
  watchContext        String?
  
  // Timestamps
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  user                User                @relation("userWatchHistory", fields: [userId], references: [id], onDelete: Cascade)
  media               MediaContent        @relation("mediaWatchHistory", fields: [mediaId], references: [id], onDelete: Cascade)
  
  @@unique([userId, mediaId])
  @@index([userId])
  @@index([mediaId])
  @@index([watchedAt])
  @@index([sport])
  @@map("watch_history")
}

// -----------------------------------------------------------------------------
// Bookmark Folder - Organize saved media into folders
// -----------------------------------------------------------------------------
model BookmarkFolder {
  id                  String              @id @default(cuid())
  userId              String
  
  name                String              @db.VarChar(100)
  description         String?
  color               String?
  icon                String?
  
  isDefault           Boolean             @default(false)
  isPrivate           Boolean             @default(true)
  
  mediaCount          Int                 @default(0)
  
  // Timestamps
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt
  
  // Relations
  user                User                @relation("userBookmarkFolders", fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([userId, name])
  @@index([userId])
  @@map("bookmark_folders")
}

// =============================================================================
// üèÉ PLAYER MODEL (ENHANCED v7.10.0)
// =============================================================================

model Player {
  id                     String                    @id @default(cuid())
  userId                 String                    @unique
  height                 Float?
  weight                 Float?
  dateOfBirth            DateTime?
  nationality            String?
  secondNationality      String?
  jerseyNumber           Int?
  preferredFoot          PreferredFoot?
  primaryPosition        Position?
  secondaryPosition      Position?
  tertiaryPosition       Position?
  marketValue            Float?
  valueLastUpdated       DateTime?
  currency               String                    @default("GBP")
  isActive               Boolean                   @default(true)
  isVerified             Boolean                   @default(false)
  hasCompletedProfile    Boolean                   @default(false)
  isAcademy              Boolean                   @default(false)
  isYouth                Boolean                   @default(false)
  youthCategory          String?
  overallRating          Float?                    @default(0)
  formRating             Float?                    @default(0)
  developmentPhase       String?
  fitnessLevel           Float?
  injuryStatus           String?
  lastFitnessTest        DateTime?
  availabilityStatus     String                    @default("AVAILABLE")
  deletedAt              DateTime?
  deletedBy              String?
  createdAt              DateTime                  @default(now())
  updatedAt              DateTime                  @updatedAt

  user                   User                      @relation(fields: [userId], references: [id], onDelete: Cascade)
  statistics             PlayerStatistic[]
  aggregateStats         PlayerAggregateStats?
  analytics              PlayerAnalytic?           @relation("playerAnalytics")
  insights               PlayerInsight?            @relation("playerInsights")
  contracts              Contract[]
  injuries               Injury[]
  medicalRecords         MedicalRecord[]
  fitnessAssessments     FitnessAssessment[]       @relation("playerFitnessAssessments")
  matchAttendance        MatchAttendance[]
  familyLinks            PlayerFamily[]
  scoutingReports        ScoutingReport[]
  scoutWatchlists        ScoutWatchlist[]
  highlights             PlayerHighlight[]
  badges                 Badge[]                   @relation("badgePlayer")
  achievements           Achievement[]             @relation("achievementPlayer")
  transfers              Transfer[]
  availabilityWindow     PlayerAvailability[]
  performanceGoals       PerformanceGoal[]         @relation("goalPlayer")
  trainingAttendance     TrainingAttendance[]
  teamPlayers            TeamPlayer[]
  joinRequests           TeamJoinRequest[]         @relation("playerJoinRequests")
  matchPerformances      PlayerMatchPerformance[]  @relation("playerPerformances")
  matchSquads            MatchSquad[]              @relation("playerSquad")
  matchEvents            MatchEvent[]              @relation("eventPlayer")
  matchEventsAssisted    MatchEvent[]              @relation("assistPlayer")
  matchEventsRelated     MatchEvent[]              @relation("relatedPlayer")
  developmentPlans       PlayerDevelopmentPlan[]   @relation("playerDevelopmentPlans")
  skillAssessments       SkillAssessment[]         @relation("playerSkillAssessments")
  milestones             SkillMilestone[]          @relation("playerMilestones")
  mentorshipsAsMentor    MentorshipAssignment[]    @relation("mentorAssignments")
  mentorshipsAsMentee    MentorshipAssignment[]    @relation("menteeAssignments")
  parentAccess           ParentPortalAccess[]      @relation("playerParentAccess")
  scholarships           Scholarship[]             @relation("playerScholarships")
  recoveryProtocols      RecoveryProtocol[]        @relation("playerRecoveryProtocols")
  nutritionPlans         NutritionPlan[]           @relation("playerNutritionPlans")
  sleepLogs              SleepLog[]                @relation("playerSleepLogs")
  wellnessChecks         WellnessCheck[]           @relation("playerWellnessChecks")
  challengeParticipations ChallengeParticipant[]   @relation("playerChallenges")
  leaderboardEntries     LeaderboardEntry[]        @relation("playerLeaderboardEntries")
  streaks                Streak[]                  @relation("playerStreaks")

  // Achievement System Relations (v7.10.0)
  playerAchievements     PlayerAchievement[]       @relation("playerAchievementProgress")
  playerMilestones       PlayerMilestone[]         @relation("playerMilestoneHistory")
  playerLevel            PlayerLevel?              @relation("playerLevelProgress")
  xpTransactions         XpTransaction[]           @relation("playerXpHistory")

  @@index([userId])
  @@index([isActive])
  @@index([isVerified])
  @@index([primaryPosition])
  @@index([marketValue])
  @@index([createdAt])
  @@index([availabilityStatus])
  @@index([deletedAt])
  @@map("players")
}

model PlayerStatistic {
  id              String   @id @default(cuid())
  playerId        String
  season          Int
  teamId          String?
  leagueId        String?
  matches         Int      @default(0)
  starts          Int      @default(0)
  minutesPlayed   Int      @default(0)
  goals           Int      @default(0)
  assists         Int      @default(0)
  ownGoals        Int      @default(0)
  yellowCards     Int      @default(0)
  secondYellows   Int      @default(0)
  redCards        Int      @default(0)
  foulsCommited   Int      @default(0)
  foulsSuffered   Int      @default(0)
  passes          Int      @default(0)
  passAccuracy    Float?
  keyPasses       Int      @default(0)
  tackles         Int      @default(0)
  tackleSuccess   Float?
  interceptions   Int      @default(0)
  clearances      Int      @default(0)
  blocks          Int      @default(0)
  aerialDuelsWon  Int      @default(0)
  aerialDuelsLost Int      @default(0)
  shots           Int      @default(0)
  shotsOnTarget   Int      @default(0)
  shotAccuracy    Float?
  cleanSheets     Int      @default(0)
  saves           Int      @default(0)
  savePercent     Float?
  goalsConceded   Int      @default(0)
  penaltySaves    Int      @default(0)
  dribbles        Int      @default(0)
  dribbleSuccess  Float?
  crossesAttempt  Int      @default(0)
  crossesComplete Int      @default(0)
  sportSpecificStats Json?
  averageRating   Float?
  highestRating   Float?
  lowestRating    Float?
  lastUpdated     DateTime @default(now())
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  player          Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, season, teamId, leagueId])
  @@index([playerId])
  @@index([season])
  @@index([teamId])
  @@index([leagueId])
  @@map("player_statistics")
}

model PlayerAggregateStats {
  id                  String   @id @default(cuid())
  playerId            String   @unique
  totalMatches        Int      @default(0)
  totalStarts         Int      @default(0)
  totalGoals          Int      @default(0)
  totalAssists        Int      @default(0)
  totalMinutes        Int      @default(0)
  totalYellowCards    Int      @default(0)
  totalRedCards       Int      @default(0)
  totalCleanSheets    Int      @default(0)
  avgGoalsPerMatch    Float    @default(0)
  avgAssistsPerMatch  Float    @default(0)
  avgMinutesPerMatch  Float    @default(0)
  avgRating           Float    @default(0)
  seasonGoals         Int      @default(0)
  seasonAssists       Int      @default(0)
  seasonMatches       Int      @default(0)
  formGoals           Int      @default(0)
  formAssists         Int      @default(0)
  formRating          Float?
  positionRank        Int?
  leagueRank          Int?
  clubRank            Int?
  milestone100Matches DateTime?
  milestone50Goals    DateTime?
  milestone100Goals   DateTime?
  lastUpdatedAt       DateTime @default(now())
  refreshedAt         DateTime @default(now())

  player              Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([lastUpdatedAt])
  @@map("player_aggregate_stats")
}

model PlayerAnalytic {
  id                    String   @id @default(cuid())
  playerId              String   @unique
  overallRating         Float    @default(0)
  formRating            Float    @default(0)
  consistencyIndex      Float    @default(0)
  injuryRisk            Float    @default(0)
  developmentPotential  Float    @default(0)
  fatigueLevelEstimate  Float    @default(0)
  workRateIndex         Float    @default(0)
  positionRank          Int?
  leagueRank            Int?
  globalRank            Int?
  ageGroupRank          Int?
  weeklyTrend           Float?
  monthlyTrend          Float?
  seasonTrend           Float?
  lastMatchRating       Float?
  last5MatchesAvg       Float?
  last10MatchesAvg      Float?
  seasonAverage         Float?
  predictions           Json?
  predictionConfidence  Float?
  expectedGoals         Float?
  expectedAssists       Float?
  passCompletionTrend   Float?
  pressureIndex         Float?
  tacticalAwareness     Float?
  strengths             String[]
  weaknesses            String[]
  developmentAreas      String[]
  recommendations       String?  @db.Text
  lastAnalysisDate      DateTime?
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  player                Player   @relation("playerAnalytics", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([overallRating])
  @@index([injuryRisk])
  @@index([formRating])
  @@map("player_analytics")
}

model PlayerInsight {
  id                   String   @id @default(cuid())
  playerId             String   @unique
  strengths            String[]
  weaknesses           String[]
  developmentAreas     String[]
  playingStyle         String?
  strongFoot           String?
  comparablePlayers    String[]
  pace                 Int?
  shooting             Int?
  passing              Int?
  dribbling            Int?
  defending            Int?
  physical             Int?
  aggressiveness       Int?
  defensiveAbility     Int?
  leadership           Int?
  teamwork             Int?
  situationalAwareness Int?
  composure            Int?
  creativity           Int?
  workRate             Int?
  determination        Int?
  concentration        Int?
  decisions            Int?
  anticipation         Int?
  vision               Int?
  recommendations      String?  @db.Text
  careerAdvice         String?  @db.Text
  lastReviewDate       DateTime?
  reviewedBy           String?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  player               Player   @relation("playerInsights", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@map("player_insights")
}

model PlayerFamily {
  id                 String   @id @default(cuid())
  playerId           String
  parentId           String?
  guardianId         String?
  relationship       String
  isEmergencyContact Boolean  @default(false)
  phone              String?
  email              String?
  canViewMedical     Boolean  @default(false)
  canSignForms       Boolean  @default(false)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  player             Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)
  parent             Parent?  @relation("parentChildren", fields: [parentId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([parentId])
  @@map("player_family")
}

model PlayerHighlight {
  id               String           @id @default(cuid())
  playerId         String
  matchId          String?
  title            String
  description      String?          @db.Text
  videoUrl         String?
  thumbnailUrl     String?
  duration         Int?
  highlightType    String
  processingStatus TranscodingStatus @default(PENDING)
  viewCount        Int              @default(0)
  likeCount        Int              @default(0)
  isPublic         Boolean          @default(true)
  isFeatured       Boolean          @default(false)
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt

  player           Player           @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([matchId])
  @@index([isFeatured])
  @@map("player_highlights")
}

model PlayerAvailability {
  id        String                @id @default(cuid())
  playerId  String
  startDate DateTime
  endDate   DateTime
  reason    String
  status    MatchAttendanceStatus
  notes     String?
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt

  player    Player                @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([startDate, endDate])
  @@map("player_availability")
}

model Injury {
  id                 String          @id @default(cuid())
  playerId           String
  type               String
  severity           InjurySeverity  @default(MINOR)
  location           String
  dateFrom           DateTime
  dateTo             DateTime?
  estimatedReturn    DateTime?
  actualReturn       DateTime?
  description        String?         @db.Text
  treatment          String?
  therapist          String?
  status             InjuryStatus    @default(ACTIVE)
  diagnosedBy        String?
  facility           String?
  scans              String[]
  notes              String?         @db.Text
  recoveryProgress   Int?
  lastAssessment     DateTime?
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt

  player             Player          @relation(fields: [playerId], references: [id], onDelete: Cascade)
  fitnessAssessments FitnessAssessment[] @relation("injuryAssessments")
  recoveryProtocols  RecoveryProtocol[] @relation("injuryRecoveryProtocols")

  @@index([playerId])
  @@index([dateFrom])
  @@index([status])
  @@index([severity])
  @@map("injuries")
}

model MedicalRecord {
  id                 String   @id @default(cuid())
  playerId           String
  recordType         String
  date               DateTime
  results            Json?
  notes              String?  @db.Text
  provider           String?
  facility           String?
  attachments        String[]
  isClearanceRecord  Boolean  @default(false)
  clearanceStatus    String?
  clearanceExpiry    DateTime?
  isConfidential     Boolean  @default(true)
  accessRestricted   Boolean  @default(true)
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  player             Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([recordType])
  @@index([date])
  @@map("medical_records")
}

model FitnessAssessment {
  id                  String                @id @default(cuid())
  playerId            String
  assessorId          String
  type                FitnessAssessmentType
  date                DateTime
  weight              Float?
  bodyFat             Float?
  restingHR           Int?
  maxHR               Int?
  vo2Max              Float?
  sprintTime          Float?
  agilityTime         Float?
  verticalJump        Float?
  beepTestLevel       Float?
  flexibilityScore    Float?
  mobilityNotes       String?               @db.Text
  strengthTests       Json?
  overallScore        Float?
  status              FitnessStatus         @default(PENDING_REVIEW)
  isRTPAssessment     Boolean               @default(false)
  injuryId            String?
  rtpStage            Int?
  rtpCleared          Boolean               @default(false)
  rtpClearedDate      DateTime?
  notes               String?               @db.Text
  recommendations     String[]              @default([])
  attachments         String[]
  nextAssessmentDue   DateTime?
  sportSpecificMetrics Json?
  createdAt           DateTime              @default(now())
  updatedAt           DateTime              @updatedAt

  player              Player                @relation("playerFitnessAssessments", fields: [playerId], references: [id], onDelete: Cascade)
  assessor            User                  @relation("fitnessAssessor", fields: [assessorId], references: [id])
  injury              Injury?               @relation("injuryAssessments", fields: [injuryId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([assessorId])
  @@index([injuryId])
  @@index([date])
  @@index([type])
  @@index([status])
  @@index([isRTPAssessment])
  @@map("fitness_assessments")
}

model Contract {
  id                String   @id @default(cuid())
  playerId          String
  clubId            String?
  position          Position
  salary            Float?
  currency          String   @default("GBP")
  bonusStructure    Json?
  performanceBonus  Float?
  signOnBonus       Float?
  loyaltyBonus      Float?
  appearanceFee     Float?
  goalBonus         Float?
  startDate         DateTime
  endDate           DateTime?
  contractType      String   @default("PROFESSIONAL")
  status            String   @default("ACTIVE")
  contractDocument  String?
  extensionOption   Boolean  @default(false)
  extensionDate     DateTime?
  extensionYears    Int?
  buyoutClause      Float?
  releaseClause     Float?
  matchingRights    Boolean  @default(false)
  imageRightsPercent Float?
  agentName         String?
  agentEmail        String?
  agentPhone        String?
  agentCommission   Float?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  player            Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([clubId])
  @@index([status])
  @@index([endDate])
  @@map("contracts")
}

model Transfer {
  id               String         @id @default(cuid())
  playerId         String
  fromClubId       String?
  toClubId         String?
  seasonId         String?
  type             TransferType
  status           TransferStatus @default(PENDING)
  fee              Float?
  feeType          String         @default("FIXED")
  currency         String         @default("GBP")
  addOns           Json?
  sellOnPercent    Float?
  installments     Json?
  agentFee         Float?
  loanFee          Float?
  wageContribution Float?
  buyOption        Float?
  buyObligation    Float?
  recallClause     Boolean        @default(false)
  announcedAt      DateTime?
  completedAt      DateTime?
  effectiveDate    DateTime
  loanEndDate      DateTime?
  medicalPassed    Boolean        @default(false)
  medicalDate      DateTime?
  contractSigned   Boolean        @default(false)
  contractDate     DateTime?
  notes            String?        @db.Text
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt

  player           Player         @relation(fields: [playerId], references: [id], onDelete: Cascade)
  season           Season?        @relation(fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([fromClubId])
  @@index([toClubId])
  @@index([status])
  @@index([effectiveDate])
  @@map("transfers")
}

// =============================================================================
// üèü CLUB & TEAM MODELS
// =============================================================================

model Club {
  id                    String                    @id @default(cuid())
  organisationId        String
  name                  String
  shortName             String?
  nickname              String?
  slug                  String                    @unique @db.VarChar(63)
  foundedYear           Int?
  description           String?                   @db.Text
  logo                  String?
  badge                 String?
  colors                String[]
  primaryColor          String?
  secondaryColor        String?
  homeVenue             String?
  homeVenueId           String?
  trainingFacilityId    String?
  address               String?
  city                  String?
  region                String?
  country               String?
  postcode              String?
  website               String?
  email                 String?
  phone                 String?
  socialMedia           Json?
  sport                 Sport                     @default(FOOTBALL)
  managerId             String?
  ownerId               String?
  registrationNumber    String?                   @unique
  affiliations          String[]
  monthlyBudget         Float?
  currency              String                    @default("GBP")
  memberCount           Int                       @default(0)
  playerCount           Int                       @default(0)
  teamCount             Int                       @default(0)
  isActive              Boolean                   @default(true)
  isVerified            Boolean                   @default(false)
  verifiedAt            DateTime?
  deletedAt             DateTime?
  createdAt             DateTime                  @default(now())
  updatedAt             DateTime                  @updatedAt

  organisation          Organisation              @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  manager               User?                     @relation("clubManager", fields: [managerId], references: [id], onDelete: SetNull)
  owner                 User?                     @relation("clubOwner", fields: [ownerId], references: [id], onDelete: SetNull)
  members               ClubMember[]
  teams                 Team[]
  matches               Match[]                   @relation("clubMatches")
  mediaContent          MediaContent[]
  mediaAssets           MediaAsset[]
  trainingSessions      TrainingSession[]
  scoutingReports       ScoutingReport[]
  tactics               Tactic[]
  announcements         Announcement[]
  jobPostings           JobPosting[]
  venues                Venue[]                   @relation("clubVenues")
  drills                TrainingDrill[]           @relation("clubDrills")
  budgets               Budget[]                  @relation("clubBudgets")
  expenses              Expense[]                 @relation("clubExpenses")
  coachRates            CoachRate[]               @relation("clubCoachRates")
  coachAssignments      CoachAssignment[]         @relation("clubCoachAssignments")
  coachReviews          CoachPerformanceReview[]  @relation("clubCoachReviews")
  developmentPlans      PlayerDevelopmentPlan[]   @relation("clubDevelopmentPlans")
  mentorships           MentorshipAssignment[]    @relation("clubMentorships")
  parentAccess          ParentPortalAccess[]      @relation("clubParentAccess")
  teamAnnouncements     TeamAnnouncement[]        @relation("clubTeamAnnouncements")
  paymentPlans          PaymentPlan[]             @relation("clubPaymentPlans")
  feeStructures         FeeStructure[]            @relation("clubFeeStructures")
  scholarships          Scholarship[]             @relation("clubScholarships")
  challenges            Challenge[]               @relation("clubChallenges")
  leaderboards          Leaderboard[]             @relation("clubLeaderboards")
  seasonAwards          SeasonAward[]             @relation("clubSeasonAwards")
  exportRequests        ExportRequest[]           @relation("clubExports")
  exportTemplates       ExportTemplate[]          @relation("clubExportTemplates")
  reportSchedules       ReportSchedule[]          @relation("clubReportSchedules")

  @@index([organisationId])
  @@index([slug])
  @@index([sport])
  @@index([managerId])
  @@index([ownerId])
  @@index([isActive])
  @@index([deletedAt])
  @@map("clubs")
}

model ClubMember {
  id            String         @id @default(cuid())
  clubId        String
  userId        String
  role          ClubMemberRole @default(PLAYER)
  department    String?
  jobTitle      String?
  isActive      Boolean        @default(true)
  joinedAt      DateTime       @default(now())
  leftAt        DateTime?
  contractStart DateTime?
  contractEnd   DateTime?
  salary        Float?
  currency      String         @default("GBP")
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt

  club          Club           @relation(fields: [clubId], references: [id], onDelete: Cascade)
  user          User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([clubId, userId])
  @@index([clubId])
  @@index([userId])
  @@index([role])
  @@index([isActive])
  @@map("club_members")
}

model Team {
  id                 String              @id @default(cuid())
  clubId             String
  name               String
  shortName          String?
  slug               String              @db.VarChar(63)
  description        String?             @db.Text
  logo               String?
  badge              String?
  type               TeamType            @default(AMATEUR)
  status             TeamStatus          @default(ACTIVE)
  ageGroup           String?
  gender             String              @default("MIXED")
  sport              Sport               @default(FOOTBALL)
  primaryColor       String?
  secondaryColor     String?
  homeVenueId        String?
  formation          FormationType?
  tacticsDocument    String?
  maxPlayers         Int                 @default(30)
  minPlayers         Int                 @default(11)
  registrationOpen   Boolean             @default(false)
  requiresApproval   Boolean             @default(true)
  inviteOnly         Boolean             @default(false)
  memberCount        Int                 @default(0)
  activePlayers      Int                 @default(0)
  seasonId           String?
  isActive           Boolean             @default(true)
  deletedAt          DateTime?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt

  club               Club                @relation(fields: [clubId], references: [id], onDelete: Cascade)
  players            TeamPlayer[]
  homeMatches        Match[]             @relation("homeTeam")
  awayMatches        Match[]             @relation("awayTeam")
  trainingSessions   TrainingSession[]
  tactics            Tactic[]
  scoutingReports    ScoutingReport[]    @relation("scoutedTeam")
  joinRequests       TeamJoinRequest[]   @relation("teamJoinRequests")
  competitionTeams   CompetitionTeam[]
  budgets            Budget[]            @relation("teamBudgets")
  expenses           Expense[]           @relation("teamExpenses")
  coachAssignments   CoachAssignment[]   @relation("teamCoachAssignments")
  teamAnnouncements  TeamAnnouncement[]  @relation("teamAnnouncements")
  feeStructures      FeeStructure[]      @relation("teamFeeStructures")
  teamChemistry      TeamChemistry[]     @relation("teamChemistry")
  leaderboards       Leaderboard[]       @relation("teamLeaderboards")
  seasonAwards       SeasonAward[]       @relation("teamSeasonAwards")
  playerMilestones   PlayerMilestone[]   @relation("teamMilestones")

  @@unique([clubId, slug])
  @@index([clubId])
  @@index([type])
  @@index([status])
  @@index([sport])
  @@index([ageGroup])
  @@index([isActive])
  @@index([deletedAt])
  @@map("teams")
}

model TeamPlayer {
  id            String   @id @default(cuid())
  teamId        String
  playerId      String
  jerseyNumber  Int?
  position      Position?
  isActive      Boolean  @default(true)
  isCaptain     Boolean  @default(false)
  isViceCaptain Boolean  @default(false)
  joinedAt      DateTime @default(now())
  leftAt        DateTime?
  status        String   @default("ACTIVE")
  notes         String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  team          Team     @relation(fields: [teamId], references: [id], onDelete: Cascade)
  player        Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([teamId, playerId])
  @@unique([teamId, jerseyNumber])
  @@index([teamId])
  @@index([playerId])
  @@index([isActive])
  @@map("team_players")
}

model TeamJoinRequest {
  id          String            @id @default(cuid())
  teamId      String
  playerId    String
  status      JoinRequestStatus @default(PENDING)
  message     String?           @db.Text
  position    Position?
  jerseyNum   Int?
  reviewedBy  String?
  reviewedAt  DateTime?
  reviewNotes String?
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  team        Team              @relation("teamJoinRequests", fields: [teamId], references: [id], onDelete: Cascade)
  player      Player            @relation("playerJoinRequests", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([teamId, playerId])
  @@index([teamId])
  @@index([playerId])
  @@index([status])
  @@map("team_join_requests")
}

// =============================================================================
// ‚öΩ MATCH & COMPETITION MODELS
// =============================================================================

model Competition {
  id                String                  @id @default(cuid())
  organisationId    String
  name              String
  shortName         String?
  slug              String                  @db.VarChar(63)
  description       String?                 @db.Text
  logo              String?
  type              CompetitionType         @default(LEAGUE)
  format            LeagueFormat            @default(ROUND_ROBIN)
  visibility        LeagueVisibility        @default(PUBLIC)
  sport             Sport                   @default(FOOTBALL)
  country           String?
  region            String?
  ageGroup          String?
  gender            String                  @default("MIXED")
  seasonId          String?
  startDate         DateTime?
  endDate           DateTime?
  registrationStart DateTime?
  registrationEnd   DateTime?
  maxTeams          Int                     @default(20)
  minTeams          Int                     @default(2)
  entryFee          Float?
  currency          String                  @default("GBP")
  prizePool         Float?
  rules             Json?
  tieBreakers       String[]
  pointsWin         Int                     @default(3)
  pointsDraw        Int                     @default(1)
  pointsLoss        Int                     @default(0)
  currentRound      Int?
  totalRounds       Int?
  currentStage      CompetitionStage?
  isActive          Boolean                 @default(true)
  isArchived        Boolean                 @default(false)
  createdBy         String
  deletedAt         DateTime?
  createdAt         DateTime                @default(now())
  updatedAt         DateTime                @updatedAt

  organisation      Organisation            @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  season            Season?                 @relation(fields: [seasonId], references: [id], onDelete: SetNull)
  creator           User                    @relation("competitionCreator", fields: [createdBy], references: [id])
  teams             CompetitionTeam[]
  standings         CompetitionStanding[]
  matches           Match[]
  stageConfigs      CompetitionStageConfig[]
  brackets          TournamentBracket[]

  @@unique([organisationId, slug])
  @@index([organisationId])
  @@index([seasonId])
  @@index([type])
  @@index([sport])
  @@index([isActive])
  @@index([deletedAt])
  @@map("competitions")
}

model CompetitionTeam {
  id             String      @id @default(cuid())
  competitionId  String
  teamId         String
  group          String?
  seed           Int?
  registeredAt   DateTime    @default(now())
  isActive       Boolean     @default(true)
  isWithdrawn    Boolean     @default(false)
  withdrawnAt    DateTime?
  withdrawReason String?

  competition    Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)
  team           Team        @relation(fields: [teamId], references: [id], onDelete: Cascade)

  @@unique([competitionId, teamId])
  @@index([competitionId])
  @@index([teamId])
  @@index([group])
  @@map("competition_teams")
}

model CompetitionStanding {
  id              String      @id @default(cuid())
  competitionId   String
  teamId          String
  group           String?
  position        Int
  played          Int         @default(0)
  won             Int         @default(0)
  drawn           Int         @default(0)
  lost            Int         @default(0)
  goalsFor        Int         @default(0)
  goalsAgainst    Int         @default(0)
  goalDifference  Int         @default(0)
  points          Int         @default(0)
  form            String[]
  homeWon         Int         @default(0)
  homeDrawn       Int         @default(0)
  homeLost        Int         @default(0)
  awayWon         Int         @default(0)
  awayDrawn       Int         @default(0)
  awayLost        Int         @default(0)
  cleanSheets     Int         @default(0)
  pointsDeducted  Int         @default(0)
  deductionReason String?
  lastUpdated     DateTime    @default(now())
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  competition     Competition @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, teamId, group])
  @@index([competitionId])
  @@index([teamId])
  @@index([position])
  @@index([group])
  @@map("competition_standings")
}

model CompetitionStageConfig {
  id              String           @id @default(cuid())
  competitionId   String
  stage           CompetitionStage
  order           Int
  name            String?
  teamsRequired   Int
  isKnockout      Boolean          @default(false)
  legs            Int              @default(1)
  aggregateGoals  Boolean          @default(false)
  awayGoalsRule   Boolean          @default(false)
  extraTime       Boolean          @default(true)
  penalties       Boolean          @default(true)
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt

  competition     Competition      @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, stage])
  @@index([competitionId])
  @@map("competition_stage_configs")
}

model TournamentBracket {
  id              String           @id @default(cuid())
  competitionId   String
  stage           CompetitionStage
  matchNumber     Int
  homeTeamId      String?
  awayTeamId      String?
  homeScore       Int?
  awayScore       Int?
  winnerId        String?
  matchId         String?
  nextMatchNumber Int?
  prevMatch1      Int?
  prevMatch2      Int?
  bracketPosition String?
  scheduledDate   DateTime?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt

  competition     Competition      @relation(fields: [competitionId], references: [id], onDelete: Cascade)

  @@unique([competitionId, stage, matchNumber])
  @@index([competitionId])
  @@index([stage])
  @@map("tournament_brackets")
}

model Match {
  id                   String               @id @default(cuid())
  clubId               String?
  competitionId        String?
  homeTeamId           String
  awayTeamId           String
  matchType            MatchType            @default(LEAGUE)
  status               MatchStatus          @default(SCHEDULED)
  sport                Sport                @default(FOOTBALL)
  venueId              String?
  venue                String?
  round                Int?
  leg                  Int?
  matchday             Int?
  kickoff              DateTime
  actualKickoff        DateTime?
  endTime              DateTime?
  duration             Int?
  extraTimeDuration    Int?
  homeScore            Int?
  awayScore            Int?
  homeHalfTimeScore    Int?
  awayHalfTimeScore    Int?
  homeExtraTimeScore   Int?
  awayExtraTimeScore   Int?
  homePenaltyScore     Int?
  awayPenaltyScore     Int?
  aggregateHome        Int?
  aggregateAway        Int?
  resultApproval       ResultApprovalStatus @default(PENDING)
  resultApprovedBy     String?
  resultApprovedAt     DateTime?
  resultDisputeReason  String?
  homeFormation        FormationType?
  awayFormation        FormationType?
  homeLineup           Json?
  awayLineup           Json?
  homeTactics          Json?
  awayTactics          Json?
  possession           Json?
  weather              Json?
  pitchCondition       String?
  attendance           Int?
  referee              String?
  assistantRef1        String?
  assistantRef2        String?
  fourthOfficial       String?
  varOfficials         String[]
  highlights           String[]
  matchReportUrl       String?
  tvBroadcast          String?
  streamUrl            String?
  ticketUrl            String?
  notes                String?              @db.Text
  isPublic             Boolean              @default(true)
  isFeatured           Boolean              @default(false)
  createdBy            String
  deletedAt            DateTime?
  createdAt            DateTime             @default(now())
  updatedAt            DateTime             @updatedAt

  club                 Club?                @relation("clubMatches", fields: [clubId], references: [id], onDelete: SetNull)
  homeTeam             Team                 @relation("homeTeam", fields: [homeTeamId], references: [id], onDelete: Cascade)
  awayTeam             Team                 @relation("awayTeam", fields: [awayTeamId], references: [id], onDelete: Cascade)
  competition          Competition?         @relation(fields: [competitionId], references: [id], onDelete: SetNull)
  creator              User                 @relation("matchCreator", fields: [createdBy], references: [id])
  events               MatchEvent[]
  squads               MatchSquad[]
  attendance_          MatchAttendance[]
  officials            MatchOfficial[]
  performances         PlayerMatchPerformance[]
  triggeredMilestones  PlayerMilestone[]    @relation("milestoneTriggerMatch")

  @@index([clubId])
  @@index([competitionId])
  @@index([homeTeamId])
  @@index([awayTeamId])
  @@index([venueId])
  @@index([kickoff])
  @@index([status])
  @@index([matchType])
  @@index([deletedAt])
  @@map("matches")
}

model MatchEvent {
  id              String         @id @default(cuid())
  matchId         String
  type            MatchEventType
  minute          Int
  addedTime       Int?
  period          String         @default("FIRST_HALF")
  playerId        String?
  assistPlayerId  String?
  relatedPlayerId String?
  teamId          String?
  description     String?
  isHomeTeam      Boolean?
  videoUrl        String?
  coordinates     Json?
  details         Json?
  isConfirmed     Boolean        @default(true)
  isVARReviewed   Boolean        @default(false)
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt

  match           Match          @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player          Player?        @relation("eventPlayer", fields: [playerId], references: [id], onDelete: SetNull)
  assistPlayer    Player?        @relation("assistPlayer", fields: [assistPlayerId], references: [id], onDelete: SetNull)
  relatedPlayer   Player?        @relation("relatedPlayer", fields: [relatedPlayerId], references: [id], onDelete: SetNull)

  @@index([matchId])
  @@index([playerId])
  @@index([type])
  @@index([minute])
  @@map("match_events")
}

model MatchSquad {
  id            String    @id @default(cuid())
  matchId       String
  playerId      String
  teamId        String
  jerseyNumber  Int?
  position      Position?
  isStarter     Boolean   @default(false)
  isSubstitute  Boolean   @default(false)
  isCaptain     Boolean   @default(false)
  minutesPlayed Int?
  subbedOnMin   Int?
  subbedOffMin  Int?
  rating        Float?
  notes         String?
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  match         Match     @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player        Player    @relation("playerSquad", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([playerId])
  @@index([teamId])
  @@map("match_squads")
}

model MatchAttendance {
  id        String                @id @default(cuid())
  matchId   String
  playerId  String
  teamId    String
  status    MatchAttendanceStatus @default(AVAILABLE)
  reason    String?
  updatedBy String?
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt

  match     Match                 @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player    Player                @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([playerId])
  @@index([status])
  @@map("match_attendance")
}

model MatchOfficial {
  id        String            @id @default(cuid())
  matchId   String
  refereeId String
  role      MatchOfficialRole @default(REFEREE)
  fee       Float?
  currency  String            @default("GBP")
  expenses  Float?
  confirmed Boolean           @default(false)
  arrived   Boolean           @default(false)
  notes     String?
  rating    Float?
  createdAt DateTime          @default(now())
  updatedAt DateTime          @updatedAt

  match     Match             @relation(fields: [matchId], references: [id], onDelete: Cascade)
  referee   Referee           @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@unique([matchId, refereeId, role])
  @@index([matchId])
  @@index([refereeId])
  @@map("match_officials")
}

model PlayerMatchPerformance {
  id                 String    @id @default(cuid())
  matchId            String
  playerId           String
  teamId             String
  position           Position?
  minutesPlayed      Int       @default(0)
  rating             Float?
  goals              Int       @default(0)
  assists            Int       @default(0)
  shots              Int       @default(0)
  shotsOnTarget      Int       @default(0)
  passes             Int       @default(0)
  passAccuracy       Float?
  keyPasses          Int       @default(0)
  tackles            Int       @default(0)
  interceptions      Int       @default(0)
  clearances         Int       @default(0)
  foulsCommitted     Int       @default(0)
  foulsSuffered      Int       @default(0)
  yellowCards        Int       @default(0)
  redCards           Int       @default(0)
  saves              Int       @default(0)
  dribbles           Int       @default(0)
  duelsWon           Int       @default(0)
  duelsLost          Int       @default(0)
  aerialDuelsWon     Int       @default(0)
  touches            Int       @default(0)
  possessionLost     Int       @default(0)
  sportSpecificStats Json?
  heatmapData        Json?
  notes              String?
  isMotm             Boolean   @default(false)
  coachRating        Float?
  coachNotes         String?
  createdAt          DateTime  @default(now())
  updatedAt          DateTime  @updatedAt

  match              Match     @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player             Player    @relation("playerPerformances", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([matchId, playerId])
  @@index([matchId])
  @@index([playerId])
  @@index([teamId])
  @@map("player_match_performances")
}

// =============================================================================
// üèã TRAINING MODELS
// =============================================================================

model TrainingSession {
  id                String              @id @default(cuid())
  clubId            String
  teamId            String?
  coachId           String
  title             String
  description       String?             @db.Text
  category          TrainingCategory    @default(TACTICAL)
  intensity         TrainingIntensity   @default(MEDIUM)
  status            TrainingStatus      @default(SCHEDULED)
  date              DateTime
  startTime         DateTime
  endTime           DateTime
  duration          Int?
  location          String?
  venueId           String?
  maxParticipants   Int?
  objectives        String[]
  equipment         String[]
  notes             String?             @db.Text
  coachNotes        String?             @db.Text
  weatherConditions String?
  isPublic          Boolean             @default(false)
  isRequired        Boolean             @default(true)
  isCancelled       Boolean             @default(false)
  cancellationReason String?
  sport             Sport               @default(FOOTBALL)
  deletedAt         DateTime?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt

  club              Club                @relation(fields: [clubId], references: [id], onDelete: Cascade)
  team              Team?               @relation(fields: [teamId], references: [id], onDelete: SetNull)
  coach             Coach               @relation(fields: [coachId], references: [id], onDelete: Cascade)
  attendance        TrainingAttendance[]
  drills            TrainingSessionDrill[]

  @@index([clubId])
  @@index([teamId])
  @@index([coachId])
  @@index([date])
  @@index([status])
  @@index([deletedAt])
  @@map("training_sessions")
}

model TrainingAttendance {
  id          String           @id @default(cuid())
  sessionId   String
  playerId    String
  status      AttendanceStatus @default(PRESENT)
  arrivalTime DateTime?
  departureTime DateTime?
  rating      Float?
  notes       String?
  feedback    String?
  injuries    String?
  recordedBy  String?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  session     TrainingSession  @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  player      Player           @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([sessionId, playerId])
  @@index([sessionId])
  @@index([playerId])
  @@index([status])
  @@map("training_attendance")
}

model TrainingDrill {
  id               String              @id @default(cuid())
  clubId           String?
  createdById      String
  name             String
  description      String?             @db.Text
  category         DrillCategory
  sport            Sport               @default(FOOTBALL)
  intensity        DrillIntensity      @default(MEDIUM)
  difficulty       DrillDifficulty     @default(INTERMEDIATE)
  durationMinutes  Int?
  minPlayers       Int?
  maxPlayers       Int?
  equipment        String[]
  objectives       String[]
  coachingPoints   String[]
  variations       String[]
  progressions     String[]
  diagramUrl       String?
  videoUrl         String?
  thumbnailUrl     String?
  tags             String[]
  isPublic         Boolean             @default(false)
  isVerified       Boolean             @default(false)
  usageCount       Int                 @default(0)
  averageRating    Float?
  totalRatings     Int                 @default(0)
  deletedAt        DateTime?
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt

  club             Club?               @relation("clubDrills", fields: [clubId], references: [id], onDelete: SetNull)
  createdBy        User                @relation("drillsCreated", fields: [createdById], references: [id])
  sessionDrills    TrainingSessionDrill[]

  @@index([clubId])
  @@index([createdById])
  @@index([category])
  @@index([sport])
  @@index([difficulty])
  @@index([isPublic])
  @@index([deletedAt])
  @@map("training_drills")
}

model TrainingSessionDrill {
  id          String          @id @default(cuid())
  sessionId   String
  drillId     String
  order       Int
  duration    Int?
  notes       String?
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  session     TrainingSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)
  drill       TrainingDrill   @relation(fields: [drillId], references: [id], onDelete: Cascade)

  @@unique([sessionId, drillId])
  @@index([sessionId])
  @@index([drillId])
  @@map("training_session_drills")
}

model Tactic {
  id              String        @id @default(cuid())
  clubId          String
  teamId          String?
  name            String
  description     String?       @db.Text
  formation       FormationType
  positions       Json?
  roles           Json?
  instructions    String?       @db.Text
  pressStyle      String?
  buildUpStyle    String?
  attackingStyle  String?
  defendingStyle  String?
  transitions     Json?
  setpieces       Json?
  diagramUrl      String?
  videoUrl        String?
  isDefault       Boolean       @default(false)
  sport           Sport         @default(FOOTBALL)
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  club            Club          @relation(fields: [clubId], references: [id], onDelete: Cascade)
  team            Team?         @relation(fields: [teamId], references: [id], onDelete: SetNull)

  @@index([clubId])
  @@index([teamId])
  @@index([formation])
  @@map("tactics")
}

model ScoutingReport {
  id                   String     @id @default(cuid())
  scoutId              String
  playerId             String
  teamId               String?
  clubId               String?
  matchId              String?
  matchDate            DateTime?
  competition          String?
  opponent             String?
  venue                String?
  overallRating        Float
  technicalRating      Float?
  tacticalRating       Float?
  physicalRating       Float?
  mentalRating         Float?
  potentialRating      Float?
  strengths            String[]
  weaknesses           String[]
  playingStyle         String?
  bestPosition         Position?
  alternativePositions Position[]
  comparison           String?
  recommendation       String     @default("MONITOR")
  marketValueEstimate  Float?
  currency             String     @default("GBP")
  summary              String?    @db.Text
  detailedReport       String?    @db.Text
  videoClips           String[]
  attachments          String[]
  isPublic             Boolean    @default(false)
  isFeatured           Boolean    @default(false)
  followUpDate         DateTime?
  followUpNotes        String?
  deletedAt            DateTime?
  createdAt            DateTime   @default(now())
  updatedAt            DateTime   @updatedAt

  scout                Scout      @relation(fields: [scoutId], references: [id], onDelete: Cascade)
  player               Player     @relation(fields: [playerId], references: [id], onDelete: Cascade)
  scoutedTeam          Team?      @relation("scoutedTeam", fields: [teamId], references: [id], onDelete: SetNull)
  club                 Club?      @relation(fields: [clubId], references: [id], onDelete: SetNull)

  @@index([scoutId])
  @@index([playerId])
  @@index([teamId])
  @@index([clubId])
  @@index([overallRating])
  @@index([recommendation])
  @@index([deletedAt])
  @@map("scouting_reports")
}

// =============================================================================
// üë• STAFF MODELS
// =============================================================================

model Coach {
  id               String                    @id @default(cuid())
  userId           String                    @unique
  licenseLevel     String?
  specialization   String[]
  experience       Int?
  qualifications   String[]
  biography        String?                   @db.Text
  coachingStyle    String?
  isActive         Boolean                   @default(true)
  rating           Float?
  hourlyRate       Float?
  currency         String                    @default("GBP")
  availability     Json?
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime                  @updatedAt

  user             User                      @relation(fields: [userId], references: [id], onDelete: Cascade)
  trainingSessions TrainingSession[]
  timesheets       CoachTimesheet[]
  payments         CoachPayment[]
  rates            CoachRate[]               @relation("coachRates")
  assignments      CoachAssignment[]         @relation("coachAssignments")
  certifications   CoachCertification[]      @relation("coachCertifications")
  reviews          CoachPerformanceReview[]  @relation("coachReviews")
  developmentPlans PlayerDevelopmentPlan[]   @relation("coachDevelopmentPlans")
  skillAssessments SkillAssessment[]         @relation("coachSkillAssessments")

  @@index([userId])
  @@index([isActive])
  @@index([licenseLevel])
  @@map("coaches")
}

model CoachTimesheet {
  id            String          @id @default(cuid())
  coachId       String
  periodStart   DateTime
  periodEnd     DateTime
  totalHours    Float           @default(0)
  trainingHours Float           @default(0)
  matchHours    Float           @default(0)
  adminHours    Float           @default(0)
  travelHours   Float           @default(0)
  otherHours    Float           @default(0)
  hourlyRate    Float?
  totalAmount   Float?
  currency      String          @default("GBP")
  breakdown     Json?
  sessions      Json?
  expenses      Float?
  expenseDetails Json?
  status        TimesheetStatus @default(DRAFT)
  submittedAt   DateTime?
  approvedBy    String?
  approvedAt    DateTime?
  approvalNotes String?
  rejectedBy    String?
  rejectedAt    DateTime?
  rejectionReason String?
  paidAt        DateTime?
  paymentRef    String?
  notes         String?         @db.Text
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt

  coach         Coach           @relation(fields: [coachId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([periodStart])
  @@index([periodEnd])
  @@index([status])
  @@map("coach_timesheets")
}

model CoachPayment {
  id            String        @id @default(cuid())
  coachId       String
  timesheetId   String?
  amount        Float
  currency      String        @default("GBP")
  type          PaymentType   @default(COACHING_FEE)
  status        PaymentStatus @default(PENDING)
  periodStart   DateTime?
  periodEnd     DateTime?
  paidAt        DateTime?
  paymentMethod String?
  reference     String?
  invoiceUrl    String?
  notes         String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  coach         Coach         @relation(fields: [coachId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([status])
  @@index([paidAt])
  @@map("coach_payments")
}

model CoachRate {
  id           String        @id @default(cuid())
  coachId      String
  clubId       String
  rateType     CoachRateType @default(HOURLY)
  rate         Float
  currency     String        @default("GBP")
  description  String?
  effectiveFrom DateTime
  effectiveTo  DateTime?
  isActive     Boolean       @default(true)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  coach        Coach         @relation("coachRates", fields: [coachId], references: [id], onDelete: Cascade)
  club         Club          @relation("clubCoachRates", fields: [clubId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([clubId])
  @@index([isActive])
  @@map("coach_rates")
}

model CoachAssignment {
  id           String              @id @default(cuid())
  coachId      String
  clubId       String
  teamId       String?
  seasonId     String?
  type         CoachAssignmentType @default(ASSISTANT_COACH)
  isPrimary    Boolean             @default(false)
  startDate    DateTime
  endDate      DateTime?
  isActive     Boolean             @default(true)
  notes        String?
  createdAt    DateTime            @default(now())
  updatedAt    DateTime            @updatedAt

  coach        Coach               @relation("coachAssignments", fields: [coachId], references: [id], onDelete: Cascade)
  club         Club                @relation("clubCoachAssignments", fields: [clubId], references: [id], onDelete: Cascade)
  team         Team?               @relation("teamCoachAssignments", fields: [teamId], references: [id], onDelete: SetNull)
  season       Season?             @relation("seasonCoachAssignments", fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([coachId])
  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([isActive])
  @@map("coach_assignments")
}

model CoachCertification {
  id               String              @id @default(cuid())
  coachId          String
  name             String
  issuingBody      String
  level            String?
  certificationId  String?
  issueDate        DateTime
  expiryDate       DateTime?
  status           CertificationStatus @default(ACTIVE)
  documentUrl      String?
  verificationUrl  String?
  notes            String?
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt

  coach            Coach               @relation("coachCertifications", fields: [coachId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([status])
  @@index([expiryDate])
  @@map("coach_certifications")
}

model CoachPerformanceReview {
  id              String   @id @default(cuid())
  coachId         String
  clubId          String
  reviewerId      String
  reviewPeriod    String
  overallRating   Float
  technicalRating Float?
  communicationRating Float?
  leadershipRating Float?
  organizationRating Float?
  strengths       String[]
  areasForImprovement String[]
  goals           String[]
  comments        String?  @db.Text
  coachResponse   String?  @db.Text
  acknowledgedAt  DateTime?
  reviewDate      DateTime
  nextReviewDate  DateTime?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  coach           Coach    @relation("coachReviews", fields: [coachId], references: [id], onDelete: Cascade)
  club            Club     @relation("clubCoachReviews", fields: [clubId], references: [id], onDelete: Cascade)

  @@index([coachId])
  @@index([clubId])
  @@index([reviewDate])
  @@map("coach_performance_reviews")
}

model Referee {
  id              String                 @id @default(cuid())
  userId          String                 @unique
  licenseNumber   String?                @unique
  licenseLevel    RefereeLevel           @default(GRASSROOTS)
  licensingBody   String?
  licenseExpiry   DateTime?
  sports          Sport[]
  experience      Int?
  specializations String[]
  biography       String?                @db.Text
  isActive        Boolean                @default(true)
  rating          Float?
  matchCount      Int                    @default(0)
  matchFee        Float?
  currency        String                 @default("GBP")
  travelRate      Float?
  availability    Json?
  blackoutDates   DateTime[]
  maxDistance     Int?
  createdAt       DateTime               @default(now())
  updatedAt       DateTime               @updatedAt

  user            User                   @relation(fields: [userId], references: [id], onDelete: Cascade)
  matchOfficials  MatchOfficial[]
  availability_   RefereeAvailability[]
  qualifications  RefereeQualification[]
  payments        RefereePayment[]
  matchReports    RefereeMatchReport[]

  @@index([userId])
  @@index([isActive])
  @@index([licenseLevel])
  @@map("referees")
}

model RefereeAvailability {
  id        String                    @id @default(cuid())
  refereeId String
  date      DateTime
  status    RefereeAvailabilityStatus @default(AVAILABLE)
  notes     String?
  createdAt DateTime                  @default(now())
  updatedAt DateTime                  @updatedAt

  referee   Referee                   @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@unique([refereeId, date])
  @@index([refereeId])
  @@index([date])
  @@index([status])
  @@map("referee_availability")
}

model RefereeQualification {
  id          String   @id @default(cuid())
  refereeId   String
  name        String
  issuingBody String
  issueDate   DateTime
  expiryDate  DateTime?
  documentUrl String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  referee     Referee  @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([expiryDate])
  @@map("referee_qualifications")
}

model RefereePayment {
  id            String        @id @default(cuid())
  refereeId     String
  matchId       String?
  amount        Float
  currency      String        @default("GBP")
  type          PaymentType   @default(REFEREE_FEE)
  status        PaymentStatus @default(PENDING)
  expenses      Float?
  expenseDetails Json?
  paidAt        DateTime?
  paymentMethod String?
  reference     String?
  notes         String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  referee       Referee       @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@index([refereeId])
  @@index([matchId])
  @@index([status])
  @@map("referee_payments")
}

model RefereeMatchReport {
  id               String   @id @default(cuid())
  refereeId        String
  matchId          String
  homeTeamConduct  Int?
  awayTeamConduct  Int?
  pitchCondition   Int?
  facilityRating   Int?
  incidents        Json?
  disciplinaryNotes String?  @db.Text
  generalComments  String?  @db.Text
  submittedAt      DateTime?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  referee          Referee  @relation(fields: [refereeId], references: [id], onDelete: Cascade)

  @@unique([refereeId, matchId])
  @@index([refereeId])
  @@index([matchId])
  @@map("referee_match_reports")
}

model Scout {
  id                  String               @id @default(cuid())
  userId              String               @unique
  organization        String?
  regions             String[]
  specializations     String[]
  sports              Sport[]
  experience          Int?
  biography           String?              @db.Text
  isActive            Boolean              @default(true)
  rating              Float?
  reportsCount        Int                  @default(0)
  playersRecommended  Int                  @default(0)
  successfulSignings  Int                  @default(0)
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt

  user                User                 @relation(fields: [userId], references: [id], onDelete: Cascade)
  reports             ScoutingReport[]
  watchlist           ScoutWatchlist[]
  matchAttendance     ScoutMatchAttendance[]

  @@index([userId])
  @@index([isActive])
  @@map("scouts")
}

model ScoutWatchlist {
  id               String            @id @default(cuid())
  scoutId          String
  playerId         String
  status           WatchlistStatus   @default(MONITORING)
  priority         WatchlistPriority @default(MEDIUM)
  notes            String?           @db.Text
  targetPosition   Position?
  estimatedValue   Float?
  currency         String            @default("GBP")
  lastViewedAt     DateTime?
  alertsEnabled    Boolean           @default(true)
  addedAt          DateTime          @default(now())
  updatedAt        DateTime          @updatedAt

  scout            Scout             @relation(fields: [scoutId], references: [id], onDelete: Cascade)
  player           Player            @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([scoutId, playerId])
  @@index([scoutId])
  @@index([playerId])
  @@index([status])
  @@index([priority])
  @@map("scout_watchlists")
}

model ScoutMatchAttendance {
  id        String   @id @default(cuid())
  scoutId   String
  matchId   String
  attended  Boolean  @default(true)
  notes     String?  @db.Text
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  scout     Scout    @relation(fields: [scoutId], references: [id], onDelete: Cascade)

  @@unique([scoutId, matchId])
  @@index([scoutId])
  @@index([matchId])
  @@map("scout_match_attendance")
}

model Analyst {
  id             String   @id @default(cuid())
  userId         String   @unique
  specialization String[]
  tools          String[]
  experience     Int?
  biography      String?  @db.Text
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("analysts")
}

model ClubManager {
  id        String   @id @default(cuid())
  userId    String   @unique
  clubId    String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([clubId])
  @@map("club_managers")
}

model ClubOwner {
  id        String   @id @default(cuid())
  userId    String   @unique
  clubId    String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([clubId])
  @@map("club_owners")
}

model Parent {
  id                 String              @id @default(cuid())
  userId             String              @unique
  occupation         String?
  isEmergencyContact Boolean             @default(true)
  isActive           Boolean             @default(true)
  children           PlayerFamily[]      @relation("parentChildren")
  portalAccess       ParentPortalAccess[] @relation("parentPortalAccess")
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt

  user               User                @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("parents")
}

model Treasurer {
  id        String   @id @default(cuid())
  userId    String   @unique
  clubId    String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([clubId])
  @@map("treasurers")
}

// =============================================================================
// üë• SOCIAL MODELS
// =============================================================================

model Follow {
  id          String   @id @default(cuid())
  followerId  String
  followingId String
  createdAt   DateTime @default(now())

  follower    User     @relation("follower", fields: [followerId], references: [id], onDelete: Cascade)
  following   User     @relation("following", fields: [followingId], references: [id], onDelete: Cascade)

  @@unique([followerId, followingId])
  @@index([followerId])
  @@index([followingId])
  @@map("follows")
}

model UserBlock {
  id        String   @id @default(cuid())
  blockerId String
  blockedId String
  reason    String?
  createdAt DateTime @default(now())

  blocker   User     @relation("blocker", fields: [blockerId], references: [id], onDelete: Cascade)
  blocked   User     @relation("blocked", fields: [blockedId], references: [id], onDelete: Cascade)

  @@unique([blockerId, blockedId])
  @@index([blockerId])
  @@index([blockedId])
  @@map("user_blocks")
}

model SocialAction {
  id         String   @id @default(cuid())
  userId     String
  actionType String
  targetType String
  targetId   String
  metadata   Json?
  createdAt  DateTime @default(now())

  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([actionType])
  @@index([targetType, targetId])
  @@map("social_actions")
}

model Achievement {
  id          String    @id @default(cuid())
  userId      String
  playerId    String?
  name        String
  description String?
  category    String
  icon        String?
  points      Int       @default(0)
  unlockedAt  DateTime  @default(now())
  metadata    Json?

  user        User      @relation("achievementUser", fields: [userId], references: [id], onDelete: Cascade)
  player      Player?   @relation("achievementPlayer", fields: [playerId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([playerId])
  @@index([category])
  @@map("achievements")
}

model Badge {
  id          String    @id @default(cuid())
  userId      String
  playerId    String?
  name        String
  description String?
  icon        String?
  tier        String    @default("BRONZE")
  earnedAt    DateTime  @default(now())
  expiresAt   DateTime?
  metadata    Json?

  user        User      @relation("badgeUser", fields: [userId], references: [id], onDelete: Cascade)
  player      Player?   @relation("badgePlayer", fields: [playerId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([playerId])
  @@index([tier])
  @@map("badges")
}

model PerformanceGoal {
  id           String     @id @default(cuid())
  userId       String
  playerId     String?
  creatorId    String
  type         GoalType   @default(PERFORMANCE)
  title        String
  description  String?    @db.Text
  metric       String?
  targetValue  Float?
  currentValue Float?
  unit         String?
  startDate    DateTime
  endDate      DateTime?
  status       GoalStatus @default(NOT_STARTED)
  progress     Float      @default(0)
  completedAt  DateTime?
  notes        String?
  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt

  user         User       @relation("goalUser", fields: [userId], references: [id], onDelete: Cascade)
  player       Player?    @relation("goalPlayer", fields: [playerId], references: [id], onDelete: SetNull)
  creator      User       @relation("goalCreator", fields: [creatorId], references: [id])

  @@index([userId])
  @@index([playerId])
  @@index([status])
  @@index([endDate])
  @@map("performance_goals")
}

// =============================================================================
// üîî NOTIFICATION & CHAT MODELS
// =============================================================================

model Notification {
  id        String           @id @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  data      Json?
  isRead    Boolean          @default(false)
  readAt    DateTime?
  link      String?
  priority  String           @default("NORMAL")
  expiresAt DateTime?
  createdAt DateTime         @default(now())

  user      User             @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([type])
  @@index([isRead])
  @@index([createdAt])
  @@map("notifications")
}

model NotificationPreference {
  id                  String   @id @default(cuid())
  userId              String   @unique
  emailEnabled        Boolean  @default(true)
  pushEnabled         Boolean  @default(true)
  smsEnabled          Boolean  @default(false)
  matchReminders      Boolean  @default(true)
  trainingReminders   Boolean  @default(true)
  teamUpdates         Boolean  @default(true)
  performanceAlerts   Boolean  @default(true)
  marketingEmails     Boolean  @default(false)
  weeklyDigest        Boolean  @default(true)
  quietHoursStart     String?
  quietHoursEnd       String?
  timezone            String   @default("Europe/London")
  disabledTypes       String[]
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  user                User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("notification_preferences")
}

model Chat {
  id          String       @id @default(cuid())
  type        ChatType     @default(DIRECT)
  name        String?
  description String?
  avatar      String?
  createdBy   String
  isActive    Boolean      @default(true)
  lastMessage DateTime?
  metadata    Json?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  creator     User         @relation("chatCreator", fields: [createdBy], references: [id])
  members     ChatMember[]
  messages    Message[]

  @@index([type])
  @@index([createdBy])
  @@index([lastMessage])
  @@map("chats")
}

model ChatMember {
  id         String    @id @default(cuid())
  chatId     String
  userId     String
  role       String    @default("MEMBER")
  joinedAt   DateTime  @default(now())
  leftAt     DateTime?
  lastReadAt DateTime?
  isMuted    Boolean   @default(false)
  mutedUntil DateTime?

  chat       Chat      @relation(fields: [chatId], references: [id], onDelete: Cascade)
  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([chatId, userId])
  @@index([chatId])
  @@index([userId])
  @@map("chat_members")
}

model Message {
  id          String   @id @default(cuid())
  chatId      String
  senderId    String
  content     String   @db.Text
  type        String   @default("TEXT")
  attachments String[]
  replyToId   String?
  isEdited    Boolean  @default(false)
  editedAt    DateTime?
  isDeleted   Boolean  @default(false)
  deletedAt   DateTime?
  readBy      String[]
  reactions   Json?
  metadata    Json?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  chat        Chat     @relation(fields: [chatId], references: [id], onDelete: Cascade)
  sender      User     @relation(fields: [senderId], references: [id], onDelete: Cascade)

  @@index([chatId])
  @@index([senderId])
  @@index([createdAt])
  @@map("messages")
}

// =============================================================================
// üè¢ VENUE & FACILITY MODELS
// =============================================================================

model Venue {
  id               String        @id @default(cuid())
  organisationId   String?
  clubId           String?
  name             String
  shortName        String?
  type             VenueType     @default(STADIUM)
  address          String?
  city             String?
  region           String?
  country          String?
  postcode         String?
  latitude         Float?
  longitude        Float?
  capacity         Int?
  seatedCapacity   Int?
  standingCapacity Int?
  pitchDimensions  String?
  surfaceType      String?
  yearBuilt        Int?
  facilities       String[]
  images           String[]
  website          String?
  phone            String?
  email            String?
  accessibility    Json?
  parkingSpaces    Int?
  publicTransport  String?
  isActive         Boolean       @default(true)
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt

  organisation     Organisation? @relation("organisationVenues", fields: [organisationId], references: [id], onDelete: SetNull)
  club             Club?         @relation("clubVenues", fields: [clubId], references: [id], onDelete: SetNull)
  facilityList     Facility[]
  bookings         FacilityBooking[]

  @@index([organisationId])
  @@index([clubId])
  @@index([type])
  @@index([city])
  @@map("venues")
}

model Facility {
  id             String            @id @default(cuid())
  organisationId String
  venueId        String?
  name           String
  type           FacilityType
  description    String?           @db.Text
  capacity       Int?
  hourlyRate     Float?
  dailyRate      Float?
  currency       String            @default("GBP")
  dimensions     String?
  surfaceType    String?
  equipment      String[]
  amenities      String[]
  images         String[]
  rules          String[]
  openingHours   Json?
  isIndoor       Boolean           @default(false)
  hasLighting    Boolean           @default(false)
  isActive       Boolean           @default(true)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  organisation   Organisation      @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  venue          Venue?            @relation(fields: [venueId], references: [id], onDelete: SetNull)
  bookings       FacilityBooking[]

  @@index([organisationId])
  @@index([venueId])
  @@index([type])
  @@index([isActive])
  @@map("facilities")
}

model FacilityBooking {
  id           String        @id @default(cuid())
  facilityId   String
  venueId      String?
  bookedBy     String
  bookingType  String
  title        String?
  description  String?
  startTime    DateTime
  endTime      DateTime
  status       BookingStatus @default(PENDING)
  totalCost    Float?
  currency     String        @default("GBP")
  isPaid       Boolean       @default(false)
  paidAt       DateTime?
  notes        String?
  attendees    Int?
  equipment    String[]
  cancelledAt  DateTime?
  cancelReason String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt

  facility     Facility      @relation(fields: [facilityId], references: [id], onDelete: Cascade)
  venue        Venue?        @relation(fields: [venueId], references: [id], onDelete: SetNull)

  @@index([facilityId])
  @@index([venueId])
  @@index([bookedBy])
  @@index([startTime])
  @@index([status])
  @@map("facility_bookings")
}

// =============================================================================
// üí≥ BILLING MODELS
// =============================================================================

model Subscription {
  id                   String             @id @default(cuid())
  userId               String
  organisationId       String?
  stripeCustomerId     String?
  stripeSubscriptionId String?            @unique
  stripePriceId        String?
  tier                 AccountTier        @default(FREE)
  status               SubscriptionStatus @default(ACTIVE)
  currentPeriodStart   DateTime?
  currentPeriodEnd     DateTime?
  cancelAtPeriodEnd    Boolean            @default(false)
  cancelledAt          DateTime?
  trialStart           DateTime?
  trialEnd             DateTime?
  metadata             Json?
  createdAt            DateTime           @default(now())
  updatedAt            DateTime           @updatedAt

  user                 User               @relation(fields: [userId], references: [id], onDelete: Cascade)
  organisation         Organisation?      @relation(fields: [organisationId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([status])
  @@index([stripeCustomerId])
  @@map("subscriptions")
}

model Payment {
  id              String        @id @default(cuid())
  userId          String
  stripePaymentId String?       @unique
  stripeChargeId  String?
  amount          Float
  currency        String        @default("GBP")
  type            PaymentType   @default(SUBSCRIPTION)
  status          PaymentStatus @default(PENDING)
  description     String?
  invoiceId       String?
  receiptUrl      String?
  failureReason   String?
  refundedAmount  Float?
  refundedAt      DateTime?
  refundReason    String?
  metadata        Json?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([type])
  @@index([createdAt])
  @@map("payments")
}

model Invoice {
  id              String        @id @default(cuid())
  userId          String
  stripeInvoiceId String?       @unique
  number          String?       @unique
  amount          Float
  currency        String        @default("GBP")
  status          PaymentStatus @default(PENDING)
  dueDate         DateTime?
  paidAt          DateTime?
  description     String?
  lineItems       Json?
  pdfUrl          String?
  hostedUrl       String?
  metadata        Json?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  user            User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@index([dueDate])
  @@map("invoices")
}

// =============================================================================
// üîå API & INTEGRATION MODELS
// =============================================================================

model Webhook {
  id             String            @id @default(cuid())
  organisationId String
  name           String
  url            String
  secret         String?
  events         WebhookEvent[]
  isActive       Boolean           @default(true)
  headers        Json?
  retryCount     Int               @default(3)
  retryDelay     Int               @default(60)
  lastTriggered  DateTime?
  lastStatus     Int?
  failureCount   Int               @default(0)
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  organisation   Organisation      @relation(fields: [organisationId], references: [id], onDelete: Cascade)
  deliveries     WebhookDelivery[]

  @@index([organisationId])
  @@index([isActive])
  @@map("webhooks")
}

model WebhookDelivery {
  id          String   @id @default(cuid())
  webhookId   String
  event       String
  payload     Json
  statusCode  Int?
  response    String?  @db.Text
  duration    Int?
  attempts    Int      @default(1)
  success     Boolean  @default(false)
  error       String?
  deliveredAt DateTime?
  nextRetry   DateTime?
  createdAt   DateTime @default(now())

  webhook     Webhook  @relation(fields: [webhookId], references: [id], onDelete: Cascade)

  @@index([webhookId])
  @@index([event])
  @@index([success])
  @@index([createdAt])
  @@map("webhook_deliveries")
}

model ApiUsageMetrics {
  id             String       @id @default(cuid())
  organisationId String
  date           DateTime     @db.Date
  endpoint       String
  method         String
  statusCode     Int
  count          Int          @default(1)
  totalDuration  Int          @default(0)
  avgDuration    Float?
  errorCount     Int          @default(0)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  organisation   Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@unique([organisationId, date, endpoint, method, statusCode])
  @@index([organisationId])
  @@index([date])
  @@index([endpoint])
  @@map("api_usage_metrics")
}

model QuotaUsage {
  id             String       @id @default(cuid())
  organisationId String
  resourceType   String
  used           Int          @default(0)
  limit          Int
  periodStart    DateTime
  periodEnd      DateTime
  alertSent      Boolean      @default(false)
  alertSentAt    DateTime?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  organisation   Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@unique([organisationId, resourceType, periodStart])
  @@index([organisationId])
  @@index([resourceType])
  @@index([periodEnd])
  @@map("quota_usage")
}

model DatabaseBackup {
  id             String       @id @default(cuid())
  organisationId String
  filename       String
  size           Int
  type           String       @default("FULL")
  status         String       @default("COMPLETED")
  startedAt      DateTime
  completedAt    DateTime?
  storageUrl     String?
  checksum       String?
  retainUntil    DateTime?
  createdAt      DateTime     @default(now())

  organisation   Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([organisationId])
  @@index([type])
  @@index([status])
  @@index([createdAt])
  @@map("database_backups")
}

// =============================================================================
// üíº JOB POSTING MODELS
// =============================================================================

model JobPosting {
  id                  String             @id @default(cuid())
  clubId              String
  creatorId           String
  title               String
  description         String             @db.Text
  category            JobCategory        @default(OTHER)
  employmentType      EmploymentType     @default(FULL_TIME)
  experienceLevel     ExperienceLevel    @default(MID)
  salary              Float?
  salaryMax           Float?
  currency            String             @default("GBP")
  salaryPeriod        String             @default("ANNUAL")
  showSalary          Boolean            @default(false)
  location            String?
  isRemote            Boolean            @default(false)
  requirements        String[]
  responsibilities    String[]
  benefits            String[]
  skills              String[]
  qualifications      String[]
  applicationUrl      String?
  applicationEmail    String?
  applicationDeadline DateTime?
  startDate           DateTime?
  status              JobPostingStatus   @default(DRAFT)
  publishedAt         DateTime?
  closedAt            DateTime?
  viewCount           Int                @default(0)
  applicationCount    Int                @default(0)
  featuredUntil       DateTime?
  deletedAt           DateTime?
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt

  club                Club               @relation(fields: [clubId], references: [id], onDelete: Cascade)
  creator             User               @relation("jobCreator", fields: [creatorId], references: [id])
  applications        JobApplication[]

  @@index([clubId])
  @@index([creatorId])
  @@index([status])
  @@index([category])
  @@index([publishedAt])
  @@index([deletedAt])
  @@map("job_postings")
}

model JobApplication {
  id              String               @id @default(cuid())
  jobId           String
  applicantId     String
  coverLetter     String?              @db.Text
  resumeUrl       String?
  linkedinUrl     String?
  portfolioUrl    String?
  availability    String?
  salaryExpected  Float?
  currency        String               @default("GBP")
  noticePeriod    String?
  answers         Json?
  status          JobApplicationStatus @default(PENDING)
  reviewerId      String?
  reviewedAt      DateTime?
  reviewNotes     String?
  interviewDate   DateTime?
  interviewNotes  String?
  offerDate       DateTime?
  offerAmount     Float?
  offerAcceptedAt DateTime?
  rejectionReason String?
  withdrawnAt     DateTime?
  withdrawnReason String?
  createdAt       DateTime             @default(now())
  updatedAt       DateTime             @updatedAt

  job             JobPosting           @relation(fields: [jobId], references: [id], onDelete: Cascade)
  applicant       User                 @relation("applicant", fields: [applicantId], references: [id], onDelete: Cascade)
  reviewer        User?                @relation("applicationReviewer", fields: [reviewerId], references: [id], onDelete: SetNull)

  @@unique([jobId, applicantId])
  @@index([jobId])
  @@index([applicantId])
  @@index([status])
  @@index([reviewerId])
  @@map("job_applications")
}

// =============================================================================
// üì¢ ANNOUNCEMENT & SPONSOR MODELS
// =============================================================================

model Announcement {
  id               String               @id @default(cuid())
  clubId           String
  creatorId        String
  title            String
  content          String               @db.Text
  summary          String?
  imageUrl         String?
  attachments      String[]
  category         String               @default("GENERAL")
  priority         AnnouncementPriority @default(NORMAL)
  status           AnnouncementStatus   @default(DRAFT)
  targetAudience   String[]
  targetTeams      String[]
  publishAt        DateTime?
  expiresAt        DateTime?
  publishedAt      DateTime?
  viewCount        Int                  @default(0)
  acknowledgments  Int                  @default(0)
  requireAck       Boolean              @default(false)
  isPinned         Boolean              @default(false)
  sendNotification Boolean              @default(true)
  deletedAt        DateTime?
  createdAt        DateTime             @default(now())
  updatedAt        DateTime             @updatedAt

  club             Club                 @relation(fields: [clubId], references: [id], onDelete: Cascade)
  creator          User                 @relation("announcementCreator", fields: [creatorId], references: [id])

  @@index([clubId])
  @@index([creatorId])
  @@index([status])
  @@index([priority])
  @@index([publishAt])
  @@index([deletedAt])
  @@map("announcements")
}

model Sponsor {
  id             String       @id @default(cuid())
  organisationId String
  name           String
  logo           String?
  website        String?
  tier           String       @default("STANDARD")
  contractStart  DateTime?
  contractEnd    DateTime?
  value          Float?
  currency       String       @default("GBP")
  benefits       String[]
  contactName    String?
  contactEmail   String?
  contactPhone   String?
  isActive       Boolean      @default(true)
  notes          String?      @db.Text
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  organisation   Organisation @relation(fields: [organisationId], references: [id], onDelete: Cascade)

  @@index([organisationId])
  @@index([tier])
  @@index([isActive])
  @@map("sponsors")
}

// =============================================================================
// üí∞ BUDGET & EXPENSE SYSTEM (v7.7.0)
// =============================================================================

model Budget {
  id              String           @id @default(cuid())
  organisationId  String?
  clubId          String?
  teamId          String?
  seasonId        String?
  createdById     String
  name            String
  description     String?          @db.Text
  periodType      BudgetPeriodType @default(SEASON)
  periodStart     DateTime
  periodEnd       DateTime
  totalAmount     Float
  allocatedAmount Float            @default(0)
  spentAmount     Float            @default(0)
  remainingAmount Float            @default(0)
  currency        String           @default("GBP")
  status          BudgetStatus     @default(DRAFT)
  alertThreshold  Float?
  alertSent       Boolean          @default(false)
  notes           String?          @db.Text
  deletedAt       DateTime?
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt

  organisation    Organisation?    @relation(fields: [organisationId], references: [id], onDelete: SetNull)
  club            Club?            @relation("clubBudgets", fields: [clubId], references: [id], onDelete: Cascade)
  team            Team?            @relation("teamBudgets", fields: [teamId], references: [id], onDelete: SetNull)
  season          Season?          @relation(fields: [seasonId], references: [id], onDelete: SetNull)
  createdBy       User             @relation("budgetsCreated", fields: [createdById], references: [id])
  categories      BudgetCategory[]
  expenses        Expense[]

  @@index([organisationId])
  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([status])
  @@index([deletedAt])
  @@map("budgets")
}

model BudgetCategory {
  id              String   @id @default(cuid())
  budgetId        String
  category        ExpenseCategory
  allocatedAmount Float
  spentAmount     Float    @default(0)
  remainingAmount Float    @default(0)
  alertThreshold  Float?
  notes           String?
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  budget          Budget   @relation(fields: [budgetId], references: [id], onDelete: Cascade)

  @@unique([budgetId, category])
  @@index([budgetId])
  @@index([category])
  @@map("budget_categories")
}

model Expense {
  id              String          @id @default(cuid())
  budgetId        String?
  clubId          String?
  teamId          String?
  createdById     String
  approvedById    String?
  category        ExpenseCategory
  title           String
  description     String?         @db.Text
  amount          Float
  currency        String          @default("GBP")
  date            DateTime
  vendor          String?
  reference       String?
  receiptUrl      String?
  attachments     String[]
  status          ExpenseStatus   @default(DRAFT)
  submittedAt     DateTime?
  approvedAt      DateTime?
  rejectedAt      DateTime?
  rejectionReason String?
  paidAt          DateTime?
  paymentMethod   String?
  paymentReference String?
  reimbursedAt    DateTime?
  reimbursementMethod String?
  notes           String?         @db.Text
  deletedAt       DateTime?
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt

  budget          Budget?         @relation(fields: [budgetId], references: [id], onDelete: SetNull)
  club            Club?           @relation("clubExpenses", fields: [clubId], references: [id], onDelete: Cascade)
  team            Team?           @relation("teamExpenses", fields: [teamId], references: [id], onDelete: SetNull)
  createdBy       User            @relation("expensesCreated", fields: [createdById], references: [id])
  approvedBy      User?           @relation("expensesApproved", fields: [approvedById], references: [id], onDelete: SetNull)

  @@index([budgetId])
  @@index([clubId])
  @@index([teamId])
  @@index([category])
  @@index([status])
  @@index([date])
  @@index([deletedAt])
  @@map("expenses")
}

// =============================================================================
// üìà PLAYER DEVELOPMENT SYSTEM (v7.8.0)
// =============================================================================

model PlayerDevelopmentPlan {
  id              String            @id @default(cuid())
  playerId        String
  coachId         String
  clubId          String?
  title           String
  description     String?           @db.Text
  phase           DevelopmentPhase  @default(FOUNDATION)
  startDate       DateTime
  endDate         DateTime?
  status          MilestoneStatus   @default(IN_PROGRESS)
  progress        Float             @default(0)
  goals           String[]
  focusAreas      String[]
  notes           String?           @db.Text
  completedAt     DateTime?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt

  player          Player            @relation("playerDevelopmentPlans", fields: [playerId], references: [id], onDelete: Cascade)
  coach           Coach             @relation("coachDevelopmentPlans", fields: [coachId], references: [id], onDelete: Cascade)
  club            Club?             @relation("clubDevelopmentPlans", fields: [clubId], references: [id], onDelete: SetNull)
  milestones      SkillMilestone[]
  assessments     SkillAssessment[]

  @@index([playerId])
  @@index([coachId])
  @@index([clubId])
  @@index([status])
  @@map("player_development_plans")
}

model SkillAssessment {
  id                String                @id @default(cuid())
  playerId          String
  coachId           String
  developmentPlanId String?
  category          SkillCategory
  skillName         String
  currentLevel      Int
  targetLevel       Int
  progress          Float                 @default(0)
  notes             String?               @db.Text
  assessmentDate    DateTime
  nextAssessmentDate DateTime?
  createdAt         DateTime              @default(now())
  updatedAt         DateTime              @updatedAt

  player            Player                @relation("playerSkillAssessments", fields: [playerId], references: [id], onDelete: Cascade)
  coach             Coach                 @relation("coachSkillAssessments", fields: [coachId], references: [id], onDelete: Cascade)
  developmentPlan   PlayerDevelopmentPlan? @relation(fields: [developmentPlanId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([coachId])
  @@index([developmentPlanId])
  @@index([category])
  @@map("skill_assessments")
}

model SkillMilestone {
  id                String                @id @default(cuid())
  playerId          String
  developmentPlanId String?
  title             String
  description       String?               @db.Text
  targetDate        DateTime?
  status            MilestoneStatus       @default(NOT_STARTED)
  completedAt       DateTime?
  notes             String?
  createdAt         DateTime              @default(now())
  updatedAt         DateTime              @updatedAt

  player            Player                @relation("playerMilestones", fields: [playerId], references: [id], onDelete: Cascade)
  developmentPlan   PlayerDevelopmentPlan? @relation(fields: [developmentPlanId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([developmentPlanId])
  @@index([status])
  @@map("skill_milestones")
}

model MentorshipAssignment {
  id          String   @id @default(cuid())
  mentorId    String
  menteeId    String
  clubId      String?
  startDate   DateTime
  endDate     DateTime?
  goals       String[]
  focusAreas  String[]
  meetingFrequency String?
  notes       String?  @db.Text
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  mentor      Player   @relation("mentorAssignments", fields: [mentorId], references: [id], onDelete: Cascade)
  mentee      Player   @relation("menteeAssignments", fields: [menteeId], references: [id], onDelete: Cascade)
  club        Club?    @relation("clubMentorships", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([mentorId])
  @@index([menteeId])
  @@index([clubId])
  @@index([isActive])
  @@map("mentorship_assignments")
}

// =============================================================================
// üè• WELLNESS & RECOVERY MODELS (v7.8.0)
// =============================================================================

model WellnessCheck {
  id                String           @id @default(cuid())
  playerId          String
  date              DateTime
  category          WellnessCategory @default(PHYSICAL)
  overallScore      Int
  energyLevel       Int?
  sleepQuality      Int?
  stressLevel       Int?
  muscleRecovery    Int?
  mentalWellbeing   Int?
  appetiteLevel     Int?
  hydrationLevel    Int?
  notes             String?          @db.Text
  flagged           Boolean          @default(false)
  flagReason        String?
  followUpRequired  Boolean          @default(false)
  followUpNotes     String?
  createdAt         DateTime         @default(now())
  updatedAt         DateTime         @updatedAt

  player            Player           @relation("playerWellnessChecks", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([date])
  @@index([category])
  @@index([flagged])
  @@map("wellness_checks")
}

model RecoveryProtocol {
  id               String        @id @default(cuid())
  playerId         String
  injuryId         String?
  title            String
  description      String?       @db.Text
  phase            RecoveryPhase @default(ACUTE)
  startDate        DateTime
  endDate          DateTime?
  targetDate       DateTime?
  exercises        Json?
  restrictions     String[]
  medications      String[]
  progress         Float         @default(0)
  lastReviewDate   DateTime?
  nextReviewDate   DateTime?
  reviewedBy       String?
  notes            String?       @db.Text
  isActive         Boolean       @default(true)
  completedAt      DateTime?
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt

  player           Player        @relation("playerRecoveryProtocols", fields: [playerId], references: [id], onDelete: Cascade)
  injury           Injury?       @relation("injuryRecoveryProtocols", fields: [injuryId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([injuryId])
  @@index([phase])
  @@index([isActive])
  @@map("recovery_protocols")
}

model NutritionPlan {
  id               String   @id @default(cuid())
  playerId         String
  title            String
  description      String?  @db.Text
  calorieTarget    Int?
  proteinTarget    Int?
  carbTarget       Int?
  fatTarget        Int?
  mealPlan         Json?
  supplements      String[]
  restrictions     String[]
  allergies        String[]
  startDate        DateTime
  endDate          DateTime?
  isActive         Boolean  @default(true)
  notes            String?  @db.Text
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  player           Player   @relation("playerNutritionPlans", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([isActive])
  @@map("nutrition_plans")
}

model SleepLog {
  id             String   @id @default(cuid())
  playerId       String
  date           DateTime
  bedtime        DateTime?
  wakeTime       DateTime?
  totalHours     Float?
  quality        Int?
  deepSleep      Float?
  remSleep       Float?
  awakenings     Int?
  restfulness    Int?
  notes          String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  player         Player   @relation("playerSleepLogs", fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
  @@index([date])
  @@map("sleep_logs")
}

// =============================================================================
// üë®‚Äçüë©‚Äçüëß PARENT PORTAL & TEAM COMMUNICATION (v7.8.0)
// =============================================================================

model ParentPortalAccess {
  id             String   @id @default(cuid())
  parentId       String
  playerId       String
  clubId         String?
  canViewSchedule Boolean @default(true)
  canViewAttendance Boolean @default(true)
  canViewPerformance Boolean @default(false)
  canViewMedical Boolean  @default(false)
  canViewFinancial Boolean @default(false)
  canCommunicate Boolean  @default(true)
  isActive       Boolean  @default(true)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  parent         Parent   @relation("parentPortalAccess", fields: [parentId], references: [id], onDelete: Cascade)
  player         Player   @relation("playerParentAccess", fields: [playerId], references: [id], onDelete: Cascade)
  club           Club?    @relation("clubParentAccess", fields: [clubId], references: [id], onDelete: SetNull)

  @@unique([parentId, playerId])
  @@index([parentId])
  @@index([playerId])
  @@index([clubId])
  @@map("parent_portal_access")
}

model TeamAnnouncement {
  id               String   @id @default(cuid())
  teamId           String
  clubId           String?
  createdById      String
  title            String
  content          String   @db.Text
  type             String   @default("GENERAL")
  priority         String   @default("NORMAL")
  requiresRSVP     Boolean  @default(false)
  rsvpDeadline     DateTime?
  attachments      String[]
  publishedAt      DateTime?
  expiresAt        DateTime?
  viewCount        Int      @default(0)
  deletedAt        DateTime?
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  team             Team     @relation("teamAnnouncements", fields: [teamId], references: [id], onDelete: Cascade)
  club             Club?    @relation("clubTeamAnnouncements", fields: [clubId], references: [id], onDelete: SetNull)
  createdBy        User     @relation("userTeamAnnouncements", fields: [createdById], references: [id])
  rsvps            EventRSVP[]

  @@index([teamId])
  @@index([clubId])
  @@index([createdById])
  @@index([deletedAt])
  @@map("team_announcements")
}

model EventRSVP {
  id               String     @id @default(cuid())
  userId           String
  announcementId   String
  status           RSVPStatus @default(PENDING)
  response         String?
  respondedAt      DateTime?
  createdAt        DateTime   @default(now())
  updatedAt        DateTime   @updatedAt

  user             User       @relation("userRSVPs", fields: [userId], references: [id], onDelete: Cascade)
  announcement     TeamAnnouncement @relation(fields: [announcementId], references: [id], onDelete: Cascade)

  @@unique([userId, announcementId])
  @@index([userId])
  @@index([announcementId])
  @@index([status])
  @@map("event_rsvps")
}

// =============================================================================
// üí≥ PAYMENT PLANS & SCHOLARSHIPS (v7.8.0)
// =============================================================================

model PaymentPlan {
  id               String            @id @default(cuid())
  userId           String
  clubId           String?
  title            String
  description      String?           @db.Text
  totalAmount      Float
  paidAmount       Float             @default(0)
  remainingAmount  Float
  currency         String            @default("GBP")
  status           PaymentPlanStatus @default(ACTIVE)
  startDate        DateTime
  endDate          DateTime?
  frequency        String            @default("MONTHLY")
  installmentAmount Float
  nextDueDate      DateTime?
  missedPayments   Int               @default(0)
  notes            String?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt

  user             User              @relation("userPaymentPlans", fields: [userId], references: [id], onDelete: Cascade)
  club             Club?             @relation("clubPaymentPlans", fields: [clubId], references: [id], onDelete: SetNull)
  installments     Installment[]

  @@index([userId])
  @@index([clubId])
  @@index([status])
  @@map("payment_plans")
}

model Installment {
  id            String        @id @default(cuid())
  paymentPlanId String
  amount        Float
  dueDate       DateTime
  paidAt        DateTime?
  status        PaymentStatus @default(PENDING)
  paymentMethod String?
  reference     String?
  notes         String?
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  paymentPlan   PaymentPlan   @relation(fields: [paymentPlanId], references: [id], onDelete: Cascade)

  @@index([paymentPlanId])
  @@index([dueDate])
  @@index([status])
  @@map("installments")
}

model FeeStructure {
  id            String   @id @default(cuid())
  clubId        String?
  teamId        String?
  name          String
  description   String?  @db.Text
  feeType       String
  amount        Float
  currency      String   @default("GBP")
  frequency     String   @default("MONTHLY")
  isActive      Boolean  @default(true)
  validFrom     DateTime?
  validTo       DateTime?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  club          Club?    @relation("clubFeeStructures", fields: [clubId], references: [id], onDelete: Cascade)
  team          Team?    @relation("teamFeeStructures", fields: [teamId], references: [id], onDelete: SetNull)

  @@index([clubId])
  @@index([teamId])
  @@index([isActive])
  @@map("fee_structures")
}

model Scholarship {
  id               String          @id @default(cuid())
  playerId         String
  clubId           String?
  seasonId         String?
  type             ScholarshipType @default(ATHLETIC)
  name             String
  description      String?         @db.Text
  amount           Float
  currency         String          @default("GBP")
  coveragePercent  Float?
  startDate        DateTime
  endDate          DateTime?
  requirements     String[]
  conditions       String[]
  status           String          @default("ACTIVE")
  awardedBy        String?
  awardedAt        DateTime?
  revokedAt        DateTime?
  revocationReason String?
  notes            String?         @db.Text
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt

  player           Player          @relation("playerScholarships", fields: [playerId], references: [id], onDelete: Cascade)
  club             Club?           @relation("clubScholarships", fields: [clubId], references: [id], onDelete: SetNull)
  season           Season?         @relation("seasonScholarships", fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([playerId])
  @@index([clubId])
  @@index([seasonId])
  @@index([type])
  @@index([status])
  @@map("scholarships")
}

// =============================================================================
// üéÆ GAMIFICATION SYSTEM (v7.8.0)
// =============================================================================

model Challenge {
  id               String            @id @default(cuid())
  clubId           String?
  name             String
  description      String?           @db.Text
  type             ChallengeType     @default(INDIVIDUAL)
  category         String
  metric           String
  targetValue      Float
  startDate        DateTime
  endDate          DateTime
  status           ChallengeStatus   @default(UPCOMING)
  pointsReward     Int               @default(0)
  badgeReward      String?
  rules            String[]
  eligibleRoles    String[]
  minParticipants  Int?
  maxParticipants  Int?
  isPublic         Boolean           @default(true)
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt

  club             Club?             @relation("clubChallenges", fields: [clubId], references: [id], onDelete: SetNull)
  participants     ChallengeParticipant[]

  @@index([clubId])
  @@index([type])
  @@index([status])
  @@index([startDate])
  @@index([endDate])
  @@map("challenges")
}

model ChallengeParticipant {
  id           String    @id @default(cuid())
  challengeId  String
  userId       String
  playerId     String?
  currentValue Float     @default(0)
  progress     Float     @default(0)
  isCompleted  Boolean   @default(false)
  completedAt  DateTime?
  rank         Int?
  pointsEarned Int       @default(0)
  joinedAt     DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  challenge    Challenge @relation(fields: [challengeId], references: [id], onDelete: Cascade)
  user         User      @relation("userChallenges", fields: [userId], references: [id], onDelete: Cascade)
  player       Player?   @relation("playerChallenges", fields: [playerId], references: [id], onDelete: SetNull)

  @@unique([challengeId, userId])
  @@index([challengeId])
  @@index([userId])
  @@index([playerId])
  @@index([isCompleted])
  @@map("challenge_participants")
}

model Leaderboard {
  id           String          @id @default(cuid())
  clubId       String?
  teamId       String?
  seasonId     String?
  type         LeaderboardType @default(RATING)
  scope        LeaderboardScope @default(CLUB)
  name         String
  description  String?
  metric       String
  sortOrder    String          @default("DESC")
  isActive     Boolean         @default(true)
  lastUpdated  DateTime        @default(now())
  createdAt    DateTime        @default(now())
  updatedAt    DateTime        @updatedAt

  club         Club?           @relation("clubLeaderboards", fields: [clubId], references: [id], onDelete: SetNull)
  team         Team?           @relation("teamLeaderboards", fields: [teamId], references: [id], onDelete: SetNull)
  season       Season?         @relation("seasonLeaderboards", fields: [seasonId], references: [id], onDelete: SetNull)
  entries      LeaderboardEntry[]

  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([type])
  @@index([isActive])
  @@map("leaderboards")
}

model LeaderboardEntry {
  id            String      @id @default(cuid())
  leaderboardId String
  playerId      String
  rank          Int
  previousRank  Int?
  value         Float
  change        Float       @default(0)
  updatedAt     DateTime    @updatedAt

  leaderboard   Leaderboard @relation(fields: [leaderboardId], references: [id], onDelete: Cascade)
  player        Player      @relation("playerLeaderboardEntries", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([leaderboardId, playerId])
  @@index([leaderboardId])
  @@index([playerId])
  @@index([rank])
  @@map("leaderboard_entries")
}

model Streak {
  id           String   @id @default(cuid())
  playerId     String
  type         String
  currentCount Int      @default(0)
  bestCount    Int      @default(0)
  startDate    DateTime?
  lastDate     DateTime?
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  player       Player   @relation("playerStreaks", fields: [playerId], references: [id], onDelete: Cascade)

  @@unique([playerId, type])
  @@index([playerId])
  @@index([type])
  @@index([isActive])
  @@map("streaks")
}

model TeamChemistry {
  id           String   @id @default(cuid())
  teamId       String
  seasonId     String?
  overallScore Float    @default(0)
  cohesion     Float?
  communication Float?
  trust        Float?
  motivation   Float?
  leadership   Float?
  lastAssessed DateTime?
  notes        String?  @db.Text
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  team         Team     @relation("teamChemistry", fields: [teamId], references: [id], onDelete: Cascade)
  season       Season?  @relation("seasonChemistry", fields: [seasonId], references: [id], onDelete: SetNull)

  @@unique([teamId, seasonId])
  @@index([teamId])
  @@index([seasonId])
  @@map("team_chemistry")
}

model SeasonAward {
  id          String        @id @default(cuid())
  clubId      String?
  teamId      String?
  seasonId    String?
  category    AwardCategory @default(MVP)
  name        String
  description String?
  winnerId    String?
  nomineeIds  String[]
  votingOpen  Boolean       @default(false)
  votingStart DateTime?
  votingEnd   DateTime?
  announcedAt DateTime?
  points      Int           @default(0)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  club        Club?         @relation("clubSeasonAwards", fields: [clubId], references: [id], onDelete: SetNull)
  team        Team?         @relation("teamSeasonAwards", fields: [teamId], references: [id], onDelete: SetNull)
  season      Season?       @relation("seasonAwards", fields: [seasonId], references: [id], onDelete: SetNull)

  @@index([clubId])
  @@index([teamId])
  @@index([seasonId])
  @@index([category])
  @@map("season_awards")
}

// =============================================================================
// üì§ EXPORT SYSTEM (v7.8.0)
// =============================================================================

model ExportRequest {
  id             String       @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?
  type           ExportType
  format         ExportFormat @default(CSV)
  status         ExportStatus @default(PENDING)
  filters        Json?
  columns        String[]
  dateRange      Json?
  fileUrl        String?
  fileSize       Int?
  rowCount       Int?
  error          String?
  requestedAt    DateTime     @default(now())
  startedAt      DateTime?
  completedAt    DateTime?
  expiresAt      DateTime?
  downloadedAt   DateTime?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  user           User         @relation("userExports", fields: [userId], references: [id], onDelete: Cascade)
  organisation   Organisation? @relation("orgExports", fields: [organisationId], references: [id], onDelete: SetNull)
  club           Club?        @relation("clubExports", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([status])
  @@index([type])
  @@map("export_requests")
}

model ExportTemplate {
  id             String       @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?
  name           String
  description    String?
  type           ExportType
  format         ExportFormat @default(CSV)
  columns        String[]
  filters        Json?
  sorting        Json?
  isDefault      Boolean      @default(false)
  isShared       Boolean      @default(false)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  user           User         @relation("userExportTemplates", fields: [userId], references: [id], onDelete: Cascade)
  organisation   Organisation? @relation("orgExportTemplates", fields: [organisationId], references: [id], onDelete: SetNull)
  club           Club?        @relation("clubExportTemplates", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([type])
  @@map("export_templates")
}

model ReportSchedule {
  id             String          @id @default(cuid())
  userId         String
  organisationId String?
  clubId         String?
  templateId     String?
  name           String
  description    String?
  frequency      ReportFrequency @default(WEEKLY)
  dayOfWeek      Int?
  dayOfMonth     Int?
  timeOfDay      String?
  timezone       String          @default("Europe/London")
  recipients     String[]
  isActive       Boolean         @default(true)
  lastRunAt      DateTime?
  nextRunAt      DateTime?
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt

  user           User            @relation("userReportSchedules", fields: [userId], references: [id], onDelete: Cascade)
  organisation   Organisation?   @relation("orgReportSchedules", fields: [organisationId], references: [id], onDelete: SetNull)
  club           Club?           @relation("clubReportSchedules", fields: [clubId], references: [id], onDelete: SetNull)

  @@index([userId])
  @@index([organisationId])
  @@index([clubId])
  @@index([isActive])
  @@index([nextRunAt])
  @@map("report_schedules")
}

// =============================================================================
// ü§ñ AI PREDICTIONS (v7.6.0)
// =============================================================================

model AIPrediction {
  id               String           @id @default(cuid())
  type             PredictionType
  subjectType      String
  subjectId        String
  prediction       Json
  confidence       Float
  impact           PredictionImpact @default(MEDIUM)
  status           PredictionStatus @default(ACTIVE)
  validFrom        DateTime
  validUntil       DateTime?
  actualOutcome    Json?
  wasCorrect       Boolean?
  accuracy         Float?
  modelVersion     String?
  inputFeatures    Json?
  explanation      String?          @db.Text
  recommendations  String[]
  relatedEntityType String?
  relatedEntityId  String?
  verifiedAt       DateTime?
  verifiedBy       String?
  feedback         Json?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt

  @@index([type])
  @@index([subjectType, subjectId])
  @@index([status])
  @@index([impact])
  @@index([validFrom])
  @@index([validUntil])
  @@map("ai_predictions")
}

// =============================================================================
// üéñ ACHIEVEMENT SYSTEM MODELS (v7.10.0)
// =============================================================================

// -----------------------------------------------------------------------------
// Achievement Template - Blueprint for all achievements
// -----------------------------------------------------------------------------
model AchievementTemplate {
  id                  String                   @id @default(cuid())
  
  // Basic Information
  name                String                   @db.VarChar(100)
  slug                String                   @unique @db.VarChar(100)
  description         String                   @db.Text
  shortDescription    String?                  @db.VarChar(200)
  
  // Visual Assets
  icon                String?
  badgeUrl            String?
  badgeColor          String?
  animationUrl        String?
  
  // Categorization
  category            AchievementCategory
  sport               Sport?
  position            Position?
  
  // Rarity & Rewards
  rarity              AchievementRarity        @default(COMMON)
  baseXp              Int                      @default(10)
  bonusXp             Int?
  pointsAwarded       Int                      @default(0)
  
  // Achievement Criteria
  criteriaType        AchievementCriteriaType  @default(TOTAL_COUNT)
  criteriaValue       Int                      @default(1)
  criteriaField       String?
  criteriaCondition   Json?
  
  // Tiered Achievements
  parentId            String?
  tierLevel           Int?
  tierMultiplier      Float?
  
  // Status & Visibility
  isActive            Boolean                  @default(true)
  isSecret            Boolean                  @default(false)
  isLimited           Boolean                  @default(false)
  availableFrom       DateTime?
  availableUntil      DateTime?
  
  // Statistics
  unlockedCount       Int                      @default(0)
  totalAttempts       Int                      @default(0)
  averageProgress     Float?
  
  // Audit
  createdBy           String?
  updatedBy           String?
  deletedAt           DateTime?
  createdAt           DateTime                 @default(now())
  updatedAt           DateTime                 @updatedAt
  
  // Relations
  parent              AchievementTemplate?     @relation("AchievementTiers", fields: [parentId], references: [id], onDelete: SetNull)
  childTiers          AchievementTemplate[]    @relation("AchievementTiers")
  playerAchievements  PlayerAchievement[]      @relation("templateProgress")
  
  @@index([category])
  @@index([sport])
  @@index([position])
  @@index([rarity])
  @@index([isActive])
  @@index([isSecret])
  @@index([parentId])
  @@index([deletedAt])
  @@map("achievement_templates")
}

// -----------------------------------------------------------------------------
// Player Achievement - Tracks player progress toward achievements
// -----------------------------------------------------------------------------
model PlayerAchievement {
  id               String              @id @default(cuid())
  
  // Core Relations
  playerId         String
  achievementId    String
  
  // Progress Tracking
  progress         Int                 @default(0)
  progressPercent  Float               @default(0)
  isComplete       Boolean             @default(false)
  
  // Tiered Progress
  currentTier      Int?
  tierProgress     Json?
  
  // Timestamps
  startedAt        DateTime            @default(now())
  earnedAt         DateTime?
  notifiedAt       DateTime?
  displayedAt      DateTime?
  sharedAt         DateTime?
  
  // Context
  earnedInMatchId  String?
  earnedInSeasonId String?
  earnedInTeamId   String?
  earnedInClubId   String?
  
  // Rewards Granted
  pointsAwarded    Int                 @default(0)
  xpAwarded        Int                 @default(0)
  
  // Metadata
  metadata         Json?
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt
  
  // Relations
  player           Player              @relation("playerAchievementProgress", fields: [playerId], references: [id], onDelete: Cascade)
  achievement      AchievementTemplate @relation("templateProgress", fields: [achievementId], references: [id], onDelete: Cascade)
  
  @@unique([playerId, achievementId])
  @@index([playerId])
  @@index([achievementId])
  @@index([isComplete])
  @@index([earnedAt])
  @@index([currentTier])
  @@map("player_achievements")
}

// -----------------------------------------------------------------------------
// Player Milestone - Career milestone tracking
// -----------------------------------------------------------------------------
model PlayerMilestone {
  id              String        @id @default(cuid())
  
  // Core Relations
  playerId        String
  matchId         String?
  teamId          String?
  seasonId        String?
  
  // Milestone Information
  type            MilestoneType
  title           String        @db.VarChar(150)
  description     String?       @db.Text
  
  // Values
  value           Int
  previousValue   Int?
  nextMilestone   Int?
  
  // Context
  sport           Sport?
  position        Position?
  competitionId   String?
  opponentId      String?
  
  // Visual Assets
  icon            String?
  badgeUrl        String?
  mediaUrl        String?
  
  // Rewards
  xpAwarded       Int           @default(0)
  pointsAwarded   Int           @default(0)
  
  // Visibility
  isPublic        Boolean       @default(true)
  isShared        Boolean       @default(false)
  sharedAt        DateTime?
  
  // Timestamps
  achievedAt      DateTime      @default(now())
  notifiedAt      DateTime?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  
  // Relations
  player          Player        @relation("playerMilestoneHistory", fields: [playerId], references: [id], onDelete: Cascade)
  match           Match?        @relation("milestoneTriggerMatch", fields: [matchId], references: [id], onDelete: SetNull)
  team            Team?         @relation("teamMilestones", fields: [teamId], references: [id], onDelete: SetNull)
  season          Season?       @relation("seasonMilestones", fields: [seasonId], references: [id], onDelete: SetNull)
  
  @@index([playerId])
  @@index([matchId])
  @@index([teamId])
  @@index([seasonId])
  @@index([type])
  @@index([sport])
  @@index([achievedAt])
  @@map("player_milestones")
}

// -----------------------------------------------------------------------------
// Player Level - XP, Leveling, and Streaks System
// -----------------------------------------------------------------------------
model PlayerLevel {
  id                       String   @id @default(cuid())
  playerId                 String   @unique
  
  // Level Information
  level                    Int      @default(1)
  currentXp                Int      @default(0)
  totalXp                  Int      @default(0)
  xpToNextLevel            Int      @default(100)
  
  // Prestige System
  prestigeLevel            Int      @default(0)
  prestigeXpBonus          Float    @default(0)
  
  // Login Streak
  loginStreakCurrent       Int      @default(0)
  loginStreakBest          Int      @default(0)
  
  // Training Streak
  trainingStreakCurrent    Int      @default(0)
  trainingStreakBest       Int      @default(0)
  
  // Match Streak
  matchStreakCurrent       Int      @default(0)
  matchStreakBest          Int      @default(0)
  
  // Win Streak
  winStreakCurrent         Int      @default(0)
  winStreakBest            Int      @default(0)
  
  // Goal Streak
  goalStreakCurrent        Int      @default(0)
  goalStreakBest           Int      @default(0)
  
  // Clean Sheet Streak
  cleanSheetStreakCurrent  Int      @default(0)
  cleanSheetStreakBest     Int      @default(0)
  
  // Streak Timestamps
  lastLoginAt              DateTime?
  lastTrainingAt           DateTime?
  lastMatchAt              DateTime?
  lastXpGainAt             DateTime?
  lastLevelUpAt            DateTime?
  
  // Period Statistics
  weeklyXp                 Int      @default(0)
  monthlyXp                Int      @default(0)
  seasonXp                 Int      @default(0)
  weekStartDate            DateTime?
  monthStartDate           DateTime?
  seasonStartDate          DateTime?
  
  // Achievement Summary
  totalAchievementPoints   Int      @default(0)
  totalAchievements        Int      @default(0)
  legendaryAchievements    Int      @default(0)
  epicAchievements         Int      @default(0)
  rareAchievements         Int      @default(0)
  
  // Timestamps
  createdAt                DateTime @default(now())
  updatedAt                DateTime @updatedAt
  
  // Relations
  player                   Player   @relation("playerLevelProgress", fields: [playerId], references: [id], onDelete: Cascade)
  
  @@index([playerId])
  @@index([level])
  @@index([totalXp])
  @@index([prestigeLevel])
  @@map("player_levels")
}

// -----------------------------------------------------------------------------
// XP Transaction - Audit log for all XP changes
// -----------------------------------------------------------------------------
model XpTransaction {
  id            String   @id @default(cuid())
  playerId      String
  
  // Transaction Details
  amount        Int
  reason        String   @db.VarChar(200)
  category      String   @db.VarChar(50)
  
  // Context
  referenceType String?  @db.VarChar(50)
  referenceId   String?
  
  // Balance Tracking
  previousXp    Int
  newXp         Int
  previousLevel Int
  newLevel      Int
  
  // Multipliers Applied
  baseAmount    Int?
  multiplier    Float?
  bonusAmount   Int?
  
  // Metadata
  metadata      Json?
  createdAt     DateTime @default(now())
  
  // Relations
  player        Player   @relation("playerXpHistory", fields: [playerId], references: [id], onDelete: Cascade)
  
  @@index([playerId])
  @@index([category])
  @@index([referenceType, referenceId])
  @@index([createdAt])
  @@map("xp_transactions")
}

// =============================================================================
// üîö END OF SCHEMA v7.10.1 - VIDEO ANALYTICS EDITION
// =============================================================================
//
// Schema Statistics:
// - Total Models: ~175+
// - Total Enums: ~115+
// - Sports Supported: 12
//
// New in v7.10.1:
// - 7 New Models: MediaViewLog, MediaInteraction, MediaComment,
//   MediaCommentLike, MediaAnalyticsSummary, WatchHistory, BookmarkFolder
// - 1 New Enum: CommentStatus
// - Enhanced NotificationType with 12+ video notification types
// - Enhanced WebhookEvent with 10+ video webhook events
// - Enhanced AuditActionType with 12+ video audit actions
// - Enhanced PermissionType with 4+ video permission types
// - Updated MediaContent model with analytics relations
// - Updated User model with video engagement relations
//
// Video Analytics Features:
// - Comprehensive view tracking with device/geo/network data
// - User engagement tracking (likes, bookmarks, shares, ratings)
// - Comment system with threading and timestamp support
// - Comment moderation with status workflow
// - Analytics aggregation with retention curves
// - Watch history for recommendations
// - Bookmark folders for organization
// - Trending score calculation
//
// =============================================================================
